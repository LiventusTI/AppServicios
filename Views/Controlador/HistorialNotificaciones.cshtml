
@{
    ViewBag.Title = "HistorialNotificaciones";
    Layout = "~/Views/MasterPage.cshtml";
}


<div class="col-sm-12">
    <div class="x_panel">
        <div class="col-sm-12 col-md-12 col-lg-12">
            <table id="Tb_Controlador" class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th class="tr" key="">RETRIEVAL PROVIDER</th>
                        <th class="tr" key="">FECHA NOTIFICACION</th>
                        <th class="tr" key="">COORDINADOR RP</th>
                        <th class="tr" key="">CANTIDAD CONTROLADORES</th>
                        <th class="tr" key="">NAVIERA</th>
                        <th class="tr" key="">NODO NOTIFICADO</th>
                        <th class="tr" key="">TIPO NOTIFICACION</th>
                        <th class="tr" key="">ESTADO NOTIFICACION</th>
                    </tr>
                </thead>
                <tfoot>
                    <tr>
                        <th class="tr" key="">1. RETRIEVAL PROVIDER</th>
                        <th class="tr" key="">2. FECHA NOTIFICACION</th>
                        <th class="tr" key="">3. COORDINADOR RP</th>
                        <th class="tr" key="">4. CANTIDAD CONTROLADORES</th>
                        <th class="tr" key="">5. NAVIERA</th>
                        <th class="tr" key="">6. NODO NOTIFICADO</th>
                        <th class="tr" key="">7. TIPO NOTIFICACION</th>
                        <th class="tr" key="">8. ESTADO NOTIFICACION</th>
                    </tr>
                </tfoot>
            </table>
        </div>

    </div>

</div>

<!--Modal para Logistica Controlador-->

<script src="~/build/js/Perfiles.js"></script>
<script src="~/build/js/PerfilGestionControlador.js"></script>
<script type="text/javascript">

    var lenguaje = document.cookie;

    $(document).ready(function () {

        $('#Tb_Controlador tfoot th').each(function (i) {
            $(this).html('<input class="form-control" type="text" placeholder="FILTER" />');
        });

        var table = $("#Tb_Controlador").DataTable({
            pageLength: 15,
            ajax: {
                "url": "@Url.Action("GetHistorialNotificaciones", "Controlador")",
            "dataSrc": ''
            },
            dom: 'Bfrtip',
            buttons: [
                'excel'
            ],
        columns: [
            { "data": "NombreRP" },
            {
                "data": "FechaNotificacion",
                "render":
                function (data, type, row, meta) {
                    if (data != null) {
                        var fecha = FormatDate(data);
                        return fecha;
                    } else {
                        return "";
                    }
                }
            },
            { "data": "CoordinadorRP" },
            { "data": "CantidadControladores" },
            { "data": "Naviera" },
            { "data": "NodoRP" },
            { "data": "TipoNotificacion" },
            { "data": "EstadoNotificacion" },
        ],
        });

    table.columns().every(function () {
        var column = this;
        $('input', this.footer()).on('keyup change', function () {

                column
                .search(this.value)
                .draw();
        });
    });

    $('#Tb_Controlador tbody').on('click', 'tr', function () {
        $(this).toggleClass('selected');
       // $('#IdControlador').val(table.rows('.selected').data().length);
    });
    });

    function FormatDate(data) {
        var dateString = data.substr(6);
        var currentTime = new Date(parseInt(dateString));
        var month = currentTime.getMonth() + 1;
        var day = currentTime.getDate();
        var year = currentTime.getFullYear();

        if (month < 10) {
            month = "0" + month;
        } else {
            month;
        }

        if (day < 10) {
            day = "0" + day;
        } else {
            day;
        }

        var date = day + "-" + month + "-" + year;
        return date;
    }

    function FormatDateDias(data) {
        if (data == null) {
            return 2;
        }

        var dateString = data.substr(6);
        var currentTime = new Date(parseInt(dateString));

        var month = currentTime.getMonth() + 1;
        var day = currentTime.getDate();
        var year = currentTime.getFullYear();

        if (month < 10) {
            month = "0" + month;
        } else {
            month;
        }

        if (day < 10) {
            day = "0" + day;
        } else {
            day;
        }

        var date = year + "-" + month + "-" + day;

        var today = new Date();
        var dd = today.getDate();
        var mm = today.getMonth() + 1; //January is 0!

        var yyyy = today.getFullYear();
        if (dd < 10) {
            dd = '0' + dd;
        }
        if (mm < 10) {
            mm = '0' + mm;
        }
        var today = yyyy + '-' + mm + '-' + dd;

        var date1 = new Date(date);
        var date2 = new Date(today);
        var timeDiff = Math.abs(date2.getTime() - date1.getTime());
        var diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));

        if (diffDays > 15) {
            return 0;
        } else {
            return 1;
        }
    }

</script>