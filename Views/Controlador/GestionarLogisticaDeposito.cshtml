@{
    ViewBag.Title = "GestionarLogisticaDeposito";
    Layout = "~/Views/MasterPage.cshtml";
}

<div class="col-sm-12">
    <div class="x_panel">
        <div class="x_panel">
            <div class="col-sm-12 col-md-12 col-lg-12">
                <table id="Tb_Controlador" class="table table-striped table-bordered display nowrap">
                    <thead>
                        <tr>
                            <th colspan="3" class="tr" key="controladortabla">ESN</th>
                            <th colspan="5" class="tr" key="informaciongeneraltabla">INFORMACION GENERAL</th>
                            <th colspan="2" class="tr" key="nodoorigentabla">NODO ORIGEN</th>
                            <th colspan="3" class="tr" key="transitontabla">TRANSITO NODO ORIGEN/DESTINO</th>
                            <th colspan="4" class="tr" key="nododestinontabla">NODO DESTINO</th>
                        </tr>
                        <tr>
                            <th class="tr" key="controladortabla">CONTROLADOR (ESN)</th>
                            <th class="tr" key="tipocommoditytabla">TIPO COMMODITY PROGRAMADO</th>
                            <th class="tr" key="fechaactivaciontabla">FECHA PROGRAMACION</th>
                            <th>DAMAGE REPORT</th>
                            <th class="tr" key="transitotabla">EN NODO / EN TRANSITO</th>
                            <th class="tr" key="perdidotabla">PERDIDO</th>
                            <th class="tr" key="fechaperdidatabla">FECHA DECLARACION PERDIDA</th>
                            <th class="tr" key="notastabla">NOTAS LOGISTICAS</th>
                            <th class="tr" key="tipolugarcontroladorservicio">TIPO LUGAR</th>
                            <th class="tr" key="lugarcontroladorservicio">LUGAR</th>
                            <th>ETA</th>
                            <th class="tr" key="numeroenviotabla">NUMERO DE ENVIO</th>
                            <th class="tr" key="empresatransportetabla">EMPRESA TRANSPORTE</th>
                            <th class="tr" key="tipolugarcontroladorservicio">TIPO LUGAR</th>
                            <th class="tr" key="lugarcontroladorservicio">LUGAR</th>
                            <th class="tr" key="fechaarriborealtabla">FECHA ARRIBO</th>
                            <th class="tr" key="diasnodotabla">N° DIAS EN NODO</th>
                            
                        </tr>
                    </thead>
                    <tfoot>
                        <tr>
                            <th class="tr" key="controladortabla">CONTROLADOR (ESN)</th>
                            <th class="tr" key="tipocommoditytabla">TIPO COMMODITY PROGRAMADO</th>
                            <th class="tr" key="fechaactivaciontabla">FECHA PROGRAMACION</th>
                            <th>DAMAGE REPORT</th>
                            <th class="tr" key="transitotabla">EN NODO / EN TRANSITO</th>
                            <th class="tr" key="perdidotabla">PERDIDO</th>
                            <th class="tr" key="fechaperdidatabla">FECHA DECLARACION PERDIDA</th>
                            <th class="tr" key="notastabla">NOTAS LOGISTICAS</th>
                            <th class="tr" key="tipolugarcontroladorservicio">TIPO LUGAR</th>
                            <th class="tr" key="lugarcontroladorservicio">LUGAR</th>
                            <th>ETA</th>
                            <th class="tr" key="numeroenviotabla">NUMERO DE ENVIO</th>
                            <th class="tr" key="empresatransportetabla">EMPRESA TRANSPORTE</th>
                            <th class="tr" key="tipolugarcontroladorservicio">TIPO LUGAR</th>
                            <th class="tr" key="lugarcontroladorservicio">LUGAR</th>
                            <th class="tr" key="fechaarriborealtabla">FECHA ARRIBO</th>
                            <th class="tr" key="diasnodotabla">N° DIAS EN NODO</th>
                        </tr>
                    </tfoot>
                </table>
            </div>
            <div>
            </div>
            <div class="row">
                <div class="col-lg-5">
                    <form class="form-inline">
                        <div class="form-group">
                            <label for="IdControlador" class="control-label tr" key="numerocontroladoresseleccionados">N° Controladores seleccionados</label>
                            <input type="text" class="input form-control" id="IdControlador" disabled="disabled" style="text-align:center; text-align-last:center;" />
                        </div>

                    </form>
                </div>
            </div>
            <div class="divider"></div>
            <div class="row">
                <div class="col-lg-8 col-lg-offset-4" id="Botones">
                    <button type="button" class="btn btn-primary tr" id="Logistica" key="BotonLogistica" style="margin-bottom: 0px;">Logistica</button>
                    @*<button type="button" class="btn btn-warning tr" id="Historico" key="BotonHistorico" style="margin-bottom: 0px;">Historial Movimientos Logisticos</button>*@
                    <button type="button" class="btn btn-danger tr" id="AgregarFalla" key="" style="margin-bottom: 0px;">Asignar Damage Report</button>
                    <button type="button" class="btn btn-success tr" id="QuitarFalla" key="" style="margin-bottom: 0px;">Quitar Damage Report</button>
                </div>
            </div>
        </div>
    </div>

    <!--Modal para Logistica Controlador-->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="margin-left:80px; margin-right:10px;">
        <div class="modal-dialog" role="document" style="width:100%">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title tr" id="myModalLabel" key="titulologisticacontrolador"> Logistica Controlador</h4>
                </div>
                <div class="modal-body">
                    <div class="row x_panel">
                        <div class="col-md-4 col-sm-4 col-xs-12">
                            <label class="control-label col-md-4 col-sm-4 col-xs-6 tr" key="tipoaccion">Tipo de Accion</label>
                            <div class="col-md-8 col-sm-8 col-xs-6">
                                <select class="selectpicker form-control Tipo_accion" data-live-search="true" id="Tipo_accion">
                                    <option selected value="0"></option>
                                    <option value="1">INGRESO</option>
                                    <option value="2">SALIDA NODO ESPECIFICO</option>
                                    <option value="3">PERDIDA</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div id="Log_ingreso" hidden="hidden">
                        <div class="x_panel">
                            <table id="Tb_Ingreso" class="table table-striped table-bordered display nowrap">
                                <thead>
                                    <tr>
                                        <th class="tr" key="">CONTROLADOR (ESN)</th>
                                        <th class="tr" key="">NODO ORIGEN</th>
                                        <th class="tr" key="">NODO DESTINO</th>
                                        <th class="tr" key="">EMPRESA TRANSPORTE</th>
                                        <th class="tr" key="">NUMERO ENVIO</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                        <div class="x_panel">
                            <form class="form-horizontal">
                                <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                    <div class="col-lg-3 col-md-3 col-sm-3">
                                        <label class="control-label tr" key="controlador">ESN</label>
                                    </div>
                                    <div class="col-lg-3 col-md-3 col-sm-3">
                                        <input type="text" onkeyup="this.value = this.value.toUpperCase();" class="form-control" autocomplete="off" name="ControladorIngreso" id="ControladorIngreso" />
                                    </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <a title="Agregar ESN" id="Agregarcontrolador" name="Agregarcontrolador" class="AgregarcontroladorIngreso"><i class="fa fa-plus fa-2x"></i></a>
                                    </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <label id="lb_id" class="control-label tr" key="tiponodoingreso">Tipo Nodo (*)</label>
                                    </div>
                                    <div class="col-md-3 col-sm-3 col-xs-3">
                                        <select class="selectpicker form-control" id="Tipo_nodoIngreso" name="Tipo_nodo" data-live-search="true"></select>
                                    </div>
                                </div>
                                <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                    <div class="col-lg-3 col-md-3 col-sm-3">
                                        <label class="control-label tr" key="cargamasivaingreso">Carga masiva controladores</label>
                                    </div>
                                    <div class="col-lg-3 col-md-3 col-sm-3">
                                        <input type="file" id="ArchivoIngreso" name="Archivo" placeholder="Suba Archivo Excel" class="form-control">
                                    </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <a title="Subir Archivo" id="SubirArchivoIngreso" name="SubirArchivo" class="SubirArchivoIngreso"><i class="fa fa-upload fa-2x"></i></a>
                                    </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <label id="lb_id" class="control-label tr" key="paisingreso">Pais</label>
                                    </div>
                                    <div class="col-md-3 col-sm-3 col-xs-3">
                                        <select class="selectpicker form-control" id="PaisIngreso" name="Pais" data-live-search="true" disabled></select>
                                    </div>
                                    
                                </div>
                                <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                    <div class="col-lg-3 col-md-3 col-sm-3">
                                        <label class="control-label tr" key="fecharealingreso">Fecha Real Arribo (*)</label>
                                    </div>
                                    <div class="col-lg-3 col-md-3 col-sm-3">
                                        <input type="text" id="Fecha_real_arriboIngreso" class="form-control" autocomplete="off">
                                    </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                    </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <label id="lb_id" class="control-label tr" key="ciudadingreso">Ciudad</label>
                                    </div>
                                    <div class="col-md-3 col-sm-3 col-xs-3">
                                        <select class="selectpicker form-control" id="CiudadIngreso" name="Ciudad" data-live-search="true" disabled></select>
                                    </div>
                                </div>
                                <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                    <div class="col-lg-3 col-md-3 col-sm-3">
                                    </div>
                                    <div class="col-lg-3 col-md-3 col-sm-3">
                                    </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                    </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <label id="lb_id" class="control-label tr" key="nodoingreso">Nodo (*)</label>
                                    </div>
                                    <div class="col-md-3 col-sm-3 col-xs-3">
                                        <select class="selectpicker form-control" id="NodoIngreso" name="Nodo" data-live-search="true" disabled></select>
                                    </div>
                                </div>
                                <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                        <label id="Nota_logistica_ingreso" class="tr" key="notasingreso">Notas Logisticas</label>
                                    </div>
                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                        <textarea class="form-control" rows="5" id="Nota_logistica_ingreso"> SIN OBSERVACIONES</textarea>
                                    </div>
                                </div>

                            </form>
                        </div>
                    </div>
                    <div id="Log_salida" hidden="hidden">
                        <div class="x_panel">
                            <table id="Tb_Salida" class="table table-striped table-bordered">
                                <thead>
                                    <tr>
                                        <th class="tr" key="">CONTROLADOR (ESN)</th>
                                        <th class="tr" key="">NODO ORIGEN</th>
                                        <th class="tr" key="">NODO DESTINO</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                        <div class="x_panel">
                            <form class="form-horizontal">
                                <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                    <div class="col-lg-3 col-md-3 col-sm-3">
                                        <label class="control-label tr" key="controlador">ESN</label>
                                    </div>
                                    <div class="col-lg-3 col-md-3 col-sm-3">
                                        <input type="text" onkeyup="this.value = this.value.toUpperCase();" class="form-control" autocomplete="off" name="ControladorSalida" id="ControladorSalida" />
                                    </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <a title="Agregar ESN" id="Agregarcontrolador" name="Agregarcontrolador" class="AgregarcontroladorSalida"><i class="fa fa-plus fa-2x"></i></a>
                                    </div>

                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <label id="lb_id" class="control-label tr" key="tiponodoingreso">Tipo Nodo (*)</label>
                                    </div>
                                    <div class="col-md-3 col-sm-3 col-xs-3">
                                        <select class="selectpicker form-control" id="Tipo_nodoSalida" name="Tipo_nodoSalida" data-live-search="true"></select>
                                    </div>
                                </div>
                                <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                    <div class="col-lg-3 col-md-3 col-sm-3">
                                        <label class="control-label tr" key="cargamasivaingreso">Carga masiva controladores</label>
                                    </div>
                                    <div class="col-lg-3 col-md-3 col-sm-3">
                                        <input type="file" id="ArchivoSalida" name="Archivo" placeholder="Suba Archivo Excel" class="form-control">
                                    </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <a title="Subir Archivo" id="SubirArchivoSalida" name="SubirArchivo" class="SubirArchivoSalida"><i class="fa fa-upload fa-2x"></i></a>
                                    </div>
                                    <div class="col-md-1 col-sm-1 col-xs-1">
                                        <label id="lb_id" class="control-label tr" key="paisingreso">Pais</label>
                                    </div>
                                    <div class="col-md-3 col-sm-3 col-xs-3">
                                        <select class="selectpicker form-control" id="PaisSalida" name="PaisSalida" data-live-search="true" disabled></select>
                                    </div>
                                </div>
                                <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                    <div class="col-lg-3 col-md-3 col-sm-3">
                                        <label id="lb_id" class="control-label">ETA (*)</label>
                                    </div>
                                    <div class="col-md-3 col-sm-3 col-xs-3">
                                        <input type="text" id="EtaSalida" class="form-control" autocomplete="off">
                                    </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                    </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <label id="lb_id" class="control-label tr" key="ciudadingreso">Ciudad</label>
                                    </div>
                                    <div class="col-md-3 col-sm-3 col-xs-3">
                                        <select class="selectpicker form-control" id="CiudadSalida" name="CiudadSalida" data-live-search="true" disabled></select>
                                    </div>
                                </div>
                                <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                        <div class="col-lg-3 col-md-3 col-sm-3">
                                            <label id="lb_id" class="control-label tr" key="numeroenviosalida">Numero de envio</label>
                                        </div>
                                        <div class="col-md-3 col-sm-3 col-xs-3">
                                            <input type="text" id="Numero_envioSalida" class="form-control">
                                        </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                    </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <label id="lb_id" class="control-label tr" key="nodoingreso">Nodo (*)</label>
                                    </div>
                                    <div class="col-md-3 col-sm-3 col-xs-3">
                                        <select class="selectpicker form-control" id="NodoSalida" name="NodoSalida" data-live-search="true" disabled></select>
                                    </div>
                                </div>
                                    <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                            <div class="col-lg-3 col-md-3 col-sm-3">
                                                <label id="lb_id" class="control-label tr" key="empresatransportesalida">Empresa Transporte</label>
                                            </div>
                                            <div class="col-md-3 col-sm-3 col-xs-3">
                                                <select class="selectpicker form-control" id="Empresa_transporteSalida" name="Empresa_transporteSalida" data-live-search="true"></select>
                                            </div>
                                    </div>
                                    
                                <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                        <label id="lb_nota_logistica" class="tr" key="notasingreso">Notas Logisticas</label>
                                    </div>
                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                        <textarea class="form-control" rows="5" id="Nota_logistica_salida"> SIN OBSERVACIONES</textarea>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="x_panel" id="Log_perdida" hidden="hidden">
                        <form class="form-horizontal">
                            <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                <div class="col-lg-2 col-md-2 col-sm-2">
                                    <label class="control-label tr" key="controlador">ESN (*)</label>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-4">
                                    <input type="text" onkeyup="this.value = this.value.toUpperCase();" class="form-control" autocomplete="off" name="ControladorPerdida" id="ControladorPerdida" />
                                </div>
                            </div>
                            <br />
                            <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                <div class="col-lg-2 col-md-2 col-sm-2">
                                    <label class="control-label tr" key="FechaPerdida">Fecha Perdida (*)</label>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-4">
                                    <input type="text" id="FechaPerdida" class="form-control" autocomplete="off">
                                </div>
                            </div>
                            <br />
                            <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                <div class="col-lg-2 col-md-2 col-sm-2">
                                    <label class="control-label tr" key="comentarios">Comentarios (*)</label>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-4">
                                    <textarea class="form-control" rows="5" id="ComentarioPerdida"></textarea>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="modal-footer" id="div_botones_ingreso" hidden="hidden">
                    <button type="button" class="btn btn-success tr" id="Guardar_ingreso" key="botonguardarlogistica">Guardar</button>
                    <button type="button" class="btn btn-danger tr" data-dismiss="modal" key="botoncancelarlogistica">Cancelar</button>
                </div>
                <div class="modal-footer" id="div_botones_salida" hidden="hidden">
                    <button type="button" class="btn btn-success tr" id="Guardar_salida" key="botonguardarlogistica">Guardar</button>
                    <button type="button" class="btn btn-danger tr" data-dismiss="modal" key="botoncancelarlogistica">Cancelar</button>
                </div>
                <div class="modal-footer" id="div_botones_perdida" hidden="hidden">
                    <button type="button" class="btn btn-success tr" id="Perdido" key="botonperdidologistica">Cambiar a Perdido</button>
                    <button type="button" class="btn btn-primary tr" id="NoPerdido" key="botonnoperdidologistica">Cambiar a No Perdido</button>
                    <button type="button" class="btn btn-danger tr" data-dismiss="modal" key="botoncencelarlogistica">Cancelar</button>
                </div>
                <div class="modal-footer" id="div_botones_salidanodos" hidden="hidden">
                    <button type="button" class="btn btn-success tr" id="Guardar_salidanodos" key="botonguardarlogistica">Guardar</button>
                    <button type="button" class="btn btn-danger tr" data-dismiss="modal" key="botoncencelarlogistica">Cancelar</button>
                </div>
            </div>
        </div>
    </div>
    <!--Modal para Logistica Controlador-->
  
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal" id="LogisticaControlador" style="display:none;"></button>
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal3" id="HistoricoControlador" style="display:none;"></button>


<script src="~/build/js/Perfiles.js"></script>
<script src="~/build/js/PerfilGestionControlador.js"></script>
<script type="text/javascript">

    var lenguaje = document.cookie;

    $(document).ready(function () {

        $('#Tb_Controlador tfoot th').each(function (i) {
            $(this).html('<input class="form-control" type="text" placeholder="FILTER" />');
        });

        var table = $("#Tb_Controlador").DataTable({
            scrollX: true,
            order: false,
            pageLength: 15,
            ajax: {
                "url": "@Url.Action("GetControladoresDeposito", "Controlador")",
                "dataSrc": ''
            },
            dom: 'Bfrtip',
            buttons: [
                'excel'
            ],
            columns: [
                { "data": "NumControlador" },
                { "data": "TipoCommodity" },
                {
                    "data": "FechaProgramacion",
                    "render":
                    function (data, type, row, meta) {
                        if (data != null) {
                            var fecha = FormatDate(data);
                            return fecha;
                        }else {
                            return "";
                        }
                    }
                },
                { "data": "DamageReportTxt" },
                { "data": "TransitoNodoTxt" },
                { "data": "PerdidoTxt" },
                { "data": "FechaPerdida",
                    "render":
                    function (data, type, row, meta) {
                        if (data != null) {
                            var fecha = FormatDate(data);
                            return fecha;
                        } else {
                            return "";
                        }
                    }
                },
                { "data": "Nota" },
                { "data": "TipoNodoOrigen" },
                { "data": "NodoOrigen" },
                { "data": "Eta",
                    "render":
                    function (data, type, row, meta) {
                        if (data != null) {
                            var fecha = FormatDate(data);
                            return fecha;
                        } else {
                            return "";
                        }
                    }
                },
                { "data": "NumeroEnvio" },
                { "data": "EmpresaTransporte" },
                { "data": "TipoNodoDestino" },
                { "data": "NodoDestino" },
                { "data": "FechaArribo",
                    "render":
                    function (data, type, row, meta) {
                        if (data != null) {
                            var fecha = FormatDate(data);
                            return fecha;
                        } else {
                            return "";
                        }
                    }
                },
                { "data": "DiasEnNodo" },
            ],
        });

        table.columns().every(function () {
            var column = this;
            $('input', this.footer()).on('keyup change', function () {
                if (column[0][0] == 52 && this.value != "") {
                    column
                    .search("^" + this.value + "$", true, false, true)
                    .draw();
                } else {
                    column
                    .search(this.value)
                    .draw();
                }
            });
        });

        $('#Tb_Controlador tbody').on('click', 'tr', function () {
            $(this).toggleClass('selected');
            $('#IdControlador').val(table.rows('.selected').data().length);
        });
    });

    function FormatDate(data) {
        var dateString = data.substr(6);
        var currentTime = new Date(parseInt(dateString));
        var month = currentTime.getMonth() + 1;
        var day = currentTime.getDate();
        var year = currentTime.getFullYear();

        if (month < 10) {
            month = "0" + month;
        } else {
            month;
        }

        if (day < 10) {
            day = "0" + day;
        } else {
            day;
        }

        var date = day + "-" + month + "-" + year;
        return date;
    }

    function FormatDateDias(data) {
        if (data == null) {
            return 2;
        }

        var dateString = data.substr(6);
        var currentTime = new Date(parseInt(dateString));

        var month = currentTime.getMonth() + 1;
        var day = currentTime.getDate();
        var year = currentTime.getFullYear();

        if (month < 10) {
            month = "0" + month;
        } else {
            month;
        }

        if (day < 10) {
            day = "0" + day;
        } else {
            day;
        }

        var date = year + "-" + month + "-" + day;

        var today = new Date();
        var dd = today.getDate();
        var mm = today.getMonth() + 1; //January is 0!

        var yyyy = today.getFullYear();
        if (dd < 10) {
            dd = '0' + dd;
        }
        if (mm < 10) {
            mm = '0' + mm;
        }
        var today = yyyy + '-' + mm + '-' + dd;

        var date1 = new Date(date);
        var date2 = new Date(today);
        var timeDiff = Math.abs(date2.getTime() - date1.getTime());
        var diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));

        if (diffDays > 15) {
            return 0;
        } else {
            return 1;
        }
    }

    $("#Perdido").click(function () {
        if ($('#ControladorPerdida').val() != "") {
            if ($('#FechaPerdida').val() != "") {
                if ($('#ComentarioPerdida').val() != "") {
                    $("#ControladorPerdida").css("background", "rgba(255, 0, 0, 0)");
                    $("#FechaPerdida").css("background", "rgba(255, 0, 0, 0)");
                    $("#ComentarioPerdida").css("background", "rgba(255, 0, 0, 0)");
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("ValidarESN", "Controlador")',
                        data: { ESN: $("#ControladorPerdida").val() },
                        success: function (response) {
                            if (response == 0) {
                                swal('Ups!', '<span>Controlador/Modem no existe en los registros</span>', 'warning');
                                $("#ControladorPerdida").val("");
                                return false;
                            } else {
                                swal('Ok!', '<span>Número Controlador/Modem válido.</span>', 'success');
                                $.ajax({
                                    type: "POST",
                                    url: '@Url.Action("AgregarPerdida", "Controlador")',
                                    data: {
                                        ESN: $('#ControladorPerdida').val(),
                                        FechaPerdida: $('#FechaPerdida').val(),
                                        ComentarioPerdida: $('#ComentarioPerdida').val()
                                    },
                                    success: function (response) {
                                        var json = JSON.parse(response);
                                        if (json.validador == 0) {
                                            var aux = 'success';
                                        } else {
                                            var aux = 'warning';
                                        }
                                        swal({
                                            title: '',
                                            text: json.Mensaje,
                                            type: aux,
                                            showCancelButton: false,
                                            confirmButtonColor: '#3085d6',
                                            cancelButtonColor: '#d33',
                                            confirmButtonText: 'Aceptar'
                                        }).then((result) => {
                                            location.reload();
                                        })
                                    }
                                });
                            }
                        }
                    });
                } else {
                    $("#ComentarioPerdida").css("background", "rgba(255, 0, 0, 0.4)");
                }
            } else {
                $("#FechaPerdida").css("background", "rgba(255, 0, 0, 0.4)");
            }
        } else {
            $("#ControladorPerdida").css("background", "rgba(255, 0, 0, 0.4)");
        }

    });

    $("#NoPerdido").click(function () {
        if ($('#ControladorPerdida').val() != "") {
            $("#ControladorPerdida").css("background", "rgba(255, 0, 0, 0)");
            $.ajax({
                type: "POST",
                url: '@Url.Action("ValidarESN", "Controlador")',
                data: { ESN: $("#ControladorPerdida").val() },
                success: function (response) {
                    if (response == 0) {
                        swal('Ups!', '<span>Controlador/Modem no existe en los registros</span>', 'warning');
                        $("#ControladorPerdida").val("");
                        return false;
                    } else {
                        swal('Ok!', '<span>Número Controlador/Modem válido.</span>', 'success');
                        $.ajax({
                            type: "POST",
                            url: '@Url.Action("AgregarNoPerdida", "Controlador")',
                            data: {
                                ESN: $('#ControladorPerdida').val()
                            },
                            success: function (response) {
                                var json = JSON.parse(response);
                                if (json.validador == 0) {
                                    var aux = 'success';
                                } else {
                                    var aux = 'warning';
                                }
                                swal({
                                    title: '',
                                    text: json.Mensaje,
                                    type: aux,
                                    showCancelButton: false,
                                    confirmButtonColor: '#3085d6',
                                    cancelButtonColor: '#d33',
                                    confirmButtonText: 'Aceptar'
                                }).then((result) => {
                                    location.reload();
                                })
                            }
                        });
                    }
                }
            });
        } else {
            $("#ControladorPerdida").css("background", "rgba(255, 0, 0, 0.4)");
        }
    });

    $("#Tipo_accion").change(function () {
        $("button[data-id=Controlador]").css("background", "rgba(255, 0, 0, 0)");
        $("input[name=Archivo]").css("background", "rgba(255, 0, 0, 0)");
        $("#SalidaRetrieval").hide();
        $("#PorNave").hide();
        $("#PorCourier").hide();

        if ($("#Tipo_accion").val() == "0") {
            $("#Log_ingreso").hide();
            $("#div_botones_ingreso").hide();
            $("#div_botones_salida").hide();
            $("#Log_salida").hide();
            $("#div_botones").show();
            $("#Log_perdida").hide();
            $("#div_botones_perdida").hide();
            $("#div_botones_salidanodos").hide();
            $("#Log_salidanodos").hide();

        } else if ($("#Tipo_accion").val() == "1") {

            var tableControlador = $('#Tb_Controlador').DataTable();

            var Info = tableControlador.rows('.selected').data();
            var dataIngreso = [];

            //OBTENER TIPO LUGARES
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetTipoLugares", "TipoLugar")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione un Tipo de Nodo</option>";
                    $("select[name=Tipo_nodo]").empty();
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                    }
                    $("select[name=Tipo_nodo]").append(optionsAsString);
                    $("select[name=Tipo_nodo]").selectpicker("refresh");
                },
            });
            //OBTENER TIPO LUGARES

            for (var i = 0; i < Info.length ; i++) {

                dataIngreso.push([Info[i]["NumControlador"], Info[i]["NodoOrigen"], Info[i]["NodoDestino"],
                                   Info[i]["EmpresaTransporte"], Info[i]["NumeroEnvio"]]);
            }

            var tableIngreso = $('#Tb_Ingreso').DataTable();
            tableIngreso.destroy();
            $("select[name=Continente]").attr('disabled', 'disabled');
            $("select[name=Continente]").val("0");
            $("select[name=Continente]").selectpicker('refresh');

            $("select[name=Pais]").attr('disabled', 'disabled');
            $("select[name=Pais]").val("0");
            $("select[name=Pais]").selectpicker('refresh');

            $("select[name=Ciudad]").attr('disabled', 'disabled');
            $("select[name=Ciudad]").val("0");
            $("select[name=Ciudad]").selectpicker('refresh');

            $("select[name=Nodo]").attr('disabled', 'disabled');
            $("select[name=Nodo]").val("0");
            $("select[name=Nodo]").selectpicker('refresh');


            $("#Log_ingreso").show();
            $('#Fecha_real_arribo').val(moment().format('DD-MM-YYYY'));
            $("#Log_salida").hide();
            $("#div_botones_ingreso").show();
            $("#div_botones_salida").hide();
            $("#Log_perdida").hide();
            $("#div_botones_perdida").hide();
            $("#Log_nota").hide();
            $("#div_botones_salidanodos").hide();
            $("#Log_salidanodos").hide();

            var tableIngreso = $('#Tb_Ingreso').DataTable({
                data: dataIngreso,
            });

            $("button[data-id=Tipo_nodoIngreso]").css("background", "rgba(255, 0, 0, 0)");
            $("button[data-id=NodoIngreso]").css("background", "rgba(255, 0, 0, 0)");
            $("#Fecha_real_arriboIngreso").css("background", "rgba(255, 0, 0, 0)");
            $("#Fecha_real_arriboIngreso").val("");

            $("#Fecha_real_arriboIngreso").datepicker({
                dateFormat: "dd-mm-yy",
                firstDay: 1,
                dayNamesMin: ["Do", "Lu", "Ma", "Mi", "Ju", "Vi", "Sa"],
                dayNamesShort: ["Dom", "Lun", "Mar", "Mie", "Jue", "Vie", "Sab"],
                monthNames:
                    ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio",
                    "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
                monthNamesShort:
                    ["Ene", "Feb", "Mar", "Abr", "May", "Jun",
                    "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"],
                showWeek: true
            });

        } else if ($("#Tipo_accion").val() == "2") {


            $.ajax({
                type: "POST",
                url: '@Url.Action("GetCourierActivos", "Couriers")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione una Empresa de Transporte</option>";
                    $("select[name=Empresa_transporteSalida]").empty();
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id_Courier + "'>" + json[i].NombreCourier + "</option>";
                    }
                    $("select[name=Empresa_transporteSalida]").append(optionsAsString);
                    $("select[name=Empresa_transporteSalida]").selectpicker("refresh");
                },
            });

            //OBTENER TIPO LUGARES
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetTipoLugares", "TipoLugar")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione un Tipo de Nodo</option>";
                    $("select[name=Tipo_nodoSalida]").empty();
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                    }
                    $("select[name=Tipo_nodoSalida]").append(optionsAsString);
                    $("select[name=Tipo_nodoSalida]").selectpicker("refresh");
                },
            });
            //OBTENER TIPO LUGARES

           //Cargar los controladores seleccionados
            var tableControlador = $('#Tb_Controlador').DataTable();

            var Info = tableControlador.rows('.selected').data();
            var dataSalida = [];

            for (var i = 0; i < Info.length ; i++) {
                dataSalida.push([Info[i]["NumControlador"],Info[i]["NodoOrigen"], Info[i]["NodoDestino"]]);

            }
            //Cargar los controladores seleccionados


            var tableSalida = $('#Tb_Salida').DataTable();
            tableSalida.destroy();

            $("select[name=ContinenteSalida]").attr('disabled', 'disabled');
            $("select[name=ContinenteSalida]").val("0");
            $("select[name=ContinenteSalida]").selectpicker('refresh');

            $("select[name=PaisSalida]").attr('disabled', 'disabled');
            $("select[name=PaisSalida]").val("0");
            $("select[name=PaisSalida]").selectpicker('refresh');

            $("select[name=CiudadSalida]").attr('disabled', 'disabled');
            $("select[name=CiudadSalida]").val("0");
            $("select[name=CiudadSalida]").selectpicker('refresh');

            $("select[name=NodoSalida]").attr('disabled', 'disabled');
            $("select[name=NodoSalida]").val("0");
            $("button[data-id=NodoSalida]").css("background", "rgba(255, 0, 0, 0)");
            $("select[name=NodoSalida]").selectpicker('refresh');


            $("#Log_ingreso").hide();
            $('#Fecha_real_arribo').val(moment().format('DD-MM-YYYY'));
            $("#Log_salida").show();
            $("#div_botones_ingreso").hide();
            $("#div_botones_salida").show();
            $("#Log_perdida").hide();
            $("#div_botones_perdida").hide();
            $("#Log_nota").hide();
            $("#div_botones_salidanodos").hide();
            $("#Log_salidanodos").hide();

            $("#Fecha_real_envioSalida").css("background", "rgba(255, 0, 0, 0)");
            $("#Fecha_real_envioSalida").val("");
            $("#EtaSalida").css("background", "rgba(255, 0, 0, 0)");
            $("#EtaSalida").val("");
            $("button[data-id=Tipo_nodoSalida]").css("background", "rgba(255, 0, 0, 0)");

            var tableIngreso = $('#Tb_Salida').DataTable({
                data: dataSalida,
            });


        } else if ($("#Tipo_accion").val() == "3") {
            $("#Log_ingreso").hide();
            $('#Fecha_real_arribo').val(moment().format('DD-MM-YYYY'));
            $("#Log_salida").hide();
            $("#div_botones_ingreso").hide();
            $("#div_botones_salida").hide();
            $("#Log_perdida").show();
            $("#div_botones_perdida").show();
            $("#Log_nota").hide();
            $("#div_botones_salidanodos").hide();
            $("#Log_salidanodos").hide();
            $("#ControladorPerdida").css("background", "rgba(255, 0, 0, 0)");


        } else if ($("#Tipo_accion").val() == "4") {
            $("#Log_ingreso").hide();
            $("#div_botones_ingreso").hide();
            $("#div_botones_salida").hide();
            $("#Log_salida").hide();
            $("#div_botones").show();
            $("#Log_perdida").hide();
            $("#div_botones_perdida").hide();
            $("#div_botones_salidanodos").show();
            $("#Log_salidanodos").show();
            $("#ArchivoSalidaNodos").val("");
            $("#tablanodos").hide();
            var tableIngreso = $('#Tb_SalidaNodos').DataTable();
            tableIngreso.destroy();

        }
    });

    $("select[name=Tipo_nodo]").change(function () {
        $.ajax({
            type: "POST",
            url: '@Url.Action("GetContinentes", "Continente")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                var optionsAsString = "";
                optionsAsString += "<option value='0'>Seleccione un Continente</option>";
                $("select[name=Continente]").empty();
                for (var i = 0; i < cuenta; i++) {
                    optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                }
                $("select[name=Continente]").append(optionsAsString);
                $("select[name=Continente]").removeAttr('disabled');
                $("select[name=Continente]").selectpicker("refresh");
            },
        });

        $.ajax({
            type: "POST",
            url: '@Url.Action("GetPaisesActivos", "Paises")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                var optionsAsString = "";
                optionsAsString += "<option value='0'>Seleccione un Pais</option>";
                $("select[name=Pais]").empty();
                for (var i = 0; i < cuenta; i++) {
                    optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                }
                $("select[name=Pais]").append(optionsAsString);
                $("select[name=Pais]").removeAttr('disabled');
                $("select[name=Pais]").selectpicker("refresh");
            },
        });

        $.ajax({
            type: "POST",
            url: '@Url.Action("GetCiudadesActivas", "Ciudad")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                var optionsAsString = "";
                optionsAsString += "<option value='0'>Seleccione una Ciudad</option>";
                $("select[name=Ciudad]").empty();
                for (var i = 0; i < cuenta; i++) {
                    optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombrePais + "</option>";
                }
                $("select[name=Ciudad]").append(optionsAsString);
                $("select[name=Ciudad]").removeAttr('disabled');
                $("select[name=Ciudad]").selectpicker("refresh");
            },
        });

        $("select[name=Nodo]").removeAttr('disabled');
        $("select[name=Nodo]").selectpicker('refresh');

        if ($("select[name=Tipo_nodo]").val() == "0") {

            $("select[name=Continente]").attr('disabled', 'disabled');
            $("select[name=Continente]").val("0");
            $("select[name=Continente]").selectpicker('refresh');
            $("select[name=Pais]").attr('disabled', 'disabled');
            $("select[name=Pais]").val("0");
            $("select[name=Pais]").selectpicker('refresh');
            $("select[name=Ciudad]").attr('disabled', 'disabled');
            $("select[name=Ciudad]").val("0");
            $("select[name=Ciudad]").selectpicker('refresh');
            $("select[name=Nodo]").attr('disabled', 'disabled');
            $("select[name=Nodo]").val("0");
            $("select[name=Nodo]").selectpicker('refresh');

        } else if ($("select[name=Tipo_nodo]").val() == "1") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetDepositosActivos", "Deposito")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=Nodo]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Deposito</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                    }

                    $("select[name=Nodo]").append(optionsAsString);
                    $("select[name=Nodo]").selectpicker('refresh');
                },
            });
        } else if ($("select[name=Tipo_nodo]").val() == "2") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetPackingActivos", "Packing")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=Nodo]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Packing</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                    }

                    $("select[name=Nodo]").append(optionsAsString);
                    $("select[name=Nodo]").selectpicker('refresh');
                },
            });
        } else if ($("select[name=Tipo_nodo]").val() == "3") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetAntePuertosActivos", "Antepuerto")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=Nodo]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Antepuerto</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                    }

                    $("select[name=Nodo]").append(optionsAsString);
                    $("select[name=Nodo]").selectpicker('refresh');
                },
            });
        } else if ($("select[name=Tipo_nodo]").val() == "4") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetPuertos", "Puertos")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=Nodo]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                    }

                    $("select[name=Nodo]").append(optionsAsString);
                    $("select[name=Nodo]").selectpicker('refresh');
                },
            });
        } else if ($("select[name=Tipo_nodo]").val() == "5") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetPuertos", "Puertos")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=Nodo]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                    }

                    $("select[name=Nodo]").append(optionsAsString);
                    $("select[name=Nodo]").selectpicker('refresh');
                },
            });
        } else if ($("select[name=Tipo_nodo]").val() == "6") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetBodegas", "Bodega")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=Nodo]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Bodega</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                    }

                    $("select[name=Nodo]").append(optionsAsString);
                    $("select[name=Nodo]").selectpicker('refresh');
                },
            });
        }
    });

    $("select[name=Continente]").change(function () {
        if ($("select[name=Continente]").val() == "0") {
            $('#Pais').attr('disabled', 'disabled');
            $('#Pais').val("0");
            $('#Pais').selectpicker('refresh');
            $('#Ciudad').attr('disabled', 'disabled');
            $('#Ciudad').val("0");
            $('#Ciudad').selectpicker('refresh');
            $('#Nodo').attr('disabled', 'disabled');
            $('#Nodo').val("0");
            $('#Nodo').selectpicker('refresh');
        } else {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetPaisesContinente", "Paises")',
                data: { IdContinente: $("select[name=Continente]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    $("select[name=Pais]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Pais</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                    }

                    $("select[name=Pais]").append(optionsAsString);
                    $("select[name=Pais]").selectpicker('refresh');
                },
            });

            $.ajax({
                type: "POST",
                url: '@Url.Action("GetCiudadesContinente", "Ciudad")',
                data: { IdContinente: $("select[name=Continente]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    $("select[name=Ciudad]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Ciudad</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombrePais +"</option>";
                    }

                    $("select[name=Ciudad]").append(optionsAsString);
                    $("select[name=Ciudad]").selectpicker('refresh');
                },
            });

             if ($("#Tipo_nodo").val() == "1") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetDepositoContinente", "Deposito")',
                    data: { IdContinente: $("select[name=Continente]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Deposito</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("#Tipo_nodo").val() == "2") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPackingsContinente", "Packing")',
                    data: { IdContinente: $("select[name=Continente]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Packing</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("#Tipo_nodo").val() == "3") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetAntePuertoContinente", "Antepuerto")',
                    data: { IdContinente: $("select[name=Continente]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Antepuerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("#Tipo_nodo").val() == "4") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertosOrigenContinente", "Puertos")',
                    data: { IdContinente: $("select[name=Continente]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("#Tipo_nodo").val() == "5") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertosDestinoContinente", "Puertos")',
                    data: { IdContinente: $("select[name=Continente]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione ¨Puerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("#Tipo_nodo").val() == "6") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetBodegasaContinente", "Bodega")',
                    data: { IdContinente: $("select[name=Continente]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Bodega</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            }
        }
    });

    $("select[name=Pais]").change(function () {

        if ($("select[name=Pais]").val() == "0") {
            $("select[name=Continente]").val("0");
            $("select[name=Continente]").selectpicker("refresh");

            $.ajax({
                type: "POST",
                url: '@Url.Action("GetCiudadesActivas", "Ciudad")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    $("select[name=Ciudad]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Ciudad</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombrePais + "</option>";
                    }

                    $("select[name=Ciudad]").append(optionsAsString);
                    $("select[name=Ciudad]").selectpicker('refresh');
                },
            });

            if ($("select[name=Tipo_nodo]").val() == "1") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetDepositosActivos", "Deposito")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Deposito</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "2") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPackingActivos", "Packing")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Packing</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "3") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetAntePuertosActivos", "Antepuerto")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Antepuerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "4") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertos", "Puertos")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "5") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertos", "Puertos")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "6") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetBodegas", "Bodega")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Bodega</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            }
        } else {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetInfoPais", "Paises")',
                data: { IdPais: $("select[name=Pais]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    if (cuenta != 0) {
                        $("select[name=Continente]").val(json[0].IdContinente);
                        $("select[name=Continente]").selectpicker('refresh');
                    }
                },
            });

            $.ajax({
                type: "POST",
                url: '@Url.Action("GetCiudadesPais", "Ciudad")',
                data: { IdPais: $("select[name=Pais]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    $('select[name=Ciudad]').empty();
                    optionsAsString += "<option value='0'>Seleccione una Ciudad</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombrePais +"</option>";
                    }
                    $('select[name=Ciudad]').append(optionsAsString);
                    $('select[name=Ciudad]').selectpicker('refresh');
                },
            });

            if ($("select[name=Tipo_nodo]").val() == "1") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetDepositoPais", "Deposito")',
                    data: { IdPais: $("select[name=Pais]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione un Deposito</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "2") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPackingsPais", "Packing")',
                    data: { IdPais: $("select[name=Pais]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione un Packing</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "3") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetAntePuertoPais", "Antepuerto")',
                    data: { IdPais: $("select[name=Pais]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione un Antepuerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "4") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertosOrigenPais", "Puertos")',
                    data: { IdPais: $("select[name=Pais]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "5") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertosDestinoPais", "Puertos")',
                    data: { IdPais: $("select[name=Pais]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "6") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetBodegasPais", "Bodega")',
                    data: { IdPais: $("select[name=Pais]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione una Bodega</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            }
        }
    });

    $("select[name=Ciudad]").change(function () {
        if ($("select[name=Ciudad]").val() == "0") {
            if ($("select[name=Tipo_nodo]").val() == "1") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetDepositosActivos", "Deposito")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Deposito</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }
                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "2") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPackingActivos", "Packing")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Packing</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "3") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetAntePuertosActivos", "Antepuerto")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Antepuerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }
                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "4") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertos", "Puertos")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }
                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "5") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertos", "Puertos")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }
                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "6") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetBodegas", "Bodega")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Bodega</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }
                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            }
        } else {
            if ($("select[name=Tipo_nodo]").val() == "1") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetDepositoCiudad", "Deposito")',
                    data: { IdCiudad: $("select[name=Ciudad]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione un Deposito</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "2") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPackingsCiudad", "Packing")',
                    data: { IdCiudad: $("select[name=Ciudad]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione un Packing</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "3") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetAntePuertoCiudad", "Antepuerto")',
                    data: { IdCiudad: $("select[name=Ciudad]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione un Antepuerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad +"</option>";
                        }

                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "4") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertosOrigenCiudad", "Puertos")',
                    data: { IdCiudad: $("select[name=Ciudad]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "5") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertosDestinoCiudad", "Puertos")',
                    data: { IdCiudad: $("select[name=Ciudad]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodo]").val() == "6") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetBodegasCiudad", "Bodega")',
                    data: { IdCiudad: $("select[name=Ciudad]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=Nodo]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Bodega</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=Nodo]').append(optionsAsString);
                        $('select[name=Nodo]').selectpicker('refresh');
                    },
                });
            }
        }
    });

    $("select[name=Nodo]").change(function () {
        if ($("select[name=Tipo_nodo]").val() == "1") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetInfoDeposito", "Deposito")',
                data: { IdDeposito: $("select[name=Nodo]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    if (cuenta != 0) {
                        $("select[name=Continente]").val(json[0].IdContinente);
                        $("select[name=Continente]").selectpicker('refresh');
                        $("select[name=Pais]").val(json[0].IdPais);
                        $("select[name=Pais]").selectpicker('refresh');
                        $("select[name=Ciudad]").val(json[0].IdCiudad);
                        $("select[name=Ciudad]").selectpicker('refresh');
                    }
                },
            });
        } else if ($("select[name=Tipo_nodo]").val() == "2") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetInfoPacking", "Packing")',
                data: { IdPacking: $("select[name=Nodo]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    if (cuenta != 0) {
                        $("select[name=Continente]").val(json[0].IdContinente);
                        $("select[name=Continente]").selectpicker('refresh');
                        $("select[name=Pais]").val(json[0].IdPais);
                        $("select[name=Pais]").selectpicker('refresh');
                        $("select[name=Ciudad]").val(json[0].IdCiudad);
                        $("select[name=Ciudad]").selectpicker('refresh');
                    }
                },
            });
        } else if ($("select[name=Tipo_nodo]").val() == "3") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetInfoAntepuerto", "Antepuerto")',
                data: { IdAntepuerto: $("select[name=Nodo]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    if (cuenta != 0) {
                        $("select[name=Continente]").val(json[0].IdContinente);
                        $("select[name=Continente]").selectpicker('refresh');
                        $("select[name=Pais]").val(json[0].IdPais);
                        $("select[name=Pais]").selectpicker('refresh');
                        $("select[name=Ciudad]").val(json[0].IdCiudad);
                        $("select[name=Ciudad]").selectpicker('refresh');
                    }
                },
            });
        } else if ($("select[name=Tipo_nodo]").val() == "4") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetInfoPuertoOrigen", "Puertos")',
                data: { IdPuertoOrigen: $("select[name=Nodo]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    if (cuenta != 0) {
                        $("select[name=Continente]").val(json[0].IdContinente);
                        $("select[name=Continente]").selectpicker('refresh');
                        $("select[name=Pais]").val(json[0].IdPais);
                        $("select[name=Pais]").selectpicker('refresh');
                        $("select[name=Ciudad]").val(json[0].IdCiudad);
                        $("select[name=Ciudad]").selectpicker('refresh');
                    }
                },
            });
        } else if ($("select[name=Tipo_nodo]").val() == "6") {
           $.ajax({
                type: "POST",
                url: '@Url.Action("GetInfoBodega", "Bodega")',
               data: { IdBodega: $("select[name=Nodo]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    if (cuenta != 0) {
                        $("select[name=Continente]").val(json[0].IdContinente);
                        $("select[name=Continente]").selectpicker('refresh');
                        $("select[name=Pais]").val(json[0].IdPais);
                        $("select[name=Pais]").selectpicker('refresh');
                        $("select[name=Ciudad]").val(json[0].IdCiudad);
                        $("select[name=Ciudad]").selectpicker('refresh');
                    }
                },
            });
        }
    });

    $("select[name=Tipo_nodoSalida]").change(function () {
        $("#SalidaRetrieval").hide();
        $.ajax({
            type: "POST",
            url: '@Url.Action("GetContinentes", "Continente")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                var optionsAsString = "";
                optionsAsString += "<option value='0'>Seleccione un Continente</option>";
                $("select[name=ContinenteSalida]").empty();
                for (var i = 0; i < cuenta; i++) {
                    optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                }
                $("select[name=ContinenteSalida]").append(optionsAsString);
                $("select[name=ContinenteSalida]").removeAttr('disabled');
                $("select[name=ContinenteSalida]").selectpicker("refresh");
            },
        });

        $.ajax({
            type: "POST",
            url: '@Url.Action("GetPaisesActivos", "Paises")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                var optionsAsString = "";
                optionsAsString += "<option value='0'>Seleccione un Pais</option>";
                $("select[name=PaisSalida]").empty();
                for (var i = 0; i < cuenta; i++) {
                    optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                }
                $("select[name=PaisSalida]").append(optionsAsString);
                $("select[name=PaisSalida]").removeAttr('disabled');
                $("select[name=PaisSalida]").selectpicker("refresh");
            },
        });

        $.ajax({
            type: "POST",
            url: '@Url.Action("GetCiudadesActivas", "Ciudad")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                var optionsAsString = "";
                optionsAsString += "<option value='0'>Seleccione una Ciudad</option>";
                $("select[name=CiudadSalida]").empty();
                for (var i = 0; i < cuenta; i++) {
                    optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombrePais + "</option>";
                }
                $("select[name=CiudadSalida]").append(optionsAsString);
                $("select[name=CiudadSalida]").removeAttr('disabled');
                $("select[name=CiudadSalida]").selectpicker("refresh");
            },
        });

        $("select[name=NodoSalida]").removeAttr('disabled');
        $("select[name=NodoSalida]").selectpicker('refresh');

        if ($("select[name=Tipo_nodoSalida]").val() == "0") {

            $("select[name=ContinenteSalida]").attr('disabled', 'disabled');
            $("select[name=ContinenteSalida]").val("0");
            $("select[name=ContinenteSalida]").selectpicker('refresh');
            $("select[name=PaisSalida]").attr('disabled', 'disabled');
            $("select[name=PaisSalida]").val("0");
            $("select[name=PaisSalida]").selectpicker('refresh');
            $("select[name=CiudadSalida]").attr('disabled', 'disabled');
            $("select[name=CiudadSalida]").val("0");
            $("select[name=CiudadSalida]").selectpicker('refresh');
            $("select[name=NodoSalida]").attr('disabled', 'disabled');
            $("select[name=NodoSalida]").val("0");
            $("select[name=NodoSalida]").selectpicker('refresh');

        } else if ($("select[name=Tipo_nodoSalida]").val() == "1") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetDepositosActivos", "Deposito")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=NodoSalida]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Deposito</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                    }

                    $("select[name=NodoSalida]").append(optionsAsString);
                    $("select[name=NodoSalida]").selectpicker('refresh');
                },
            });
        } else if ($("select[name=Tipo_nodoSalida]").val() == "2") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetPackingActivos", "Packing")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=NodoSalida]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Packing</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                    }

                    $("select[name=NodoSalida]").append(optionsAsString);
                    $("select[name=NodoSalida]").selectpicker('refresh');
                },
            });
        } else if ($("select[name=Tipo_nodoSalida]").val() == "3") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetAntePuertosActivos", "Antepuerto")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=NodoSalida]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Antepuerto</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                    }

                    $("select[name=NodoSalida]").append(optionsAsString);
                    $("select[name=NodoSalida]").selectpicker('refresh');
                },
            });
        } else if ($("select[name=Tipo_nodoSalida]").val() == "4") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetPuertos", "Puertos")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=NodoSalida]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                    }

                    $("select[name=NodoSalida]").append(optionsAsString);
                    $("select[name=NodoSalida]").selectpicker('refresh');
                },
            });
        } else if ($("select[name=Tipo_nodoSalida]").val() == "5") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetPuertos", "Puertos")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=NodoSalida]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                    }

                    $("select[name=NodoSalida]").append(optionsAsString);
                    $("select[name=NodoSalida]").selectpicker('refresh');
                },
            });
        } else if ($("select[name=Tipo_nodoSalida]").val() == "6") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetBodegas", "Bodega")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=NodoSalida]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Bodega</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                    }

                    $("select[name=NodoSalida]").append(optionsAsString);
                    $("select[name=NodoSalida]").selectpicker('refresh');
                },
            });
        }
    });

    $("select[name=ContinenteSalida]").change(function () {
        if ($("select[name=ContinenteSalida]").val() == "0") {
            $('#PaisSalida').attr('disabled', 'disabled');
            $('#PaisSalida').val("0");
            $('#PaisSalida').selectpicker('refresh');
            $('#CiudadSalida').attr('disabled', 'disabled');
            $('#CiudadSalida').val("0");
            $('#CiudadSalida').selectpicker('refresh');
            $('#NodoSalida').attr('disabled', 'disabled');
            $('#NodoSalida').val("0");
            $('#NodoSalida').selectpicker('refresh');
        } else {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetPaisesContinente", "Paises")',
                data: { IdContinente: $("select[name=ContinenteSalida]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    $("select[name=PaisSalida]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Pais</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                    }

                    $("select[name=PaisSalida]").append(optionsAsString);
                    $("select[name=PaisSalida]").selectpicker('refresh');
                },
            });

            $.ajax({
                type: "POST",
                url: '@Url.Action("GetCiudadesContinente", "Ciudad")',
                data: { IdContinente: $("select[name=ContinenteSalida]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    $("select[name=CiudadSalida]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Ciudad</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombrePais + "</option>";
                    }

                    $("select[name=CiudadSalida]").append(optionsAsString);
                    $("select[name=CiudadSalida]").selectpicker('refresh');
                },
            });

            if ($("#Tipo_nodoSalida").val() == "1") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetDepositoContinente", "Deposito")',
                    data: { IdContinente: $("select[name=ContinenteSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoSalida]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Deposito</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=NodoSalida]").append(optionsAsString);
                        $("select[name=NodoSalida]").selectpicker('refresh');
                    },
                });
            } else if ($("#Tipo_nodoSalida").val() == "2") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPackingsContinente", "Packing")',
                    data: { IdContinente: $("select[name=ContinenteSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoSalida]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Packing</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=NodoSalida]").append(optionsAsString);
                        $("select[name=NodoSalida]").selectpicker('refresh');
                    },
                });
            } else if ($("#Tipo_nodoSalida").val() == "3") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetAntePuertoContinente", "Antepuerto")',
                    data: { IdContinente: $("select[name=ContinenteSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoSalida]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Antepuerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=NodoSalida]").append(optionsAsString);
                        $("select[name=NodoSalida]").selectpicker('refresh');
                    },
                });
            } else if ($("#Tipo_nodoSalida").val() == "4") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertosOrigenContinente", "Puertos")',
                    data: { IdContinente: $("select[name=ContinenteSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoSalida]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=NodoSalida]").append(optionsAsString);
                        $("select[name=NodoSalida]").selectpicker('refresh');
                    },
                });
            } else if ($("#Tipo_nodoSalida").val() == "5") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertosDestinoContinente", "Puertos")',
                    data: { IdContinente: $("select[name=ContinenteSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoSalida]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione ¨Puerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=NodoSalida]").append(optionsAsString);
                        $("select[name=NodoSalida]").selectpicker('refresh');
                    },
                });
            } else if ($("#Tipo_nodoSalida").val() == "6") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetBodegasaContinente", "Bodega")',
                    data: { IdContinente: $("select[name=ContinenteSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoSalida]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Bodega</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=NodoSalida]").append(optionsAsString);
                        $("select[name=NodoSalida]").selectpicker('refresh');
                    },
                });
            }
        }
    });

    $("select[name=PaisSalida]").change(function () {

        if ($("select[name=PaisSalida]").val() == "0") {
            $("select[name=ContinenteSalida]").val("0");
            $("select[name=ContinenteSalida]").selectpicker("refresh");

            $.ajax({
                type: "POST",
                url: '@Url.Action("GetCiudadesActivas", "Ciudad")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    $("select[name=CiudadSalida]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Ciudad</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombrePais + "</option>";
                    }

                    $("select[name=CiudadSalida]").append(optionsAsString);
                    $("select[name=CiudadSalida]").selectpicker('refresh');
                },
            });

            if ($("select[name=Tipo_nodoSalida]").val() == "1") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetDepositosActivos", "Deposito")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoSalida]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Deposito</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=NodoSalida]").append(optionsAsString);
                        $("select[name=NodoSalida]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "2") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPackingActivos", "Packing")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoSalida]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Packing</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=NodoSalida]").append(optionsAsString);
                        $("select[name=NodoSalida]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "3") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetAntePuertosActivos", "Antepuerto")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoSalida]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Antepuerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=NodoSalida]").append(optionsAsString);
                        $("select[name=NodoSalida]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "4") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertos", "Puertos")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoSalida]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=NodoSalida]").append(optionsAsString);
                        $("select[name=NodoSalida]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "5") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertos", "Puertos")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoSalida]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=NodoSalida]").append(optionsAsString);
                        $("select[name=NodoSalida]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "6") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetBodegas", "Bodega")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoSalida]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Bodega</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $("select[name=NodoSalida]").append(optionsAsString);
                        $("select[name=NodoSalida]").selectpicker('refresh');
                    },
                });
            }
        } else {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetInfoPais", "Paises")',
                data: { IdPais: $("select[name=PaisSalida]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    if (cuenta != 0) {
                        $("select[name=ContinenteSalida]").val(json[0].IdContinente);
                        $("select[name=ContinenteSalida]").selectpicker('refresh');
                    }
                },
            });

            $.ajax({
                type: "POST",
                url: '@Url.Action("GetCiudadesPais", "Ciudad")',
                data: { IdPais: $("select[name=PaisSalida]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    $('select[name=CiudadSalida]').empty();
                    optionsAsString += "<option value='0'>Seleccione una Ciudad</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombrePais + "</option>";
                    }
                    $('select[name=CiudadSalida]').append(optionsAsString);
                    $('select[name=CiudadSalida]').selectpicker('refresh');
                },
            });

            if ($("select[name=Tipo_nodoSalida]").val() == "1") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetDepositoPais", "Deposito")',
                    data: { IdPais: $("select[name=PaisSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione un Deposito</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "2") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPackingsPais", "Packing")',
                    data: { IdPais: $("select[name=PaisSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione un Packing</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "3") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetAntePuertoPais", "Antepuerto")',
                    data: { IdPais: $("select[name=PaisSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione un Antepuerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "4") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertosOrigenPais", "Puertos")',
                    data: { IdPais: $("select[name=PaisSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "5") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertosDestinoPais", "Puertos")',
                    data: { IdPais: $("select[name=PaisSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "6") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetBodegasPais", "Bodega")',
                    data: { IdPais: $("select[name=PaisSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione una Bodega</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            }
        }
    });

    $("select[name=CiudadSalida]").change(function () {
        if ($("select[name=CiudadSalida]").val() == "0") {
            if ($("select[name=Tipo_nodoSalida]").val() == "1") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetDepositosActivos", "Deposito")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Deposito</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }
                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "2") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPackingActivos", "Packing")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Packing</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "3") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetAntePuertosActivos", "Antepuerto")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Antepuerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }
                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "4") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertos", "Puertos")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }
                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "5") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertos", "Puertos")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }
                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "6") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetBodegas", "Bodega")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Bodega</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }
                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            }
        } else {
            if ($("select[name=Tipo_nodoSalida]").val() == "1") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetDepositoCiudad", "Deposito")',
                    data: { IdCiudad: $("select[name=CiudadSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione un Deposito</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "2") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPackingsCiudad", "Packing")',
                    data: { IdCiudad: $("select[name=CiudadSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione un Packing</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "3") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetAntePuertoCiudad", "Antepuerto")',
                    data: { IdCiudad: $("select[name=CiudadSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione un Antepuerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "4") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertosOrigenCiudad", "Puertos")',
                    data: { IdCiudad: $("select[name=CiudadSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "5") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertosDestinoCiudad", "Puertos")',
                    data: { IdCiudad: $("select[name=CiudadSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            } else if ($("select[name=Tipo_nodoSalida]").val() == "6") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetBodegasCiudad", "Bodega")',
                    data: { IdCiudad: $("select[name=CiudadSalida]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $('select[name=NodoSalida]').empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Bodega</option>";

                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + " - " + json[i].NombreCiudad + "</option>";
                        }

                        $('select[name=NodoSalida]').append(optionsAsString);
                        $('select[name=NodoSalida]').selectpicker('refresh');
                    },
                });
            }
        }
    });

    $("select[name=NodoSalida]").change(function () {
        if ($("select[name=Tipo_nodoSalida]").val() == "1") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetInfoDeposito", "Deposito")',
                data: { IdDeposito: $("select[name=NodoSalida]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    if (cuenta != 0) {
                        $("select[name=ContinenteSalida]").val(json[0].IdContinente);
                        $("select[name=ContinenteSalida]").selectpicker('refresh');
                        $("select[name=PaisSalida]").val(json[0].IdPais);
                        $("select[name=PaisSalida]").selectpicker('refresh');
                        $("select[name=CiudadSalida]").val(json[0].IdCiudad);
                        $("select[name=CiudadSalida]").selectpicker('refresh');
                    }
                },
            });
        } else if ($("select[name=Tipo_nodoSalida]").val() == "2") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetInfoPacking", "Packing")',
                data: { IdPacking: $("select[name=NodoSalida]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    if (cuenta != 0) {
                        $("select[name=ContinenteSalida]").val(json[0].IdContinente);
                        $("select[name=ContinenteSalida]").selectpicker('refresh');
                        $("select[name=PaisSalida]").val(json[0].IdPais);
                        $("select[name=PaisSalida]").selectpicker('refresh');
                        $("select[name=CiudadSalida]").val(json[0].IdCiudad);
                        $("select[name=CiudadSalida]").selectpicker('refresh');
                    }
                },
            });
        } else if ($("select[name=Tipo_nodoSalida]").val() == "3") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetInfoAntepuerto", "Antepuerto")',
                data: { IdAntepuerto: $("select[name=NodoSalida]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    if (cuenta != 0) {
                        $("select[name=ContinenteSalida]").val(json[0].IdContinente);
                        $("select[name=ContinenteSalida]").selectpicker('refresh');
                        $("select[name=PaisSalida]").val(json[0].IdPais);
                        $("select[name=PaisSalida]").selectpicker('refresh');
                        $("select[name=CiudadSalida]").val(json[0].IdCiudad);
                        $("select[name=CiudadSalida]").selectpicker('refresh');
                    }
                },
            });
        } else if ($("select[name=Tipo_nodoSalida]").val() == "4") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetInfoPuertoOrigen", "Puertos")',
                data: { IdPuertoOrigen: $("select[name=NodoSalida]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    if (cuenta != 0) {
                        $("select[name=ContinenteSalida]").val(json[0].IdContinente);
                        $("select[name=ContinenteSalida]").selectpicker('refresh');
                        $("select[name=PaisSalida]").val(json[0].IdPais);
                        $("select[name=PaisSalida]").selectpicker('refresh');
                        $("select[name=CiudadSalida]").val(json[0].IdCiudad);
                        $("select[name=CiudadSalida]").selectpicker('refresh');
                    }
                },
            });
        } else if ($("select[name=Tipo_nodoSalida]").val() == "6") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetInfoBodega", "Bodega")',
                data: { IdBodega: $("select[name=NodoSalida]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    if (cuenta != 0) {
                        $("select[name=ContinenteSalida]").val(json[0].IdContinente);
                        $("select[name=ContinenteSalida]").selectpicker('refresh');
                        $("select[name=PaisSalida]").val(json[0].IdPais);
                        $("select[name=PaisSalida]").selectpicker('refresh');
                        $("select[name=CiudadSalida]").val(json[0].IdCiudad);
                        $("select[name=CiudadSalida]").selectpicker('refresh');
                    }
                },
            });
        }
    });




    $("#TipoEnvio").change(function () {
        if ($("#TipoEnvio").val() == "0")
        {
            $("#PorNave").hide();
            $("#PorCourier").hide();
        }
        else if ($("#TipoEnvio").val() == "1")
        {
            $("#PorNave").hide();
            $("#PorCourier").show();
            $("#Nave_salida").val("0");
            $("#Viaje_salida").val("");
        }
        else
        {
            $("#PorNave").show();
            $("#PorCourier").hide();
            $("#Numero_envioSalida").val("");
            $("#Empresa_transporteSalida").val("0");
        }
    });

    $("#Guardar_ingreso").click(function () {
        var tableIngreso = $('#Tb_Ingreso').DataTable();
        var InfoIngreso = tableIngreso.rows().data();
        if (InfoIngreso.length != 0) {

            if ($("#Tipo_nodoIngreso").val() == "0") {
                $("button[data-id=Tipo_nodoIngreso]").css("background", "rgba(255, 0, 0, 0.4)");
                return false;
            } else {
                $("button[data-id=Tipo_nodoIngreso]").css("background", "rgba(255, 0, 0, 0)");
            }

            if ($("#NodoIngreso").val() == "0") {
                $("button[data-id=NodoIngreso]").css("background", "rgba(255, 0, 0, 0.4)");
                return false;
            } else {
                $("button[data-id=NodoIngreso]").css("background", "rgba(255, 0, 0, 0)");
            }

            if ($("#Fecha_real_arriboIngreso").val() == "") {
                $("#Fecha_real_arriboIngreso").css("background", "rgba(255, 0, 0, 0.4)");
                return false;
            } else {
                $("#Fecha_real_arriboIngreso").css("background", "rgba(255, 0, 0, 0)");
            }

            var contControllers = 0;
            var contModems = 0;
            var msge = "";
            var Controladores = [];

                for (var i = 0; i < InfoIngreso.length ; i++) {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("AgregarIngreso", "Controlador")',
                        data: {
                            Controlador: InfoIngreso[i][0],
                            Modem: "",
                            FechaArribo: $("#Fecha_real_arriboIngreso").val(),
                            TipoNodoDestino: $("#Tipo_nodoIngreso").val(),
                            NodoDestino: $("#NodoIngreso").val(),
                            Nota: $("#Nota_logistica_ingreso").val(),
                            Involucrados: 1

                        },
                        success: function (response) {
                            var json = JSON.parse(response);
                            if (json.validador == 0) {
                                var aux = 'success';
                            } else {
                                var aux = 'warning';
                            }
                            swal({
                                title: '',
                                text: json.Mensaje,
                                type: aux,
                                showCancelButton: false,
                                confirmButtonColor: '#3085d6',
                                cancelButtonColor: '#d33',
                                confirmButtonText: 'Aceptar'
                            }).then((result) => {
                                location.reload();
                            })
                        }
                    });
                }



        } else {
            swal('Ups!', '<span class="alerta" key="errorcontroladoreslogistica">Debe seleccionar al menos un controlador.</span>', 'error');
        }
    });

    $(".AgregarcontroladorIngreso").click(function () {
        if ($("#ControladorIngreso").val() != "") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("ValidarESN", "Controlador")',
                data: { ESN: $("#ControladorIngreso").val() },
                success: function (response) {
                    if (response == 0) {
                        swal('Ups!', '<span>ESN no existe en los registros</span>', 'warning');
                        $("#ControladorIngreso").val("");
                        return false;
                    } else {
                        swal('Ok!', '<span>Número ESN válido.</span>', 'success');

                        var cuentaaux = $('#Tb_Ingreso tr').length - 2;
                        var tableControlador = $('#Tb_Ingreso').DataTable();
                        var Info = tableControlador.rows().data();
                        var i = 0;
                        $("#ControladorIngreso").css("background", "rgba(255, 0, 0, 0)");

                        if (Info.length != 0) {
                            while (i < Info.length) {
                                if (Info[i][0] == $("#ControladorIngreso").val() || Info[i][1] == $("#ControladorIngreso").val()) {
                                    swal('Ups!', '<span class="alerta" key="errorcontroladortabla">ESN seleccionado ya existe en la tabla.</span>', 'error');
                                    return false;
                                } else {
                                    i++;
                                }
                            }
                        }

                        $.ajax({
                            type: "POST",
                            url: '@Url.Action("GetESNByNumberESN", "Controlador")',
                            data: { NumESN: $("#ControladorIngreso").val() },
                            success: function (response) {
                                var json = JSON.parse(response);
                                var cuenta = json.length;
                                var cuentatabla = $('#Tb_Ingreso tr').length - 2;
                                var tableIngreso = $('#Tb_Ingreso').DataTable();
                                for (var i = 0 ; i < cuenta ; i++) {
                                    tableIngreso.row.add([
                                        json[i].Controlador,
                                        json[i].NodoOrigen,
                                        json[i].NodoDestino,
                                        json[i].EmpresaTransporte,
                                        json[i].NumeroEnvio
                                    ]).draw(false);

                                    cuentatabla++;
                                }
                            }
                        });
                    }
                }
            });
        } else {
            $("#ControladorIngreso").css("background", "rgba(255, 0, 0, 0.4)");
        }
    });

    $(".SubirArchivoIngreso").click(function () {
        if ($('#ArchivoIngreso').val() != "") {
            $("#ArchivoIngreso").css("background", "rgba(255, 0, 0, 0)");
            var fileUpload = document.getElementById("ArchivoIngreso");
            if (fileUpload.value != null) {
                var uploadFile = new FormData();
                var files = $("#ArchivoIngreso").get(0).files;
                // Add the uploaded file content to the form data collection
                if (files.length > 0) {
                    uploadFile.append("Controladores", files[0]);
                    $.ajax({
                        url: '@Url.Action("LeerExcel1", "Controlador")',
                        contentType: false,
                        processData: false,
                        data: uploadFile,
                        type: 'POST',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            if (cuenta != 0) {
                                if (json[0].Controlador == undefined) {
                                    swal('Ups!', '<span> Error de Extensión del archivo.</span>', 'error');
                                    return false;
                                } else {
                                    for (var i = 0 ; i < cuenta ; i++) {
                                        data.push([json[i].Controlador,
                                        json[i].NodoOrigen,
                                        json[i].NodoDestino,
                                        json[i].FechaEnvio,
                                        json[i].EmpresaTransporte]);
                                    }
                                    var tableIngreso = $('#Tb_Ingreso').DataTable();
                                    tableIngreso.destroy();
                                    var tableIngreso = $('#Tb_Ingreso').DataTable({
                                        data: data,
                                    });
                                }
                            } else {
                                swal('Ups!', '<span> Archivo no cumple con el formato correcto.</span>', 'error');
                                return false;
                            }
                        }
                    });
                }
            }
        } else {
            $("#ArchivoIngreso").css("background", "rgba(255, 0, 0, 0.4)");
        }
    });

   $("#Guardar_salida").click(function () {
        var tableSalida = $('#Tb_Salida').DataTable();
        var InfoSalida = tableSalida.rows().data();
        var empresatransporte = 1;
        if (InfoSalida.length != 0) {
        // Add the uploaded file content to the form data collection

            // valida selección de ETA
            if ($("#EtaSalida").val() == "") {
                $("#EtaSalida").css("background", "rgba(255, 0, 0, 0.4)");
                return false;
            } else {
                $("#EtaSalida").css("background", "rgba(255, 0, 0, 0)");
            }

            // valida selección de Tipo Nodo Salida
            if ($("#Tipo_nodoSalida").val() == "0") {
                $("button[data-id=Tipo_nodoSalida]").css("background", "rgba(255, 0, 0, 0.4)");
                return false;
            } else {
                $("button[data-id=Tipo_nodoSalida]").css("background", "rgba(255, 0, 0, 0)");
            }

            // valida selección de Nodo Salida
            if ($("#NodoSalida").val() == "0") {
                $("button[data-id=NodoSalida]").css("background", "rgba(255, 0, 0, 0.4)");
                return false;
            } else {
                $("button[data-id=NodoSalida]").css("background", "rgba(255, 0, 0, 0)");
            }


            var contControllers = 0;
            var contModems = 0;
            var msge = "";
            var Controladores = [];

                for (var i = 0; i < InfoSalida.length ; i++) {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("AgregarSalida", "Controlador")',
                        data: {
                            Controlador: InfoSalida[i][0],
                            Modem: "",
                            FechaEnvio: "01/01/1990",
                            FechaRecuperacion: $("#Fecharealrecuperacion").val(),
                            Eta: $("#EtaSalida").val(),
                            NumeroEnvio: $("#Numero_envioSalida").val(),
                            Courier: $("#Empresa_transporteSalida").val(),
                            TipoNodoDestino: $("#Tipo_nodoSalida").val(),
                            NodoDestino: $("#NodoSalida").val(),
                            Nota: $("#Nota_logistica_salida").val(),
                            IdNave: 0,
                            Viaje: "",
                            Retrieval: 0,
                            //Fallas: Fallas,
                            Involucrados: 1,
                        },
                        success: function (response) {
                            var json = JSON.parse(response);
                            if (json.validador == 0) {
                                var aux = 'success';
                            } else {
                                var aux = 'warning';
                            }
                            swal({
                                title: '',
                                text: json.Mensaje,
                                type: aux,
                                showCancelButton: false,
                                confirmButtonColor: '#3085d6',
                                cancelButtonColor: '#d33',
                                confirmButtonText: 'Aceptar'
                            }).then((result) => {
                                location.reload();

                            })
                        }
                    });
                }
        } else {
            swal('Ups!', '<span class="alerta" key="errorcontroladoreslogistica">Debe seleccionar al menos un controlador.</span>', 'error');
        }
    });

   

    $(".AgregarcontroladorSalida").click(function () {
        if ($("#ControladorSalida").val() != "") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("ValidarESN", "Controlador")',
                data: { ESN: $("#ControladorSalida").val() },
                success: function (response) {
                    if (response == 0) {
                        swal('Ups!', '<span>ESN no existe en los registros</span>', 'warning');
                        $("#ControladorSalida").val("");
                        return false;
                    } else {
                        swal('Ok!', '<span>Número ESN válido.</span>', 'success');
                        var cuentaaux = $('#Tb_Salida tr').length - 2;
                        var tableControlador = $('#Tb_Salida').DataTable();
                        var Info = tableControlador.rows().data();
                        var i = 0;
                        $("#ControladorSalida").css("background", "rgba(255, 0, 0, 0)");


                        if (Info.length != 0) {
                            while (i < Info.length) {
                                if (Info[i][0] == $("#ControladorSalida").val()) {
                                    swal('Ups!', '<span class="alerta" key="errorcontroladortabla">Controlador seleccionado ya existe en la tabla.</span>', 'error');
                                    return false;
                                } else {
                                    i++;
                                }
                            }
                        }

                        $.ajax({
                            type: "POST",
                            url: '@Url.Action("GetESNByNumberESN", "Controlador")',
                            data: { NumESN: $("#ControladorSalida").val() },
                            success: function (response1) {
                                var json = JSON.parse(response1);
                                var cuenta = json.length;
                                var cuentatabla = $('#Tb_Salida tr').length - 2;
                                var tableIngreso = $('#Tb_Salida').DataTable();
                                for (var i = 0 ; i < cuenta ; i++) {
                                    tableIngreso.row.add([
                                        json[i].Controlador,
                                        json[i].NodoOrigen,
                                        json[i].NodoDestino
                                    ]).draw(false);

                                    cuentatabla++;
                                }
                            }
                        });
                    }
                }
            });
        } else {
            $("#ControladorSalida").css("background", "rgba(255, 0, 0, 0.4)");
        }
    });

   

    $(".SubirArchivoSalida").click(function () {
        if ($('#ArchivoSalida').val() != "") {
            $("#ArchivoSalida").css("background", "rgba(255, 0, 0, 0)");
            var fileUpload = document.getElementById("ArchivoSalida");
            if (fileUpload.value != null) {
                var uploadFile = new FormData();
                var files = $("#ArchivoSalida").get(0).files;
                // Add the uploaded file content to the form data collection
                if (files.length > 0) {
                    uploadFile.append("Controladores", files[0]);
                    $.ajax({
                        url: '@Url.Action("LeerExcel1", "Controlador")',
                        contentType: false,
                        processData: false,
                        data: uploadFile,
                        type: 'POST',
                        success: function (response) {
                            var data = [];
                            var controladoresValidados = [];
                            var controladoresNoValidados = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            if (cuenta != 0) {
                                if (json == "Error de datos") {
                                    swal('Ups!', '<span> Error de Datos.</span>', 'error');
                                    return false;
                                } else if (json == "Error de formato") {
                                    swal('Ups!', '<span> Error de Formato.</span>', 'error');
                                    return false;
                                } else if (json == "Error de datos, algunos controladores no poseen servicios") {
                                    swal('Ups!', '<span> Error de datos, algunos ESNs no poseen servicios.</span>', 'error');
                                    return false;
                                }
                                else {

                                    for (var i = 0 ; i < cuenta ; i++) {

                                        data.push([json[i].Controlador, json[i].NodoOrigen, json[i].NodoDestino]);
                                    }

                                        var tableIngreso = $('#Tb_Salida').DataTable();
                                        tableIngreso.destroy();
                                        var tableIngreso = $('#Tb_Salida').DataTable({
                                            data: data,
                                        });


                                }
                            }
                        }
                    });
                }
            }
        } else {
            $("#ArchivoSalida").css("background", "rgba(255, 0, 0, 0.4)");
        }
    });




    $("#Logistica").click(function () {

        $("#Log_ingreso").hide();
        $("#Log_salida").hide();
        $("#div_botones").show();
        $("#Log_perdida").hide();
        $("#div_botones_perdida").hide();
        $("#Log_nota").hide();
        $("#div_botones_salidanodos").hide();
        $("#Log_salidanodos").hide();
        $("#Tipo_accion").val(0);
        $("#Tipo_accion").selectpicker("refresh");

        $("#EtaSalida, #Fecha_real_envioSalida,#Fecha_real_envioIngreso, #Fecha_real_arriboSalida, #Fecha_recupera, #Fecha_real_arriboIngreso, #Fecharealrecuperacion, #FecharealrecuperacionIngreso").datepicker({
            dateFormat: "dd-mm-yy",
            firstDay: 1,
            dayNamesMin: ["Do", "Lu", "Ma", "Mi", "Ju", "Vi", "Sa"],
            dayNamesShort: ["Dom", "Lun", "Mar", "Mie", "Jue", "Vie", "Sab"],
            monthNames:
                ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio",
                "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
            monthNamesShort:
                ["Ene", "Feb", "Mar", "Abr", "May", "Jun",
                "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"],
            showWeek: true
        });

        $('#LogisticaControlador').trigger('click');
    });

    function formatDate(date) {
        if (date != null) {
            var fecha = date.substring(0, 10);
            var ano = date.substring(0, 4);
            var mes = date.substring(5, 7);
            var dia = date.substring(8, 10);
            return dia + "/" + mes + "/" + ano;
        } else {
            return "";
        }

    }

    $("#Historico").click(function () {

        var table = $('#Tb_Historico').DataTable();
        table.destroy();

        $('#Tb_Historico tfoot th').each(function (i) {
            var title = $('#Tb_Historico thead th').eq($(this).index()).text();
            $(this).html('<input class="form-control" type="text" placeholder="FILTER" />');

        });

        var table = $("#Tb_Historico").DataTable({
            scrollX: true,
            ajax: {
                "url": "@Url.Action("GetHistoricoControlador", "Controlador")",
            "dataSrc": ''
            },
            dom: 'Bfrtip',
            buttons: [
                'excel'
            ],
            columns: [
                { "data": "NumControlador" },
                { "data": "IdControlador" },
                { "data": "Modem" },
                { "data": "TipoMovimiento" },
                { "data": "TipoLugarOrigen" },
                { "data": "LugarOrigen" },
                { "data": "TipoLugarDestino" },
                { "data": "LugarDestino" },
                { "data": "TipoLugarRecuperacion" },
                { "data": "LugarRecuperacion" },
                { "data": "FechaEnvio",
                    "render":
                    function (data, type, row, meta) {
                        if (data != null) {
                            var fecha = FormatDate(data);
                            return fecha;
                        } else {
                            return "";
                        }
                    }
                },
                { "data": "FechaEntrada",
                    "render":
                    function (data, type, row, meta) {
                        if (data != null) {
                            var fecha = FormatDate(data);
                            return fecha;
                        } else {
                            return "";
                        }
                    }
                },
                { "data": "FechaRecuperacion",
                    "render":
                    function (data, type, row, meta) {
                        if (data != null) {
                            var fecha = FormatDate(data);
                            return fecha;
                        } else {
                            return "";
                        }
                    }
                },
            ],
        });

        table.columns().every(function () {
            var that = this;
            $('input', this.footer()).on('keyup change', function () {
                if (that.search() !== this.value) {
                    that
                        .search(this.value)
                        .draw();
                }
            });
        });

        $('#HistoricoControlador').trigger('click');
    });


  
    $("#Fecha_inicio_filtro, #Fecha_termino_filtro, #FechaPerdida").datepicker({
        dateFormat: "dd-mm-yy",
        firstDay: 1,
        dayNamesMin: ["Do", "Lu", "Ma", "Mi", "Ju", "Vi", "Sa"],
        dayNamesShort: ["Dom", "Lun", "Mar", "Mie", "Jue", "Vie", "Sab"],
        monthNames:
            ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio",
            "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
        monthNamesShort:
            ["Ene", "Feb", "Mar", "Abr", "May", "Jun",
            "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"],
        showWeek: true
    });

    function validarcontrolador(Controlador)
    {
        var valor = null;
        $.ajax({
            async: false,
            type: "POST",
            global: false,
            url: '@Url.Action("ValidarControladorServicio", "Controlador")',
            data: { Controlador: Controlador },
            success: function (response) {
                json = JSON.parse(response);
                valor = json;
            },
        });
        return valor;
    }

    $("#AgregarFalla").click(function () {
        //Cargar los controladores seleccionados
        var tableControlador = $('#Tb_Controlador').DataTable();

        var Info = tableControlador.rows('.selected').data();
        var dataSalida = [];

        for (var i = 0; i < Info.length ; i++) {
            if (Info[i]["DamageReportTxt"] != "YES") {
                dataSalida.push(Info[i]["NumControlador"]);
            }
        }

        if (dataSalida.length != 0) {
            for (var i = 0; i < dataSalida.length ; i++) {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("AgregarDamageReport", "Controlador")',
                    data: {
                        Controlador: dataSalida[i]
                    },
                    success: function (response) {
                        var json = JSON.parse(response);
                        if (json.validador == 0) {
                            var aux = 'success';
                        } else {
                            var aux = 'warning';
                        }
                        swal({
                            title: '',
                            text: json.Mensaje,
                            type: aux,
                            showCancelButton: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {
                            location.reload();
                        })
                    }
                });
            }
        } else {
            swal('Ups!', '<span> Error en la selección de datos.</span>', 'error');
        }
    });

    $("#QuitarFalla").click(function () {
        //Cargar los controladores seleccionados
        var tableControlador = $('#Tb_Controlador').DataTable();

        var Info = tableControlador.rows('.selected').data();
        var dataSalida = [];

        for (var i = 0; i < Info.length ; i++) {
            if (Info[i]["DamageReportTxt"] != "NO") {
                dataSalida.push(Info[i]["NumControlador"]);
            }
        }

        if (dataSalida.length != 0) {
            for (var i = 0; i < dataSalida.length ; i++) {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("QuitarDamageReport", "Controlador")',
                    data: {
                        Controlador: dataSalida[i]
                    },
                    success: function (response) {
                        var json = JSON.parse(response);
                        if (json.validador == 0) {
                            var aux = 'success';
                        } else {
                            var aux = 'warning';
                        }
                        swal({
                            title: '',
                            text: json.Mensaje,
                            type: aux,
                            showCancelButton: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {
                            location.reload();
                        })
                    }
                });
            }
        } else {
            swal('Ups!', '<span> Error en la selección de datos.</span>', 'error');
        }
    });

</script>


