
@{
    ViewBag.Title = "ConsultarResultadosLeaktest";
    Layout = "~/Views/MasterPage.cshtml";
}

<!--Select2-->
<link rel="stylesheet" href="~/Vendors/Chosen/chosen.min.css">
<script src="~/Vendors/Chosen/chosen.jquery.min.js"></script>



<style>
    tfoot input {
        width: 100%;
        padding: 3px;
        box-sizing: border-box;
    }
</style>
<div class="col-sm-12">
    <div class="x_panel">
        <div class="x_title">
            <div class="row">
                <div class="col-sm-6">
                    <h2 class="tr" key="tituloresultadoleaktest">Gestión resultados leak test</h2>
                </div>
            </div>
            <div class="clearfix"></div>
        </div>
        <div class="x_panel">
            <div class="x_title">
                <h2 class="tr" key="filtrofechas">Filtro de Fechas</h2>
                <div class="clearfix"></div>
            </div>
            <div class="row">
                <div class="col-lg-9">
                    <form class="form-inline">
                        <div class="form-group">
                            <label for="FechaIni" class="control-label tr" key="fechainicio">Fecha Inicio</label>
                            <input type="text" class="form-control" id="FechaIni" />
                        </div>
                        <div class="form-group">
                            <label for="FechaFin" class="control-label tr" key="entre">Entre</label>
                            <input type="text" class="form-control" id="FechaFin" />
                        </div>

                    </form>
                </div>
                <div class="col-lg-3">
                    <button type="button" class="btn btn-success tr" key="filtrar" id="FiltroFechas">Filtrar</button>
                    <button type="button" class="btn btn-warning tr" key="limpiar" id="Limpiar">Limpiar</button>
                </div>
            </div>
        </div>
        <div class="x_panel">
            <div class="x_content">
                <table id="Tb_Resultado" class="display table table-striped table-bordered" cellspacing="0">
                    <thead>
                        <tr>
                            <th></th>
                            <th class="tr" key="idsolicitud">ID SOLICITUD</th>
                            <th class="tr" key="maquinariatabla">MAQUINARIA</th>
                            <th class="tr" key="serviceprovidertabla">SERVICE PROVIDER</th>
                            <th class="tr" key="tecnicotabla">TECNICO</th>
                            @*<th class="tr" key="tiempotabla">TIEMPO</th>*@
                            <th class="tr" key="presiontabla">PRESIÓN</th>
                            <th class="tr" key="contenedortabla">CONTENEDOR</th>
                            <th class="tr" key="cajacontenedortabla">CAJA CONTENENDOR</th>
                            <th class="tr" key="anocontenedortabla">AÑO CONTENEDOR</th>
                            <th class="tr" key="controladortabla">CONTROLADOR (ESN)</th>
                            <th class="tr" key="bateriatabla">N° BATERIA CONTROLADOR</th>
                            <th class="tr" key="modemtabla">MODEM (ESN)</th>
                            <th class="tr" key="bateriamodemtabla">N° BATERIA MODEM</th>
                            <th class="tr" key="scrubbertabla">LLEVA SCRUBBER</th>
                            <th class="tr" key="selloperno1tabla">SELLO PANEL 1</th>
                            <th class="tr" key="selloperno2tabla">SELLO PANEL 2</th>
                            <th class="tr" key="sellotapatabla">SELLO SECURITY</th>
                            <th class="tr" key="fechaejecuciontabla">FECHA EJECUCION</th>
                            <th class="tr" key="ComentariosLeaktest">COMENTARIOS</th>
                            <th class="tr" key="estadotabla">ESTADO</th>
                            <th class="tr" key="KitCortina">CONTIENE KIT CORTINA</th>
                            <th class="tr" key="idresultado">ID RESULTADO</th>
                        </tr>
                    </thead>
                    <tbody>
                    <tfoot>
                        <tr>
                            <th></th>
                            <th class="tr" key="idsolicitud">ID SOLICITUD</th>
                            <th class="tr" key="maquinariatabla">MAQUINARIA</th>
                            <th class="tr" key="serviceprovidertabla">SERVICE PROVIDER</th>
                            <th class="tr" key="tecnicotabla">TECNICO</th>
                            @*<th class="tr" key="tiempotabla">TIEMPO</th>*@
                            <th class="tr" key="presiontabla">PRESIÓN</th>
                            <th class="tr" key="contenedortabla">CONTENEDOR</th>
                            <th class="tr" key="cajacontenedortabla">CAJA CONTENENDOR</th>
                            <th class="tr" key="anocontenedortabla">AÑO CONTENEDOR</th>
                            <th class="tr" key="controladortabla">CONTROLADOR (ESN)</th>
                            <th class="tr" key="bateriatabla">N° BATERIA CONTROLADOR</th>
                            <th class="tr" key="modemtabla">MODEM (ESN)</th>
                            <th class="tr" key="bateriamodemtabla">N° BATERIA MODEM</th>
                            <th class="tr" key="scrubbertabla">LLEVA SCRUBBER</th>
                            <th class="tr" key="selloperno1tabla">SELLO PANEL 1</th>
                            <th class="tr" key="selloperno2tabla">SELLO PANEL 2</th>
                            <th class="tr" key="sellotapatabla">SELLO SECURITY</th>
                            <th class="tr" key="fechaejecuciontabla">FECHA EJECUCION</th>
                            <th class="tr" key="ComentariosLeaktest">COMENTARIOS</th>
                            <th class="tr" key="estadotabla">ESTADO</th>
                            <th class="tr" key="KitCortina">CONTIENE KIT CORTINA</th>
                            <th class="tr" key="idresultado">ID RESULTADO</th>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-4">
                <form class="form-inline">
                    <div class="form-group">
                        <label for="IdResultado" class="control-label tr" key="IDRESEULTADO">ID RESULTADO</label>
                        <input type="text" class="input form-control" id="IdResultado" disabled="disabled" style="text-align:center; text-align-last:center;" />
                    </div>

                </form>
            </div>
        </div>
        <div class="divider"></div>
        <div class="row">
            <div class="col-lg-11 col-lg-offset-1">
                <button type="button" class="btn btn-success tr" id="AgregarResultado" key="botonagregarresultado" style="margin-bottom: 0px;">Agregar resultado leak test</button>
                <button type="button" class="btn btn-primary editar tr" id="EditarResultado" key="botoneditarresultado" style="margin-bottom: 0px;">Editar resultado leak test</button>
                <button type="button" class="btn btn-danger eliminar tr" id="EliminarResultado" key="botoneliminarrresultado" style="margin-bottom: 0px;">Eliminar Resultado Leaktest</button>
                <button type="button" class="btn btn-warning tr" id="LeaktestReport" key="botonleaktestreport" style="margin-bottom: 0px;">Generar Leak test Report</button>
                <button type="button" class="btn btn-primary tr" id="TraspasarResultados" key="MoverResultados" style="margin-bottom: 0px;">Traspasar Resultados</button>
                <button class="btn btn-primary tr btn-success btn-sm" key="asociarbateria" id="AsociarBateria">Asociar Bateria a Equipo</button>
                @*<button type="button" class="btn btn-warning detalle tr " id="DetalleResultado" style="margin-bottom: 0px;" key="botondetallerresultado">Ver Comentarios / Archivos</button>
                    <button type="button" class="btn btn-info notaagregar tr" id="AgregarNota" style="margin-bottom: 0px;" key="botonagregarcomentario">Agregar Comentario</button>
                    <button type="button" class="btn btn-info tr archivoagregar tr" id="AgregarArchivo" style="margin-bottom: 0px;" key="botonagregararchivo">Agregar Archivo</button>*@
            </div>
        </div>
    </div>

    <!--Modal para Asociar Bateria-->
    <div class="modal fade" id="myModalAsociarBateria" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="margin-left:80px; margin-right:10px;">
        <div class="modal-dialog" role="document" style="width:100%">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title tr" id="myModalLabel" key="tituloloasociarbateria"> Asociar Bateria a un equipo</h4>
                </div>
                <div class="modal-body">
                    <div class="row x_panel">
                        <div class="x_panel">
                            <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                <div class="col-lg-3 col-md-3 col-sm-3">
                                    <label id="lb_id" class="control-label tr" key="bateria">Batería (*)</label>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-12" style="text-align:center">
                                    <input type="text" class="form-control" autocomplete="off" name="BateriaAsociada" id="BateriaAsociada" />
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-3">
                                    <button class="btn btn-primary tr btn-primary btn-sm" key="ValidarBateria" id="ValidarBateria">Validar</button>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                <div class="col-lg-3 col-md-3 col-sm-3">

                                    <label id="lb_id" class="control-label tr" key="numeroESN">Número ESN  (*)</label>
                                </div>
                                <div class="col-md-3 col-sm-3 col-xs-3">
                                    <input type="text" onkeyup="this.value = this.value.toUpperCase();" class="form-control" autocomplete="off" name="ESN" id="ESN" />
                                </div>

                                <div class="col-lg-1 col-md-1 col-sm-1">
                                    <label id="lb_id" class="control-label tr" key="tipoESN">Tipo Equipo (*)</label>
                                </div>
                                <div class="col-md-3 col-sm-3 col-xs-3">
                                    <select class="selectpicker form-control" id="tipo_esn" data-live-search="true">
                                        <option value="0" selected>Seleccione Tipo ESN</option>
                                        <option value="1">CONTROLADOR</option>
                                        <option value="2">MODEM</option>
                                    </select>
                                </div>
                                <div class="col-lg-1 col-md-1 col-sm-1">
                                </div>



                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                <div class="col-lg-3 col-md-3 col-sm-3">
                                    <label id="lb_id" class="control-label tr" key="fechaAsociacion">Fecha Asociación (*)</label>
                                </div>
                                <div class="col-md-3 col-sm-3 col-xs-3">
                                    <input type="text" id="FechaAsociacion" class="form-control" autocomplete="off">
                                </div>
                                <div class="col-lg-1 col-md-1 col-sm-1">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" id="div_botones_salida">
                    <button type="button" class="btn btn-success tr" id="Guardar_asociacion" key="botonguardarlogistica">Guardar</button>
                    <button type="button" class="btn btn-danger tr" data-dismiss="modal" key="botoncancelarlogistica">Cancelar</button>
                </div>
            </div>
        </div>
    </div>
    <!--Modal para Asociar Bateria-->
    <!--Modal Detalle Resultado Leaktest-->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="margin-left:80px; margin-right:10px;" data-backdrop="static">
        <div class="modal-dialog" role="document" style="width:100%">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h2 class="modal-title tr" id="myModalLabel" key="tituloresultado">Detalle resultado leak test</h2>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-sm-12 col-md-12 col-lg-12">
                            <table id="Tb_Notas" class="table table-striped table-bordered" style="width:100%">
                                <thead>
                                    <tr>
                                        <th class="tr" key="comentario">ID COMENTARIO</th>
                                        <th class="tr" key="descripcioncomentario">DESCRIPCION</th>
                                        <th class="tr" key="fechacomentario">FECHA</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                        <form class="form-inline">
                            <div class="form-group">
                                <label for="IdNota" class="control-label tr" key="comentario">ID COMENTARIO</label>
                                <input type="text" class="input-sm form-control" id="IdNota" disabled="disabled" style="text-align:center; text-align-last:center;" />
                            </div>
                            <button type="button" class="btn btn-danger notaeliminar tr" id="EliminarNota" key="botoneliminarnota" style="margin-bottom: 0px;">Eliminar Comentario</button>
                        </form>
                        <div class="col-sm-12 col-md-12 col-lg-12">
                            <div class="divider"></div>
                            <table id="Tb_Archivos" class="table table-striped table-bordered" style="width:100%">
                                <thead>
                                    <tr>
                                        <th class="tr" key="archivo">ID ARCHIVO</th>
                                        <th class="tr" key="descripcionarchivo">DESCRIPCION</th>
                                        <th class="tr" key="fechaarchivo">FECHA</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                        <form class="form-inline">
                            <div class="form-group">
                                <label for="IdArchivo" class="control-label tr" key="archivo">ID Archivo</label>
                                <input type="text" class="input form-control" id="IdArchivo" disabled="disabled" style="text-align:center; text-align-last:center;" />
                                <input type="text" class="input form-control" id="NombreArchivo" disabled="disabled" style="text-align:center; text-align-last:center; display:none;" />
                            </div>
                            <button type="button" class="btn btn-danger tr archivoeliminar" id="EliminarArchivo" key="botoneliminararchivo" style="margin-bottom: 0px;">Eliminar Archivo</button>
                            <button type="button" class="btn btn-success tr archivodescargar" id="DescargarArchivo" key="botondescargararchivo" style="margin-bottom: 0px;">Descargar Archivo</button>

                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Modal Detalle Resultado Leaktest-->
    <!--Modal Modificar Resultado Leaktest-->
    <div class="modal fade" id="myModal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-backdrop="static">
        <div class="modal-dialog" role="document" style="width:800px">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h2 class="modal-title tr" id="myModalLabel2" key="tituloresultado">Editar resultado leaktest </h2>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <form class="form-horizontal">
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="contenedor">N° Contenedor (*)</label>
                                    <div>
                                        <input type="text" class="form-control contenedor" name="contenedor" id="contenedoreditar" disabled />
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="cajacontenedor">Caja Contenedor (*)</label>
                                    <div>
                                        <select class="selectpicker form-control" id="cajacontenedoreditar" data-live-search="true">
                                            <option selected value="0" class="tr" key="seleccionecaja"></option>
                                            <option value="1">CIMC</option>
                                            <option value="2">SINGAMAS</option>
                                            <option value="3">QUIDONG</option>
                                            <option value="4">MCI</option>
                                            <option value="7">FUWA</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="anocontenedor">Año contenedor</label>
                                    <div>
                                        <input type="text" class="form-control anocontenedor" id="anocontenedoreditar" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="serviceprovider">Service Provider (*)</label>
                                    <div>
                                        <select class="selectpicker form-control" id="ServiceProvider" data-live-search="true"></select>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="tecnico">Técnico (*)</label>
                                    <div>
                                        <select class="selectpicker form-control" id="Tecnicos" data-live-search="true"></select>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="presion">Presión (*) [inH2O]</label>
                                    <div>
                                        <input type="number" step="0.01" class="form-control" id="Presion" />
                                    </div>
                                </div>
                                @*<div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                        <label class="control-label tr" key="tiempo">Tiempo (*) [MM:SS]</label>
                                        <div>
                                            <input type="time" class="form-control" id="Tiempo" />
                                        </div>
                                    </div>*@
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="fechaejecucion">Fecha Ejecución (*)</label>
                                    <div>
                                        <input type="text" name="FechaEjecucion" id="FechaEjecucion" class="form-control Fecha" autocomplete="off">
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="controlador">Controlador (ESN)</label>
                                    <div>
                                        <input type="text" name="Controlador" class="form-control" id="Controladoreditar" onkeyup="this.value = this.value.toUpperCase();" />
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="bateria">N° Bateria Controlador</label>
                                    <div>
                                        <input type="text" name="Bateria" id="Bateriaeditar" class="form-control" onkeyup="this.value = this.value.toUpperCase();" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="controlador">Modem (ESN)</label>
                                    <div>
                                        <input type="text" name="Modem" class="form-control" id="ModemEditar" onkeyup="this.value = this.value.toUpperCase();" />
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="bateria">N° Bateria Modem</label>
                                    <div>
                                        <input type="text" name="BateriaModem" id="BateriaModemEditar" class="form-control" onkeyup="this.value = this.value.toUpperCase();" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="selloperno1">Sello panel 1</label>
                                    <div>
                                        <input type="text" name="selloperno1" class="form-control" id="Selloperno1Editar" onkeyup="this.value = this.value.toUpperCase();" />
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="selloperno2">Sello panel 2</label>
                                    <div>
                                        <input type="text" name="selloperno2" class="form-control" id="Selloperno2Editar" onkeyup="this.value = this.value.toUpperCase();" />
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="sellotapa">Sello Tapa Security</label>
                                    <div>
                                        <input type="text" name="sellotapa" class="form-control" id="SellotapaEditar" onkeyup="this.value = this.value.toUpperCase();" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label id="InspeccionEditar" class="control-label">Rechazar inspección Visual</label>
                                    <div>
                                        <input id="InspeccionEditar" type="checkbox" class="checkbox-inline Inspeccion" />
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="maquinariacontenedor">Maquinaria (*)</label>
                                    <select class="selectpicker form-control" id="MaquinariaEditar" data-live-search="true" disabled></select>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="scrubber">¿Lleva Scrubber? (*)</label>
                                    <select class="selectpicker form-control" id="ScrubberEditar" data-live-search="true">
                                        <option value="-1" selected class="tr" key="seleccione">Seleccione ...</option>
                                        <option value="0" class="tr" key="si">Si</option>
                                        <option value="1" class="tr" key="no">No</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label id="KitCortinaLabel" class="control-label tr" key="ContieneCortina">¿Contiene kit cortina Liventus?</label>
                                    <select class="selectpicker form-control" id="KitCortinaEditar" data-live-search="true">
                                        <option value="-1" selected class="tr" key="seleccione">Seleccione ...</option>
                                        <option value="0" class="tr" key="si">SI</option>
                                        <option value="1" class="tr" key="no">NO</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12" style="text-align:center">
                                <label class="control-label tr" key="ComentarioLeaktest">Comentarios</label>
                                <textarea id="ComentarioEditar" class="form-control" style="resize:none;" rows="3"></textarea>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success alerta" id="Editarresultadomodal" key="botoneditarresultado">Editar Leak test</button>
                </div>
            </div>
        </div>
    </div>
    <!--Modal Modificar Resultado Leaktest-->
    <!--Modal para Agregar Resultado Leaktest-->
    <div class="modal fade" id="myModal3" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-backdrop="static">
        <div class="modal-dialog" role="document" style="width:800px">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h2 class="modal-title tr" id="myModalLabel3" key="tituloagregarresultado">Agregar Resultado Leak test</h2>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <form class="form-horizontal">
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="contenedor">Contenedor (*)</label>
                                    <div class="poraprobar" hidden="hidden">
                                        <input type="text" onkeyup="this.value = this.value.toUpperCase();" class="form-control contenedor" id="contenedor" name="contenedor" minlength="1" maxlength="11" />
                                    </div>
                                    <div class="porcontenedor" hidden="hidden">
                                        <select class="selectpicker form-control" data-live-search="true" id="Contenedores"></select>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="cajacontenedor">Caja Contenedor (*)</label>
                                    <div>
                                        <select class="selectpicker form-control cajacontenedor" data-live-search="true">
                                            <option selected value="0" class="tr" key="seleccionecaja"></option>
                                            <option value="1">CIMC</option>
                                            <option value="2">SINGAMAS</option>
                                            <option value="3">QUIDONG</option>
                                            <option value="4">MCI</option>
                                            <option value="7">FUWA</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="anocontenedor">Año contenedor (*)</label>
                                    <div>
                                        <input type="number" class="form-control anocontenedor" id="anocontenedor" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="serviceprovider">Service provider (*)</label>
                                    <div>
                                        <select class="selectpicker form-control" id="ServiceProviderAgregar" data-live-search="true"></select>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="tecnico">Técnico (*)</label>
                                    <div>
                                        <select class="selectpicker form-control" id="tecnicosAgregar" data-live-search="true" disabled></select>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="presion">Presión (*) [inH2O]</label>
                                    <div>
                                        <input type="number" step="0.01" class="form-control" id="PresionAgregar" />
                                    </div>
                                </div>
                                @*<div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                        <label class="control-label tr" key="tiempo">Tiempo (*) [MM:SS]</label>
                                        <div>
                                            <input type="time" class="form-control tiempo" />
                                        </div>
                                    </div>*@
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="fechaejecucion">Fecha Ejecución (*)</label>
                                    <div>
                                        <input type="text" name="FechaEjecucion" class="form-control Fecha" id="FechaAgregar" autocomplete="off">
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="controlador">Controlador (ESN)</label>
                                    <div>
                                        <input type="text" onkeyup="this.value = this.value.toUpperCase();" class="form-control" autocomplete="off" name="Controlador" id="ControladorAgregar" />
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="bateria">N° Bateria</label>
                                    <div>
                                        <input type="text" id="BateriaAgregar" name="Bateria" class="form-control Bateria" onkeyup="this.value = this.value.toUpperCase();" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="controlador">Modem (ESN)</label>
                                    <div>
                                        <input type="text" name="Controlador" class="form-control" id="ModemAgregar" onkeyup="this.value = this.value.toUpperCase();" />
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="bateria">N° Bateria Modem</label>
                                    <div>
                                        <input type="text" name="Bateria" id="BateriaModemAgregar" class="form-control" onkeyup="this.value = this.value.toUpperCase();" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <!--div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center"-->
                                <!--label>label class="control-label tr" key="">Modem (ESN)</label-->
                                <!--div>
                                    <input type="text" onkeyup="this.value = this.value.toUpperCase();" class="form-control" autocomplete="off" name="Modem" id="ModemAgregar" />
                                </div-->
                                <!--/div-->
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="selloperno1">Sello panel 1</label>
                                    <div>
                                        <input type="text" name="selloperno1" class="form-control" id="Selloperno1" onkeyup="this.value = this.value.toUpperCase();" />
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="selloperno2">Sello panel 2</label>
                                    <div>
                                        <input type="text" name="selloperno2" class="form-control" id="Selloperno2" onkeyup="this.value = this.value.toUpperCase();" />
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="sellotapa">Sello Tapa Security</label>
                                    <div>
                                        <input type="text" name="sellotapa" class="form-control" id="Sellotapa" onkeyup="this.value = this.value.toUpperCase();" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12">

                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label id="Inspeccion" class="control-label">Rechazar inspección Visual</label>
                                    <div>
                                        <input id="Inspeccion" type="checkbox" class="checkbox-inline Inspeccion" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="maquinariacontenedor">Maquinaria (*)</label>
                                    <select class="selectpicker form-control" id="MaquinariaAgregar" data-live-search="true" disabled>
                                        <option value="0" selected class="tr" key="selectmaquinariatabla">Seleccione Maquinaria</option>
                                    </select>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr" key="scrubber">¿Lleva Scrubber? (*)</label>
                                    <select class="selectpicker form-control" id="Scrubber" data-live-search="true">
                                        <option value="-1" selected class="tr" key="seleccione">Seleccione ...</option>
                                        <option value="0" class="tr" key="si">SI</option>
                                        <option value="1" class="tr" key="no">NO</option>
                                    </select>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label id="KitCortinaLabel" class="control-label tr" key="ContieneCortina">¿Contiene kit cortina Liventus?</label>
                                    <select class="selectpicker form-control" id="KitCortina" data-live-search="true">
                                        <option value="-1" selected class="tr" key="seleccione">Seleccione ...</option>
                                        <option value="0" class="tr" key="si">SI</option>
                                        <option value="1" class="tr" key="no">NO</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12" style="text-align:center">
                                <label class="control-label tr" key="ComentarioLeaktest">Comentarios</label>
                                <textarea id="Comentario" class="form-control" style="resize:none;" rows="3"></textarea>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success tr" id="AgregarResultadoDatos" key="botonagregarresultado">Agregar Resultado Leaktest</button>
                </div>
            </div>
        </div>
    </div>
    <!--Modal para Agregar Resultado Leaktest-->
    <!--Modal para Traspasar Resultado Leaktest-->
    <div class="modal fade" id="myModal4" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-backdrop="static">
        <div class="modal-dialog" role="document" style="width:800px">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h2 class="modal-title tr" key="TraspasarResultados">Traspasar Resultados de Leak Test</h2>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <form class="form-horizontal">
                            <div class="col-lg-12 col-md-12 col-sm-12" style="text-align:center">
                                <label class="control-label tr" key="IDSOLICITUDLEAKTEST">ID SOLICITUD (*)</label>
                                <div>
                                    <select class="selectpicker form-control" data-live-search="true" id="Solicitudes"></select>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success tr" id="BotonTraspasar" key="TraspasarResultados">Traspasar Resultados</button>
                </div>
            </div>
        </div>
    </div>
    <!--Modal para Traspasar Resultado Leaktest-->
</div>

<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal" id="Detalles" style="display:none;"></button>
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal2" id="Editar" style="display:none;"></button>
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal3" id="Agregar" style="display:none;"></button>
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal4" id="Traspaso" style="display:none;"></button>
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModalAsociarBateria" id="AsociarBateriaTrigger" style="display:none;"></button>


<script src="~/build/js/Perfiles.js"></script>
<script src="~/build/js/PerfilGestionResultadosLeaktest.js"></script>

<script type="text/javascript">

    var lenguaje = getCookie("Lenguaje");

    if("@ViewBag.TipoReserva" == "BYCONTAINERNUMBER"){
        $("#AgregarResultado").css("visibility", "hidden")
    }

    $(document).ready(function () {
        var Estado = parseInt(@ViewBag.Estado);

        $('#Tb_Resultado tfoot th').each(function (i) {
            var title = $('#Tb_Resultado thead th').eq($(this).index()).text();
            if (lenguaje == "es") {
                $(this).html('<input class="form-control" type="text" placeholder="FILTRAR" />');
            } else {
                $(this).html('<input class="form-control" type="text" placeholder="FILTER" />');
            }
        });

        var IdReserva = parseInt(@ViewBag.IdReserva);
        $.ajax({
            type: "POST",
            url: '@Url.Action("GetResultadosLeaktest","Leaktest")',
            data: { IdReserva: IdReserva },
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.Resultados.length;
                for (var i = 0 ; i < cuenta ; i++) {
                    if (json.Resultados[i].Estado == 0) {
                        Estado = "APPROVED";
                    } else if (json.Resultados[i].Estado == 1) {
                        Estado = "REJECTED";
                    } else if (json.Resultados[i].Estado == 2) {
                        Estado = "TO PERFORM";
                    }else if(json.Resultados[i].Estado == 3){
                        Estado = "VISUALLY REJECTED";
                    }
                    if (json.Resultados[i].Scrubber == 0) {
                        var scrubber = 'SI';
                    } else {
                        var scrubber = 'NO';
                    }

                    if(json.Resultados[i].KitCortina==0)
                    {
                        var kit="SI";
                    }else
                    {
                        var kit="NO";
                    }

                    data.push([ "",json.Resultados[i].IdReserva, json.Resultados[i].IdMaquinaria, json.Resultados[i].IdServiceProvider,
                                json.Resultados[i].IdTecnico, json.Resultados[i].Presion, json.Resultados[i].Contenedor, json.Resultados[i].CajaContenedor,
                                json.Resultados[i].AnoContenedor,json.Resultados[i].Controlador,json.Resultados[i].Bateria, json.Resultados[i].Modem,
                                json.Resultados[i].BateriaModem, scrubber,json.Resultados[i].Selloperno1,json.Resultados[i].Selloperno2,json.Resultados[i].Sellotapa,
                                formatDate(json.Resultados[i].FechaRealizacion),json.Resultados[i].Comentario, Estado, kit, json.Resultados[i].Id]);
                }
                if (lenguaje == "es") {
                    var table = $('#Tb_Resultado').DataTable({
                        data: data,
                        "language": {
                            "lengthMenu": "Mostrar _MENU_ Resultados por pagina",
                            "zeroRecords": "No hay Resultados para mostrar",
                            "info": "Mostrando pagina _PAGE_ de _PAGES_ paginas",
                            "infoEmpty": "No hay Resultados disponibles",
                            "paginate": {
                                "first": "Primera",
                                "last": "Última",
                                "next": "Siguiente",
                                "previous": "Anterior"
                            }
                        },
                        dom: 'Bfrtip',
                        buttons: [
                            'copy', 'csv', 'excel'
                        ],
                        scrollX: true,
                        'columnDefs': [
                           {
                               'targets': 0,
                               'id' : "hola",
                               'checkboxes': {
                                   'selectRow': true
                               }
                           }
                        ],
                        'select': {
                            'style': 'multi'
                        },
                        scrollY:        "500px",
                        scrollX:        true,
                        scrollCollapse: true,
                        paging:         false,
                        fixedColumns:   true
                    });
                } else {
                    var table = $('#Tb_Resultado').DataTable({
                        data: data,
                        dom: 'Bfrtip',
                        buttons: [
                            'copy', 'csv', 'excel'
                        ],
                        scrollX: true,
                        'columnDefs': [
                           {
                               'targets': 0,
                               'id' : "hola",
                               'checkboxes': {
                                   'selectRow': true
                               }
                           }
                        ],
                        'select': {
                            'style': 'multi'
                        },
                        scrollY:        "500px",
                        scrollX:        true,
                        scrollCollapse: true,
                        paging:         false,
                        fixedColumns:   true
                    });
                }

                $('#example-select-all').on('click', function(){
                    // Get all rows with search applied
                    var rows = table.rows({ 'search': 'applied' }).nodes();
                    // Check/uncheck checkboxes for all rows in the table
                    $('input[type="checkbox"]', rows).prop('checked', this.checked);

                });

                $('#Tb_Resultado tbody').on('click', 'tr', function () {
                    if(cuenta != 0){
                        if ($(this).hasClass('selected')) {
                            $("#IdResultado").val(this.children[21].innerText);
                            $(this).removeClass('selected');
                        }
                        else {
                            table.$('tr.selected').removeClass('selected');
                            $("#IdResultado").val(this.children[21].innerText);
                            $(this).addClass('selected');
                        }
                    }
                });

                table.columns().every(function () {
                    var that = this;
                    $('input', this.footer()).on('keyup change', function () {
                        if (that.search() !== this.value) {
                            that
                                .search(this.value)
                                .draw();
                        }
                    });
                });
            },
        });

        if(lenguaje == "es") {
            $(".Fecha").datepicker({
                dateFormat: "dd-mm-yy",
                firstDay: 1,
                dayNamesMin: ["Do", "Lu", "Ma", "Mi", "Ju", "Vi", "Sa"],
                dayNamesShort: ["Dom", "Lun", "Mar", "Mie", "Jue", "Vie", "Sab"],
                monthNames:
                    ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio",
                    "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
                monthNamesShort:
                    ["Ene", "Feb", "Mar", "Abr", "May", "Jun",
                    "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"],
                showWeek: true
            });
            $("#FechaFin, #FechaIni, #FechaAsociacion").datepicker({
                dateFormat: "dd-mm-yy",
                firstDay: 1,
                dayNamesMin: ["Do", "Lu", "Ma", "Mi", "Ju", "Vi", "Sa"],
                dayNamesShort: ["Dom", "Lun", "Mar", "Mie", "Jue", "Vie", "Sab"],
                monthNames:
                    ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio",
                    "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
                monthNamesShort:
                    ["Ene", "Feb", "Mar", "Abr", "May", "Jun",
                    "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"],
                showWeek: true
            });
        }else{
            $(".Fecha").datepicker({
                dateFormat: "dd-mm-yy",
                firstDay: 1,
                showWeek: true
            });
            $("#FechaFin, #FechaIni, #FechaAsociacion").datepicker({
                dateFormat: "dd-mm-yy",
                firstDay: 1,
                showWeek: true
            });
        }
});


    $("#EditarResultado").click(function () {

        var TipoReserva = "@ViewBag.TipoReserva";
        var idReserva = parseInt(@ViewBag.IdReserva);

        if ($("#IdResultado").val() != "") {
            //OBTENER MAQUINARIAS
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetMaquinariasActivas", "Maquinaria")',
                async: false,
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    $('#MaquinariaEditar').empty();
                    if(lenguaje == "es") {
                        optionsAsString += "<option value='0'>Seleccione Maquinaria</option>";
                    }else{
                        optionsAsString += "<option value='0'>Select Machinery</option>";
                    }
                    for (var i = 0; i < cuenta; i++) {

                        if (json[i].Id != 5) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }
                    }

                    $('#MaquinariaEditar').append(optionsAsString);
                    $('#MaquinariaEditar').selectpicker('refresh');
                },
            });
            //OBTENER MAQUINARIAS

            //OBTENER SERVICE PROVIDER
            $.ajax({
                type: "POST",
                async: false,
                url: '@Url.Action("GetServiceProviderActivas", "ServiceProvider")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    $('#ServiceProvider').empty();
                    if(lenguaje == "es") {
                        optionsAsString += "<option value='0'>Seleccione Service Provider</option>";
                    }else{
                        optionsAsString += "<option value='0'>Select Service Provider</option>";
                    }
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].IdServiceProvider + "'>" + json[i].NombreServiceProvider + "</option>";
                    }
                    $('#ServiceProvider').append(optionsAsString);
                    $('#ServiceProvider').selectpicker('refresh');
                },
            });
            //OBTENER SERVICE PROVIDER

            //OBTENER TECNICOS
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetTecnicos", "Usuarios")',
                async: false,
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    $('#Tecnicos').empty();
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].IdTecnico + "'>" + json[i].NombreTecnico + "</option>";
                    }
                    $('#Tecnicos').append(optionsAsString);
                    $('#Tecnicos').selectpicker('refresh');
                },
            });
            //OBTENER TECNICOS

            //OBTENER DATOS DEL RESULTADO A EDITAR
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetResultadoById", "Leaktest")',
                data: { IdResultado: $("#IdResultado").val() },
                async: false,
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;

                    if(TipoReserva == "BYCONTAINERNUMBER"){

                        $("#contenedoreditar").prop('disabled', 'disabled');
                        $("#MaquinariaEditar").prop('disabled', 'disabled');
                    }

                    $("#contenedoreditar").val(json.Contenedor);
                    $("#cajacontenedoreditar").val(parseInt(json.CajaContenedor));
                    $('#cajacontenedoreditar').selectpicker('refresh');
                    $("#anocontenedoreditar").val(json.AnoContenedor);
                    $("#ServiceProvider").val(json.IdServiceProvider);
                    $('#ServiceProvider').selectpicker('refresh');
                    $("#Tecnicos").val(json.IdTecnico);
                    $('#Tecnicos').selectpicker('refresh');
                    $("#Presion").val(json.Presion);
                    $("#FechaEjecucion").val(formatDate(json.FechaRealizacion));
                    $("#Controladoreditar").val(json.Controlador);
                    $("#Bateriaeditar").val(json.Bateria);
                    $("#MaquinariaEditar").val(json.IdMaquinaria);
                    $('#MaquinariaEditar').selectpicker('refresh');
                    $("#ScrubberEditar").val(json.Scrubber);
                    $('#ScrubberEditar').selectpicker('refresh');
                    $("#Selloperno1Editar").val(json.Selloperno1);
                    $("#Selloperno2Editar").val(json.Selloperno2);
                    $("#SellotapaEditar").val(json.Sellotapa);
                    $("#KitCortinaEditar").val(json.KitCortina);
                    $('#KitCortinaEditar').selectpicker('refresh');
                    $("#ModemEditar").val(json.Modem);
                    $("#BateriaModemEditar").val(json.BateriaModem);
                },
            });
            //OBTENER DATOS DEL RESULTADO A EDITAR

            $('#Editar').trigger('click');

        } else {
            swal('Ups!', '<span class="alerta" key="erroreditarresultado">Debe seleccionar un resultado para editar su información</span>', 'error');
        }
    });

    //OBTENER TECNICOS SEGUN SERVICE PROVIDER SELECCIONADO
    $("#ServiceProvider").change(function () {
        $.ajax({
            type: "POST",
            url: '@Url.Action("GetTecnicosByServiceProvider", "Usuarios")',
            data: { IdServiceProvider: $("#ServiceProvider").val() },
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                var optionsAsString = "";
                $('#Tecnicos').empty();
                if(lenguaje == "es") {
                    optionsAsString += "<option value='0'>Seleccione un Técnico</option>";
                }else{
                    optionsAsString += "<option value='0'>Select Technician</option>";
                }
                if (cuenta != 0) {
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].IdTecnico + "'>" + json[i].NombreTecnico + "</option>";
                    }
                    $('#Tecnicos').append(optionsAsString);
                    $('#Tecnicos').selectpicker('refresh');
                } else {
                    if(lenguaje == "es") {
                        optionsAsString += "<option value='0'>Seleccione un Técnico</option>";
                    }else{
                        optionsAsString += "<option value='0'>Select Technician</option>";
                    }
                    $('#Tecnicos').empty();
                    $('#Tecnicos').append(optionsAsString);
                    $('#Tecnicos').prop('disabled', 'disabled');
                    $('#Tecnicos').selectpicker('refresh');
                }

            },
        });
    });
    //OBTENER TECNICOS SEGUN SERVICE PROVIDER SELECCIONADO

    $("#AgregarResultado").click(function () {
        $("#FechaAgregar").val(moment().format('DD-MM-YYYY'));
        $('#ServiceProviderAgregar').empty();
        $('#ServiceProviderAgregar').selectpicker('refresh');

        $('#tecnicosAgregar').empty();
        $('#tecnicosAgregar').selectpicker('refresh');

        $('#Contenedores').empty();
        $('#Contenedores').selectpicker('refresh');

        $('#contenedor').val("");
        $('.cajacontenedor').val(0);
        $('.cajacontenedor').selectpicker('refresh');

        $('#anocontenedor').val("");
        $('#PresionAgregar').val("");

        $('#ControladorAgregar').val("");
        $('.Bateria').val("");

        $('#ModemAgregar').val("");
        $('#BateriaModemAgregar').val("");

        $('#Selloperno1').val("");
        $('#Selloperno2').val("");
        $('#Sellotapa').val("");

        document.getElementById("BateriaAgregar").disabled = false;
        document.getElementById("BateriaModemAgregar").disabled = false;

        //OBTENER SERVICESPROVIDER
        $.ajax({
            type: "POST",
            url: '@Url.Action("GetServiceProviderActivas", "ServiceProvider")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                var optionsAsString = "";
                var optionsAsString1 = "";
                if(lenguaje == "es") {
                    optionsAsString += "<option value='0'>Seleccione Service Provider</option>";
                    optionsAsString1 += "<option value='0'>Seleccione Técnico</option>";
                }else{
                    optionsAsString += "<option value='0'>Select Service Provider</option>";
                    optionsAsString1 += "<option value='0'>Seleccione Technician</option>";
                }

                for (var i = 0; i < cuenta; i++) {
                    optionsAsString += "<option value='" + json[i].IdServiceProvider + "'>" + json[i].NombreServiceProvider + "</option>";
                }
                $('#ServiceProviderAgregar').append(optionsAsString);
                $('#ServiceProviderAgregar').selectpicker('refresh');
                $('#tecnicosAgregar').append(optionsAsString1);
                $('#tecnicosAgregar').selectpicker('refresh');
            },
        });
        //OBTENER SERVICESPROVIDER

        //OBTENER MAQUINARIAS
        $.ajax({
            type: "POST",
            url: '@Url.Action("GetMaquinariasActivas", "Maquinaria")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                var optionsAsString = "";
                $('#MaquinariaAgregar').empty();
                for (var i = 0; i < cuenta; i++) {
                    if (json[i].Id != 5) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                    }
                }
                $('#MaquinariaAgregar').append(optionsAsString);
                $('#MaquinariaAgregar').selectpicker('refresh');
            },
        });

        //OBTENER MAQUINARIAS
        var aux = "@ViewBag.TipoReserva";
        var idReserva = parseInt(@ViewBag.IdReserva);

        if(aux == "BYCONTAINERNUMBER"){
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetContenedoresByReserva", "Contenedores")',
                data: { IdReserva : idReserva},
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    if(lenguaje == "es") {
                        optionsAsString += "<option value='0'>Seleccione Contenedor</option>";
                    }else{
                        optionsAsString += "<option value='0'>Select Container</option>";
                    }
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='"+json[i].IdMaquinaria+"'>" + json[i].Contenedor + "</option>";
                    }
                    $('#Contenedores').append(optionsAsString);
                    $('#Contenedores').selectpicker('refresh');
                },
            });

            $("#Contenedores").change(function () {
                if($("#Contenedores").val() != 0){
                    $("#MaquinariaAgregar").val($("#Contenedores").val());
                    $("#MaquinariaAgregar").selectpicker('refresh');
                    $("#contenedor").val($("#Contenedores").find("option:selected").text());
                }else{
                    $('#MaquinariaAgregar').removeAttr('disabled');
                    $("#contenedor").val($("#Contenedores").find("option:selected").text());
                }
            });

            $(".porcontenedor").show();
            $(".poraprobar").hide();
        }else if (aux == "TOBEAPPROVED"){
            $('#MaquinariaAgregar').removeAttr('disabled');
            $(".poraprobar").show();
            $(".porcontenedor").hide();

        }

        $('#Agregar').trigger('click');
    });

    //OBTENER TECNICOS SEGUN SERVICE PROVIDER
    $("#ServiceProviderAgregar").change(function () {
        $('#tecnicosAgregar').removeAttr('disabled');
        $.ajax({
            type: "POST",
            url: '@Url.Action("GetTecnicosByServiceProvider", "Usuarios")',
            data: { IdServiceProvider: $("#ServiceProviderAgregar").val() },
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                var optionsAsString = "";

                if(lenguaje == "es") {
                    optionsAsString += "<option value='0'>Seleccione Técnico</option>";
                }else{
                    optionsAsString += "<option value='0'>Select Technician</option>";
                }

                $('#tecnicosAgregar').empty();
                if (cuenta != 0) {
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].IdTecnico + "'>" + json[i].NombreTecnico + "</option>";
                    }
                    $('#tecnicosAgregar').append(optionsAsString);
                    $('#tecnicosAgregar').selectpicker('refresh');
                } else {
                    if(lenguaje == "es") {
                        optionsAsString += "<option value='0'>Seleccione Técnico</option>";
                    }else{
                        optionsAsString += "<option value='0'>Select Technician</option>";
                    }
                    $('#tecnicosAgregar').empty();
                    $('#tecnicosAgregar').append(optionsAsString);
                    $('#tecnicosAgregar').prop('disabled', 'disabled');
                    $('#tecnicosAgregar').selectpicker('refresh');
                }

            },
        });
    });
    //OBTENER TECNICOS SEGUN SERVICEPROVIDER

    var ano = @System.Configuration.ConfigurationManager.AppSettings["ano"];
    var idReserva = parseInt(@ViewBag.IdReserva);
    var TipoReserva = "@ViewBag.TipoReserva";
    var Maquinaria = $(".Maquinaria").val();

    $("#AgregarResultadoDatos").click(function () {

        var checkedValue = $('.Inspeccion:checked').val();

        if (checkedValue != undefined) {
            $("#PresionAgregar").val("-1");
        }
        if($("#Scrubber").val() == "0"){
           var TieneScrubber = 0;
        }else{
            var TieneScrubber = 1;
        }
        if($("#KitCortina").val() == "0"){
            var TieneKit = 0;
        }else{
            var TieneKit = 1;
        }
        if ($("#contenedor").val() != "") {
            if ($(".cajacontenedor").val() != 0) {
                if ($("#anocontenedor").val() != "") {
                    if ($("#ServiceProviderAgregar").val() != 0) {
                        if ($("#tecnicosAgregar").val() != 0) {
                            if ($("#PresionAgregar").val() != 0) {
                                if ($("#FechaAgregar").val() != "") {
                                    if ($("#MaquinariaAgregar").val() != "0") {
                                        if ($("#Scrubber").val() != -1){
                                       // if ($("#anocontenedor").val() > ano ){
                                            if(TipoReserva == "TOPERFORM"){
                                                $.ajax({
                                                    type: "POST",
                                                    url: '@Url.Action("ValidarCantidadResultados", "Leaktest")',
                                                    data: { IdReserva : idReserva, Maquinaria : $("#MaquinariaAgregar").val() },
                                                    success: function (response) {
                                                        var json = JSON.parse(response);
                                                        if (json.validador == 1) {
                                                            swal({
                                                                title: '',
                                                                text: 'Por el tipo de reserva, no es posible agregar más resultados de leaktest.',
                                                                type: 'warning',
                                                                showCancelButton: false,
                                                                confirmButtonColor: '#3085d6',
                                                                cancelButtonColor: '#d33',
                                                                confirmButtonText: 'Aceptar'
                                                            }).then((result) => {

                                                            })
                                                        }else{
                                                            $.ajax({
                                                                type: "POST",
                                                                url: '@Url.Action("ValidarContenedor", "Controlador")',
                                                                data: { Contenedor:$("#contenedor option:selected").text()},
                                                                async: false,
                                                                success: function (response) {
                                                                    var json = JSON.parse(response);
                                                                    if (json.validador == 0 || json.validador==3 || json.validador==5 || json.validador==6) {
                                                                        $.ajax({
                                                                            type: "POST",
                                                                            url: '@Url.Action("InsertarResultadoLeaktest", "Leaktest")',
                                                                            data: { contenedor:$("#contenedor").val(), cajacontenedor:$(".cajacontenedor").val(), anocontenedor:$("#anocontenedor").val(),
                                                                                serviceprovider: $("#ServiceProviderAgregar").val(), tecnico: $("#tecnicosAgregar").val(), presion: $("#PresionAgregar").val(),
                                                                                fechaejecucion: $("#FechaAgregar").val(), controlador:$("#ControladorAgregar").val(), bateria:$(".Bateria").val(), maquinaria: $("#MaquinariaAgregar").val(),
                                                                                idRerserva : idReserva, CantidadScrubber: TieneScrubber, Selloperno1 : $("#Selloperno1").val(), Selloperno2 : $("#Selloperno2").val(), Sellotapa : $("#Sellotapa").val(),
                                                                                Comentario : $("#Comentario").val(), KitCortina: TieneKit, Modem: $("#ModemAgregar").val(), BateriaModem: $("#BateriaModemAgregar").val()},
                                                                            success: function (response) {
                                                                                var json = JSON.parse(response);
                                                                                if (json.validador == 0) {
                                                                                    swal({
                                                                                        title: '',
                                                                                        text: json.Mensaje,
                                                                                        type: 'success',
                                                                                        showCancelButton: false,
                                                                                        confirmButtonColor: '#3085d6',
                                                                                        cancelButtonColor: '#d33',
                                                                                        confirmButtonText: 'Aceptar'
                                                                                    }).then((result) => {
                                                                                        if (result == true) {
                                                                                            location.reload();
                                                                                        }
                                                                                    })
                                                                                } else {
                                                                                    swal({
                                                                                        title: '',
                                                                                        text: json.Mensaje,
                                                                                        type: 'warning',
                                                                                        showCancelButton: false,
                                                                                        confirmButtonColor: '#3085d6',
                                                                                        cancelButtonColor: '#d33',
                                                                                        confirmButtonText: 'Aceptar'
                                                                                    }).then((result) => {

                                                                                    })
                                                                                }
                                                                            },
                                                                        });
                                                                    }
                                                                },
                                                            });
                                                        }
                                                    },
                                                });
                                            }else if(TipoReserva == "TOBEAPPROVED"){
                                                $.ajax({
                                                    type: "POST",
                                                    url: '@Url.Action("InsertarResultadoLeaktest", "Leaktest")',
                                                    async: false,
                                                    data: { contenedor:$("#contenedor").val(), cajacontenedor:$(".cajacontenedor").val(), anocontenedor:$("#anocontenedor").val(),
                                                        serviceprovider: $("#ServiceProviderAgregar").val(), tecnico: $("#tecnicosAgregar").val(), presion: $("#PresionAgregar").val(),
                                                        fechaejecucion: $("#FechaAgregar").val(), controlador:$("#ControladorAgregar").val(), bateria:$(".Bateria").val(), maquinaria: $("#MaquinariaAgregar").val(),
                                                        idRerserva : idReserva, CantidadScrubber: TieneScrubber, Selloperno1 : $("#Selloperno1").val(), Selloperno2 : $("#Selloperno2").val(), Sellotapa : $("#Sellotapa").val(),
                                                        Comentario : $("#Comentario").val(), KitCortina: TieneKit, Modem: $("#ModemAgregar").val(), BateriaModem: $("#BateriaModemAgregar").val()/*, modem:$("#ModemAgregar").val()*/},
                                                    success: function (response) {
                                                        var json = JSON.parse(response);
                                                        if (json.validador == 0) {
                                                            swal({
                                                                title: '',
                                                                text: json.Mensaje,
                                                                type: 'success',
                                                                showCancelButton: false,
                                                                confirmButtonColor: '#3085d6',
                                                                cancelButtonColor: '#d33',
                                                                confirmButtonText: 'Aceptar'
                                                            }).then((result) => {
                                                                if (result == true) {
                                                                    location.reload();
                                                                }
                                                            })
                                                        } else {
                                                            swal({
                                                                title: '',
                                                                text: json.Mensaje,
                                                                type: 'warning',
                                                                showCancelButton: false,
                                                                confirmButtonColor: '#3085d6',
                                                                cancelButtonColor: '#d33',
                                                                confirmButtonText: 'Aceptar'
                                                            }).then((result) => {

                                                            })
                                                        }
                                                    },
                                                });
                                            }else if(TipoReserva == "BYCONTAINERNUMBER"){
                                                var presionLeakTest = $("#PresionAgregar").val();
                                                var divPresion = presionLeakTest.split(",");

                                                console.log('presion: ' + divPresion[0]);
                                                if (parseInt(divPresion[0]) < 3 && $(".Controlador").val() != "")
                                                {
                                                    swal('Ups!', '<span class="alerta">No se puede asociar Controlador si el Contenedor es rechazado</span>', 'warning');
                                                }
                                                else
                                                {
                                                    $.ajax({
                                                        type: "POST",
                                                        url: '@Url.Action("InsertarResultadoLeaktest", "Leaktest")',
                                                        async: false,
                                                        data: { contenedor:$("#contenedor").val(), cajacontenedor:$(".cajacontenedor").val(), anocontenedor:$("#anocontenedor").val(),
                                                            serviceprovider:$("#ServiceProviderAgregar").val(), tecnico:$("#tecnicosAgregar").val(), presion:$("#PresionAgregar").val(),
                                                            fechaejecucion: $("#FechaAgregar").val(), controlador:$("#ControladorAgregar").val(), bateria:$(".Bateria").val(), maquinaria: $("#MaquinariaAgregar").val(),
                                                            idRerserva : idReserva, TipoReserva : 3, CantidadScrubber: TieneScrubber, Selloperno1 : $("#Selloperno1").val(), Selloperno2 : $("#Selloperno2").val(),
                                                            Sellotapa : $("#Sellotapa").val(),Comentario : $("#Comentario").val(), KitCortina: TieneKit, Modem: $("#ModemAgregar").val(), BateriaModem: $("#BateriaModemAgregar").val()},
                                                        success: function (response) {
                                                            var json = JSON.parse(response);
                                                            if (json.validador == 0) {
                                                                swal({
                                                                    title: '',
                                                                    text: json.Mensaje,
                                                                    type: 'success',
                                                                    showCancelButton: false,
                                                                    confirmButtonColor: '#3085d6',
                                                                    cancelButtonColor: '#d33',
                                                                    confirmButtonText: 'Aceptar'
                                                                }).then((result) => {
                                                                    if (result == true) {
                                                                        location.reload();
                                                                    }
                                                                })
                                                            } else {
                                                                swal({
                                                                    title: '',
                                                                    text: json.Mensaje,
                                                                    type: 'warning',
                                                                    showCancelButton: false,
                                                                    confirmButtonColor: '#3085d6',
                                                                    cancelButtonColor: '#d33',
                                                                    confirmButtonText: 'Aceptar'
                                                                }).then((result) => {

                                                                })
                                                            }
                                                        },
                                                    });
                                                }
                                            }
                                        }else{
                                            swal('Ups!', '<span class="alerta" key="errorscrubber">Campo ¿Lleva Scrubber? Obligatorio</span>', 'error');
                                        }
                                        //}else{
                                        //    swal('Ups!', '<span class="alerta" key="erroranocontenedor">Campo Año contenedor no puede ser menor a 2014</span>', 'warning');
                                        //}
                                    } else {
                                        swal('Ups!', '<span class="alerta" key="errormaquinaria">Campo Maquinaria Obligatorio</span>', 'error');
                                    }
                                } else {
                                    swal('Ups!', '<span class="alerta" key="errorfechaejecución">Campo Fecha Ejecucion Obligatorio</span>', 'error');
                                }
                            } else {
                                swal('Ups!', '<span class="alerta" key="errorpresion">Campo Presión Obligatorio</span>', 'error');
                            }
                        } else {
                            swal('Ups!', '<span class="alerta" key="errortecnicos">Campo Tecnicos Obligatorio</span>', 'error');
                        }
                    } else {
                        swal('Ups!', '<span class="alerta" key="errorserviceprovider">Campo Service Provider Obligatorio</span>', 'error');
                    }
                } else {
                    swal('Ups!', '<span class="alerta" key="erroranovacio">Campo Año Contenedor Obligatorio</span>', 'error');
                }
            } else {
                swal('Ups!', '<span class="alerta" key="errorcajacontenedor">Campo Caja Contenedor Obligatorio</span>', 'error');
            }
        } else {
            swal('Ups!', '<span class="alerta" key="errorcontenedor">Campo Contenedor Obligatorio</span>', 'error');
        }
    });

    function formatDate(date) {
        var fecha = date.substring(0, 10);
        var ano = date.substring(0, 4);
        var mes = date.substring(5, 7);
        var dia = date.substring(8, 10);
        return dia +"/"+ mes +"/"+ ano;
    }

    $("#MaquinariaEditar").change(function () {
        $.ajax({
            type: "POST",
            url: '@Url.Action("ValidarMaquinaria", "Leaktest")',
            data: { IdReserva : idReserva, Maquinaria : $("#MaquinariaEditar").val() },
            success: function (response) {
                var json = JSON.parse(response);
                if (json.validador == 1) {
                    var aux = 'warning';
                    if(lenguaje == "es"){
                        swal({
                            title: '',
                            text: 'No puedes seleccionar la maquinaria, ya que no existe en el detalle de la reserva.',
                            type: aux,
                            showCancelButton: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {
                            $(".Maquinaria").val(0);
                        })
                    }else{
                        swal({
                            title: '',
                            text: 'You can not select the machinery, since it does not exist in the detail of the Request.',
                            type: aux,
                            showCancelButton: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Ok !'
                        }).then((result) => {
                            $(".Maquinaria").val(0);
                        })
                    }
                }
            },
        });
    });

    $("#MaquinariaAgregar").change(function () {
        $.ajax({
            type: "POST",
            url: '@Url.Action("ValidarMaquinaria", "Leaktest")',
            data: { IdReserva : idReserva, Maquinaria : $("#MaquinariaAgregar").val() },
            success: function (response) {
                var json = JSON.parse(response);
                if (json.validador == 1) {
                    var aux = 'warning';
                    if(lenguaje == "es"){
                        swal({
                            title: '',
                            text: 'No puedes seleccionar la maquinaria, ya que no existe en el detalle de la reserva.',
                            type: aux,
                            showCancelButton: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {
                            $("#MaquinariaAgregar").val(0);
                            $("#MaquinariaAgregar").selectpicker("refresh");
                        })
                    }else{
                        swal({
                            title: '',
                            text: 'You can not select the machinery, since it does not exist in the detail of the Request.',
                            type: aux,
                            showCancelButton: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Ok !'
                        }).then((result) => {
                            $("#MaquinariaAgregar").val(0);
                            $("#MaquinariaAgregar").selectpicker("refresh");
                        })
                    }
                }
            },
        });
    });

    $("#Editarresultadomodal").click(function () {

        var checkedValue = $('.InspeccionEditar:checked').val();

        if (checkedValue != undefined) {
            $("#Presion").val("-1");
        }

        if($("#ScrubberEditar").val() == "0"){
            var TieneScrubber = 0;
        }else{
            var TieneScrubber = 1;
        }

        if($("#KitCortinaEditar").val() == "0"){
            var TieneKit = 0;
        }else{
            var TieneKit = 1;
        }

        console.log('paso1');

        if ($("#contenedoreditar").val() != "") {
            if ($("#cajacontenedoreditar").val() != 0) {
                if ($("#anocontenedoreditar").val() != "") {
                    if ($("#ServiceProvider").val() != 0) {
                        if ($("#Tecnicos").val() != 0) {
                            if ($("#Presion").val() != 0) {
                                if ($("#FechaEjecucion").val() != "") {
                                    if ($("#MaquinariaEditar").val() != "0") {
                                        if ($("#ScrubberEditar").val() != -1){

                                        //if ($("#anocontenedoreditar").val() > ano ){
                                            if(TipoReserva == "TOPERFORM"){
                                                TipoReserva = 1;
                                                $.ajax({
                                                    type: "POST",
                                                    url: '@Url.Action("EditarResultadoLeaktest", "Leaktest")',
                                                    data: { contenedor:$("#contenedoreditar").val(), cajacontenedor:$("#cajacontenedoreditar").val(), anocontenedor:$("#anocontenedoreditar").val(),
                                                        serviceprovider:$("#ServiceProvider").val(), tecnico:$("#Tecnicos").val(), presion:$("#Presion").val(),
                                                        fechaejecucion: $("#FechaEjecucion").val(), controlador:$("#Controladoreditar").val(), bateria:$("#Bateriaeditar").val(), maquinaria: $("#MaquinariaEditar").val(),
                                                        idRerserva : idReserva, IdResultado: $("#IdResultado").val(), TipoReserva: TipoReserva, CantidadScrubber : TieneScrubber, Selloperno1 : $("#Selloperno1Editar").val(), Selloperno2 : $("#Selloperno2Editar").val(), Sellotapa : $("#SellotapaEditar").val(),
                                                        Comentario : $("#ComentarioEditar").val(), KitCortina: TieneKit, Modem: $("#ModemEditar").val(), BateriaModem: $("#BateriaModemEditar").val() },
                                                    success: function (response) {
                                                        var json = JSON.parse(response);
                                                        if (json.validador == 0) {
                                                            swal({
                                                                title: '',
                                                                text: json.Mensaje,
                                                                type: 'success',
                                                                showCancelButton: false,
                                                                confirmButtonColor: '#3085d6',
                                                                cancelButtonColor: '#d33',
                                                                confirmButtonText: 'Aceptar'
                                                            }).then((result) => {
                                                                if (result == true) {
                                                                    location.reload();
                                                                }
                                                            })
                                                        } else {
                                                            swal({
                                                                title: '',
                                                                text: json.Mensaje,
                                                                type: 'warning',
                                                                showCancelButton: false,
                                                                confirmButtonColor: '#3085d6',
                                                                cancelButtonColor: '#d33',
                                                                confirmButtonText: 'Aceptar'
                                                            }).then((result) => {

                                                            })
                                                        }
                                                    },
                                                });
                                            }else if(TipoReserva == "TOBEAPPROVED"){
                                                TipoReserva = 2;
                                                $.ajax({
                                                    type: "POST",
                                                    url: '@Url.Action("EditarResultadoLeaktest", "Leaktest")',
                                                    data: { contenedor:$("#contenedoreditar").val(), cajacontenedor:$("#cajacontenedoreditar").val(), anocontenedor:$("#anocontenedoreditar").val(),
                                                        serviceprovider:$("#ServiceProvider").val(), tecnico:$("#Tecnicos").val(), presion:$("#Presion").val(),
                                                        fechaejecucion: $("#FechaEjecucion").val(), controlador:$("#Controladoreditar").val(), bateria:$("#Bateriaeditar").val(), maquinaria: $("#MaquinariaEditar").val(),
                                                        idRerserva : idReserva, IdResultado: $("#IdResultado").val(), TipoReserva: TipoReserva , CantidadScrubber : TieneScrubber, Selloperno1 : $("#Selloperno1Editar").val(), Selloperno2 : $("#Selloperno2Editar").val(), Sellotapa : $("#SellotapaEditar").val(),
                                                        Comentario : $("#ComentarioEditar").val(),  Modem: $("#ModemEditar").val(), BateriaModem: $("#BateriaModemEditar").val()},
                                                    success: function (response) {
                                                        var json = JSON.parse(response);
                                                        if (json.validador == 0) {
                                                            swal({
                                                                title: '',
                                                                text: json.Mensaje,
                                                                type: 'success',
                                                                showCancelButton: false,
                                                                confirmButtonColor: '#3085d6',
                                                                cancelButtonColor: '#d33',
                                                                confirmButtonText: 'Aceptar'
                                                            }).then((result) => {
                                                                if (result == true) {
                                                                    location.reload();
                                                                }
                                                            })
                                                        } else {
                                                            swal({
                                                                title: '',
                                                                text: json.Mensaje,
                                                                type: 'warning',
                                                                showCancelButton: false,
                                                                confirmButtonColor: '#3085d6',
                                                                cancelButtonColor: '#d33',
                                                                confirmButtonText: 'Aceptar'
                                                            }).then((result) => {

                                                            })
                                                        }
                                                    },
                                                });
                                            }else if(TipoReserva == "BYCONTAINERNUMBER"){
                                                TipoReserva = 3;
                                                $.ajax({
                                                    type: "POST",
                                                    url: '@Url.Action("EditarResultadoLeaktest", "Leaktest")',
                                                    data: { contenedor:$("#contenedoreditar").val(), cajacontenedor:$("#cajacontenedoreditar").val(), anocontenedor:$("#anocontenedoreditar").val(),
                                                        serviceprovider:$("#ServiceProvider").val(), tecnico:$("#Tecnicos").val(), presion:$("#Presion").val(),
                                                        fechaejecucion: $("#FechaEjecucion").val(), controlador:$("#Controladoreditar").val(), bateria:$("#Bateriaeditar").val(), maquinaria: $("#MaquinariaEditar").val(),
                                                        idRerserva : idReserva, IdResultado: $("#IdResultado").val(), TipoReserva: TipoReserva, CantidadScrubber : TieneScrubber , Selloperno1 : $("#Selloperno1Editar").val(), Selloperno2 : $("#Selloperno2Editar").val(), Sellotapa : $("#SellotapaEditar").val(),
                                                        Comentario : $("#ComentarioEditar").val(),  Modem: $("#ModemEditar").val(), BateriaModem: $("#BateriaModemEditar").val()},
                                                    success: function (response) {
                                                        var json = JSON.parse(response);
                                                        if (json.validador == 0) {
                                                            swal({
                                                                title: '',
                                                                text: json.Mensaje,
                                                                type: 'success',
                                                                showCancelButton: false,
                                                                confirmButtonColor: '#3085d6',
                                                                cancelButtonColor: '#d33',
                                                                confirmButtonText: 'Aceptar'
                                                            }).then((result) => {
                                                                if (result == true) {
                                                                    location.reload();
                                                                }
                                                            })
                                                        } else {
                                                            swal({
                                                                title: '',
                                                                text: json.Mensaje,
                                                                type: 'warning',
                                                                showCancelButton: false,
                                                                confirmButtonColor: '#3085d6',
                                                                cancelButtonColor: '#d33',
                                                                confirmButtonText: 'Aceptar'
                                                            }).then((result) => {

                                                            })
                                                        }
                                                    },
                                                });
                                            }
                                        }else{
                                            swal('Ups!', '<span class="alerta" key="errorscrubber">Campo ¿Lleva Scrubber? Obligatorio</span>', 'error');
                                        }
                                        //}else{
                                        //    swal('Ups!', '<span class="alerta" key="erroranocontenedor">Campo Año contenedor no puede ser menor a 2014</span>', 'warning');
                                        //}
                                    } else {
                                        swal('Ups!', '<span class="alerta" key="errormaquinaria">Campo Maquinaria Obligatorio</span>', 'error');
                                    }
                                } else {
                                    swal('Ups!', '<span class="alerta" key="errorfechaejecución">Campo Fecha Ejecucion Obligatorio</span>', 'error');
                                }
                            } else {
                                swal('Ups!', '<span class="alerta" key="errorpresion">Campo Presión Obligatorio</span>', 'error');
                            }
                        } else {
                            swal('Ups!', '<span class="alerta" key="errortecnicos">Campo Tecnicos Obligatorio</span>', 'error');
                        }
                    } else {
                        swal('Ups!', '<span class="alerta" key="errorserviceprovider">Campo Service Provider Obligatorio</span>', 'error');
                    }
                } else {
                    swal('Ups!', '<span class="alerta" key="erroranovacio">Campo Año Contenedor Obligatorio</span>', 'error');
                }
            } else {
                swal('Ups!', '<span class="alerta" key="errorcajacontenedor">Campo Caja Contenedor Obligatorio</span>', 'error');
            }
        } else {
            swal('Ups!', '<span class="alerta" key="errorcontenedor">Campo Contenedor Obligatorio</span>', 'error');
        }
    });

    $(".eliminar").click(function () {
        if ($("#IdResultado").val() != "") {
            if(TipoReserva == "TOPERFORM"){
                TipoReserva = 1;
            }else if(TipoReserva == "TOBEAPPROVED"){
                TipoReserva = 2;
            }else{
                TipoReserva = 3;
            }
            swal({
                title: '<span class="alerta" key="tituloeliminar">Estás Seguro de Eliminar el Resultado Leaktest?</span>',
                type: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                cancelButtonText: '<span class="alerta" key="botoncancelaresultado">Cancelar</span>',
                confirmButtonText: '<span class="alerta" key="botoneliminarresultado">Si, Eliminar!</span>'
            }).then((result) => {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("EliminarResultado", "Leaktest")',
                    data: { IdResultado: $("#IdResultado").val(), TipoReserva : TipoReserva, IdReserva: idReserva},
                    success: function (response) {
                        var json = JSON.parse(response);
                        if (json.validador == 0) {
                            var aux = 'success';
                        } else {
                            var aux = 'warning';
                        }
                        swal({
                            title: '',
                            text: json.Mensaje,
                            type: aux,
                            showCancelButton: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {
                            location.reload();
                        })
                    }
                });
            });
        }else{
            swal('Ups!', '<span class="alerta" key="erroreliminarresultado">Debe seleccionar un resultado para eliminar su información.</span>', 'error');
        }
    });

    $("#FiltroFechas").click(function () {
        var IdReserva = parseInt(@ViewBag.IdReserva);
        var table = $('#Tb_Resultado').DataTable();
        if ($("#FechaIni").val() != "" && $("#FechaFin").val() != "") {
            var fechainicio = new Date($('#FechaIni').val()).getTime();
            var fechatermino = new Date($('#FechaFin').val()).getTime();
            if (fechatermino < fechainicio) {
                if(lenguaje == "es"){
                    swal('Ups!', 'La fecha final no puede ser menor a la fecha inicial.', 'warning');
                    return false;
                }else{
                    swal('Ups!', 'The final date can not be less than the initial date.', 'warning');
                    return false;
                }

            }
            table.destroy();
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetResultadosByFecha", "Leaktest")',
                    data: { FechaInicial: $("#FechaIni").val(), FechaFin: $("#FechaFin").val(), IdReserva: IdReserva },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.Resultados.length;
                        for (var i = 0 ; i < cuenta ; i++) {
                            if (json.Resultados[i].Estado == 0) {
                                Estado = "APPROVED";
                            } else if (json.Resultados[i].Estado == 1) {
                                Estado = "REJECTED";
                            } else if (json.Resultados[i].Estado == 2) {
                                Estado = "TO PERFORM";
                            }else if(json.Resultados[i].Estado == 3){
                                Estado = "VISUALLY REJECTED";
                            }

                            if (json.Resultados[i].Scrubber == 0) {
                                var scrubber = 'SI';
                            } else {
                                var scrubber = 'NO';
                            }

                            if(json.Resultados[i].KitCortina==0)
                            {
                                var kit="SI";
                            }else
                            {
                                var kit="NO";
                            }
                            data.push(["", json.Resultados[i].IdReserva, json.Resultados[i].IdMaquinaria, json.Resultados[i].IdServiceProvider,
                                        json.Resultados[i].IdTecnico, json.Resultados[i].Presion, json.Resultados[i].Contenedor, json.Resultados[i].CajaContenedor,
                                        json.Resultados[i].AnoContenedor,json.Resultados[i].Controlador,json.Resultados[i].Bateria,json.Resultados[i].Modem, json.Resultados[i].BateriaModem,
                                        scrubber,json.Resultados[i].Selloperno1,json.Resultados[i].Selloperno2,json.Resultados[i].Sellotapa,
                                        formatDate(json.Resultados[i].FechaRealizacion),json.Resultados[i].Comentario, Estado, kit, json.Resultados[i].Id]);
                        }
                        if (lenguaje == "es") {
                            var table = $('#Tb_Resultado').DataTable({
                                data: data,
                                "language": {
                                    "lengthMenu": "Mostrar _MENU_ Resultados por pagina",
                                    "zeroRecords": "No hay Resultados para mostrar",
                                    "info": "Mostrando pagina _PAGE_ de _PAGES_ paginas",
                                    "infoEmpty": "No hay Resultados disponibles",
                                    "search": "Buscar: ",
                                    "paginate": {
                                        "first": "Primera",
                                        "last": "Última",
                                        "next": "Siguiente",
                                        "previous": "Anterior"
                                    }
                                },
                                dom: 'Bfrtip',
                                buttons: [
                                    'copy', 'csv', 'excel'
                                ],
                                scrollX: true,
                                'columnDefs': [
                                   {
                                       'targets': 0,
                                       'id' : "hola",
                                       'checkboxes': {
                                           'selectRow': true
                                       }
                                   }
                                ],
                                'select': {
                                    'style': 'multi'
                                },
                                scrollY:        "500px",
                                scrollX:        true,
                                scrollCollapse: true,
                                paging:         false,
                                fixedColumns:   true
                            });
                        } else {
                            var table = $('#Tb_Resultado').DataTable({
                                data: data,
                                "language": {
                                    "lengthMenu": "Mostrar _MENU_ Resultados por pagina",
                                    "zeroRecords": "No hay Resultados para mostrar",
                                    "info": "Mostrando pagina _PAGE_ de _PAGES_ paginas",
                                    "infoEmpty": "No hay Resultados disponibles",
                                    "search": "Buscar: ",
                                    "paginate": {
                                        "first": "Primera",
                                        "last": "Última",
                                        "next": "Siguiente",
                                        "previous": "Anterior"
                                    }
                                },
                                dom: 'Bfrtip',
                                buttons: [
                                    'copy', 'csv', 'excel'
                                ],
                                scrollX: true,
                                'columnDefs': [
                                   {
                                       'targets': 0,
                                       'id' : "hola",
                                       'checkboxes': {
                                           'selectRow': true
                                       }
                                   }
                                ],
                                'select': {
                                    'style': 'multi'
                                },
                                scrollY:        "500px",
                                scrollX:        true,
                                scrollCollapse: true,
                                paging:         false,
                                fixedColumns:   true
                            });
                        }

                        table.columns().every(function () {
                            var that = this;
                            $('input', this.footer()).on('keyup change', function () {
                                if (that.search() !== this.value) {
                                    that
                                        .search(this.value)
                                        .draw();
                                }
                            });
                        });

                        $('#example-select-all').on('click', function(){
                            // Get all rows with search applied
                            var rows = table.rows({ 'search': 'applied' }).nodes();
                            // Check/uncheck checkboxes for all rows in the table
                            $('input[type="checkbox"]', rows).prop('checked', this.checked);

                        });

                        $('#Tb_Resultado tbody').on('click', 'tr', function () {
                            if(cuenta != 0){
                                if ($(this).hasClass('selected')) {
                                    $("#IdResultado").val(this.children[21].innerText);
                                    $(this).removeClass('selected');
                                }
                                else {
                                    table.$('tr.selected').removeClass('selected');
                                    $("#IdResultado").val(this.children[21].innerText);
                                    $(this).addClass('selected');
                                }
                            }
                        });
                    }
                });
        } else {
            swal('Ups!', '<span class="alerta" key="errorfiltrarsolicitud">Debe completar el formulario para filtrar las solicitudes.</span>', 'warning');
        }
    });

    $("#Limpiar").click(function () {
        location.reload();
    });

    $("#LeaktestReport").click(function () {
        var IdReserva = parseInt(@ViewBag.IdReserva);
        if(IdReserva != ""){
            var url = '@Url.Action("GenerarLeaktestReport", "Leaktest")?Solicitud=' + IdReserva;
            window.location.href = url;
        }
    });

    $("#contenedor").blur(function() {
        if($("#contenedor").val() != ""){
            $.ajax({
                type: "POST",
                url: '@Url.Action("ValidarNumeroContenedor", "Contenedores")',
                data: { containerNumberToCheck: $("#contenedor").val() },
                success: function (response) {
                    if(response == "False"){
                        if(lenguaje == "es"){
                            swal('Ups!', '<span>Número contenedor inválido.</span>', 'warning');
                        }else{
                            swal('Ups!', '<span>Invalid container number.</span>', 'warning');
                        }
                        $("#contenedor").val("");
                        return false;
                    }else{
                        $.ajax({
                            type: "POST",
                            url: '@Url.Action("GetInfoContenedor", "Contenedores")',
                            data: { Contenedor: $("#contenedor").val() },
                            success: function (response1) {
                                var json = JSON.parse(response1);
                                $(".cajacontenedor").val(json.IdCaja);
                                $(".cajacontenedor").selectpicker("refresh");
                                $("#MaquinariaAgregar").val(json.IdMaquinaria);
                                $("#MaquinariaAgregar").selectpicker("refresh");
                                $("#anocontenedor").val(json.AnoContenedor);
                                if(lenguaje == "es"){
                                    swal('Ok!', '<span>Número contenedor valido.</span>', 'success');
                                }else{
                                    swal('Ok!', '<span>Invalid container number.</span>', 'success');
                                }
                            }
                        });
                    }
                }
            });
        }
    });

    $("#anocontenedor").blur(function() {
        if($("#anocontenedor").val() != "" && $("#anocontenedor").val() < 2010){
            if(lenguaje == "es"){
                swal('Ups!', '<span>El año del contenedor es inferior a 2010</span>', 'warning');
            }else{
                swal('Ups!', '<span>Container year is less than 2010</span>', 'warning');
            }
        }
    });

    $("#anocontenedoreditar").blur(function() {
        if($("#anocontenedor").val() != "" && $("#anocontenedor").val() < 2010){
            if(lenguaje == "es"){
                swal('Ups!', '<span>El año del contenedor es inferior a 2010</span>', 'warning');
            }else{
                swal('Ups!', '<span>Container year is less than 2010</span>', 'warning');
            }
        }
    });

    $("#ControladorAgregar").blur(function() {
        if($("#ControladorAgregar").val() != ""){
            $.ajax({
                type: "POST",
                url: '@Url.Action("ValidarControlador", "Controlador")',
                data: { Controlador: $("#ControladorAgregar").val() },
                success: function (response) {
                    if(response == 0){
                        if(lenguaje == "es"){
                            swal('Ups!', '<span>Controlador no existe en los registros</span>', 'warning');
                        }else{
                            swal('Ups!', '<span>Controller does not exist in the registers</span>', 'warning');
                        }
                        $("#ControladorAgregar").val("");
                        return false;
                    }else if(response == 2){
                        swal('Ups!', '<span>Controlador se encuentra asociado a otro servicio</span>', 'warning');
                        $("#ControladorAgregar").val("");
                    }
                    else if(response == 5){
                        swal('Ups!', '<span>Controlador se encuentra asociado a otro leak test</span>', 'warning');
                        $("#ControladorAgregar").val("");
                    }else{
                        if(lenguaje == "es"){
                            $.ajax({
                                type: "POST",
                                url: '@Url.Action("GetBateriaByControlador", "Bateria")',
                                data: {
                                    Controlador: $('#ControladorAgregar').val()
                                },
                                success: function (response) {
                                    if(response!=null && response!="")
                                    {
                                        if($('#BateriaAgregar').val()=="")
                                        {
                                            $('#BateriaAgregar').val(response);
                                            document.getElementById("BateriaAgregar").disabled = true;
                                        }
                                    }

                                }
                            });

                            swal('Ok!', '<span>Número controlador válido.</span>', 'success');
                        }else{
                            $.ajax({
                                type: "POST",
                                url: '@Url.Action("GetBateriaByControlador", "Bateria")',
                                data: {
                                    Controlador: $('#ControladorAgregar').val()
                                },
                                success: function (response) {
                                    if(response!=null && response!="")
                                    {
                                        if($('#BateriaAgregar').val()=="")
                                        {
                                            $('#BateriaAgregar').val(response);
                                            document.getElementById("BateriaAgregar").disabled = true;
                                        }
                                    }
                                }
                            });

                            swal('Ok!', '<span>Valid Controller.</span>', 'success');
                        }

                    }
                }
            });
        }
    });

    $("#Controladoreditar").blur(function() {
        if($("#Controladoreditar").val() != ""){
            $.ajax({
                type: "POST",
                url: '@Url.Action("ValidarControlador", "Controlador")',
                data: { Controlador: $("#Controladoreditar").val() },
                success: function (response) {
                    if(response == 0){
                        if(lenguaje == "es"){
                            swal('Ups!', '<span>Controlador no existe en los registros</span>', 'warning');
                        }else{
                            swal('Ups!', '<span>Controller does not exist in the registers</span>', 'warning');
                        }
                        $("#Controladoreditar").val("");
                        return false;
                    }else if(response == 2){
                        swal('Ups!', '<span>Controlador se encuentra asociado a otro servicio</span>', 'warning');
                        $("#Controladoreditar").val("");
                    }
                    else if(response == 5){
                        swal('Ups!', '<span>Controlador se encuentra asociado a otro leak test</span>', 'warning');
                        $("#Controladoreditar").val("");
                    }else{
                        if(lenguaje == "es"){
                            $.ajax({
                                type: "POST",
                                url: '@Url.Action("GetBateriaByControlador", "Bateria")',
                                data: {
                                    Controlador: $('#Controladoreditar').val()
                                },
                                success: function (response) {
                                    if(response!=null && response!="")
                                    {
                                        if($('#Bateriaeditar').val()=="")
                                        {
                                            $('#Bateriaeditar').val(response);
                                            document.getElementById("Bateriaeditar").disabled = true;
                                        }
                                    }
                                }
                            });

                            swal('Ok!', '<span>Número controlador válido.</span>', 'success');
                        }else{
                            $.ajax({
                                type: "POST",
                                url: '@Url.Action("GetBateriaByControlador", "Bateria")',
                                data: {
                                    Controlador: $('#Controladoreditar').val()
                                },
                                success: function (response) {
                                    if(response!=null && response!="")
                                    {
                                        if($('#Bateriaeditar').val()=="")
                                        {
                                            $('#Bateriaeditar').val(response);
                                            document.getElementById("Bateriaeditar").disabled = true;
                                        }
                                    }
                                }
                            });

                            swal('Ok!', '<span>Valid Controller.</span>', 'success');
                        }

                    }
                }
            });
        }
    });

    $("#ModemEditar").blur(function() {
        if($("#ModemEditar").val() != ""){
            $.ajax({
                type: "POST",
                url: '@Url.Action("ValidarModem", "Controlador")',
                data: { Modem: $("#ModemEditar").val() },
                success: function (response) {
                    if(response == 0){
                        if(lenguaje == "es"){
                            swal('Ups!', '<span>Módem no existe en los registros</span>', 'warning');
                        }else{
                            swal('Ups!', '<span>Modem does not exist in the registers</span>', 'warning');
                        }
                        $("#ModemEditar").val("");
                        return false;
                    }else if(response==2) {
                        swal('Ups!', '<span>Modem se encuentra asociado a otro servicio</span>', 'warning');
                        $("#ModemEditar").val("");
                    }else if(response==5) {
                        swal('Ups!', '<span>Modem se encuentra asociado a otro leaktest</span>', 'warning');
                        $("#ModemEditar").val("");
                    }else{
                        if(lenguaje == "es"){
                            $.ajax({
                                type: "POST",
                                url: '@Url.Action("GetBateriaByModem", "Bateria")',
                                data: {
                                    Modem: $('#ModemEditar').val()
                                },
                                success: function (response) {
                                    if(response!=null && response!="")
                                    {
                                        if($('#BateriaModemEditar').val()=="")
                                        {
                                            $('#BateriaModemEditar').val(response);
                                            document.getElementById("BateriaModemEditar").disabled = true;
                                        }
                                    }
                                }
                            });

                            swal('Ok!', '<span>Número módem válido.</span>', 'success');
                        }else{
                            $.ajax({
                                type: "POST",
                                url: '@Url.Action("GetBateriaByModem", "Bateria")',
                                data: {
                                    Modem: $('#ModemEditar').val()
                                },
                                success: function (response) {
                                    if(response!=null && response!="")
                                    {
                                        if($('#BateriaModemEditar').val()=="")
                                        {
                                            $('#BateriaModemEditar').val(response);
                                            document.getElementById("BateriaModemEditar").disabled = true;
                                        }
                                    }
                                }
                            });

                            swal('Ok!', '<span>Valid Modem.</span>', 'success');
                        }

                    }
                }
            });
        }
    });

    $("#ModemAgregar").blur(function() {
        if($("#ModemAgregar").val() != ""){
            $.ajax({
                type: "POST",
                url: '@Url.Action("ValidarModem", "Controlador")',
                data: { Modem: $("#ModemAgregar").val() },
                success: function (response) {
                    if(response == 0){
                        if(lenguaje == "es"){
                            swal('Ups!', '<span>Módem no existe en los registros</span>', 'warning');
                        }else{
                            swal('Ups!', '<span>Modem does not exist in the registers</span>', 'warning');
                        }
                        $("#ModemAgregar").val("");
                        return false;
                    }else if(response==2) {
                        swal('Ups!', '<span>Modem se encuentra asociado a otro servicio</span>', 'warning');
                        $("#ModemAgregar").val("");
                    }else if(response==5) {
                        swal('Ups!', '<span>Modem se encuentra asociado a otro leaktest</span>', 'warning');
                        $("#ModemAgregar").val("");
                    }else{
                        if(lenguaje == "es"){
                            $.ajax({
                                type: "POST",
                                url: '@Url.Action("GetBateriaByModem", "Bateria")',
                                data: {
                                    Modem: $('#ModemAgregar').val()
                                },
                                success: function (response) {
                                    if(response!=null && response!="")
                                    {
                                        if($('#BateriaModemAgregar').val()=="")
                                        {
                                            $('#BateriaModemAgregar').val(response);
                                            document.getElementById("BateriaModemAgregar").disabled = true;
                                        }
                                    }
                                }
                            });

                            swal('Ok!', '<span>Número módem válido.</span>', 'success');
                        }else{
                            $.ajax({
                                type: "POST",
                                url: '@Url.Action("GetBateriaByModem", "Bateria")',
                                data: {
                                    Modem: $('#ModemAgregar').val()
                                },
                                success: function (response) {
                                    if(response!=null && response!="")
                                    {
                                        if($('#BateriaModemAgregar').val()=="")
                                        {
                                            $('#BateriaModemAgregar').val(response);
                                            document.getElementById("BateriaModemAgregar").disabled = true;
                                        }
                                    }
                                }
                            });

                            swal('Ok!', '<span>Valid Modem.</span>', 'success');
                        }

                    }
                }
            });
        }
    });

    $("#BateriaAgregar").blur(function() {
        if($("#BateriaAgregar").val() != ""){
            $.ajax({
                type: "POST",
                url: '@Url.Action("ValidarBateria", "Bateria")',
                data: { NumBateria: $("#BateriaAgregar").val() },
                success: function (response) {
                    var json = JSON.parse(response);
                    if (json.validador == 1) {
                        var aux = 'success';
                        swal({
                            title: '',
                            text: json.Mensaje,
                            type: aux,
                            showCancelButton: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {
                        })
                    } else if (json.validador == 2)
                    {
                        var aux = 'warning';

                        swal({
                            title: '',
                            text: json.Mensaje,
                            type: aux,
                            showCancelButton: true,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {

                        })
                    }else
                    {
                        var aux = 'warning';

                        swal({
                            title: '',
                            text: json.Mensaje,
                            type: aux,
                            showCancelButton: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {
                            $("#BateriaAgregar").val("");
                        })
                    }
                }
            });
        }
    });

    $("#Bateriaeditar").blur(function() {
        if($("#Bateriaeditar").val() != ""){
            $.ajax({
                type: "POST",
                url: '@Url.Action("ValidarBateria", "Bateria")',
                data: { NumBateria: $("#Bateriaeditar").val() },
                success: function (response) {
                    var json = JSON.parse(response);
                    if (json.validador == 1) {
                        var aux = 'success';
                        swal({
                            title: '',
                            text: json.Mensaje,
                            type: aux,
                            showCancelButton: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {
                        })
                    } else if (json.validador == 2)
                    {
                        var aux = 'warning';

                        swal({
                            title: '',
                            text: json.Mensaje,
                            type: aux,
                            showCancelButton: true,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {

                        })
                    }else
                    {
                        var aux = 'warning';

                        swal({
                            title: '',
                            text: json.Mensaje,
                            type: aux,
                            showCancelButton: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {
                            $("#Bateriaeditar").val("");
                        })
                    }
                }
            });
        }
    });

    $("#BateriaModemAgregar").blur(function() {
        if($("#BateriaModemAgregar").val() != ""){
            $.ajax({
                type: "POST",
                url: '@Url.Action("ValidarBateria", "Bateria")',
                data: { NumBateria: $("#BateriaModemAgregar").val() },
                success: function (response) {
                    var json = JSON.parse(response);
                    if (json.validador == 1) {
                        var aux = 'success';
                        swal({
                            title: '',
                            text: json.Mensaje,
                            type: aux,
                            showCancelButton: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {
                        })
                    } else if (json.validador == 2)
                    {
                        var aux = 'warning';

                        swal({
                            title: '',
                            text: json.Mensaje,
                            type: aux,
                            showCancelButton: true,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {

                        })
                    }else
                    {
                        var aux = 'warning';

                        swal({
                            title: '',
                            text: json.Mensaje,
                            type: aux,
                            showCancelButton: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {
                            $("#BateriaModemAgregar").val("");
                        })
                    }
                }
            });
        }
    });

    $("#BateriaModemEditar").blur(function() {
        if($("#BateriaModemEditar").val() != ""){
            $.ajax({
                type: "POST",
                url: '@Url.Action("ValidarBateria", "Bateria")',
                data: { NumBateria: $("#BateriaModemEditar").val() },
                success: function (response) {
                    var json = JSON.parse(response);
                    if (json.validador == 1) {
                        var aux = 'success';
                        swal({
                            title: '',
                            text: json.Mensaje,
                            type: aux,
                            showCancelButton: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {
                        })
                    } else if (json.validador == 2)
                    {
                        var aux = 'warning';

                        swal({
                            title: '',
                            text: json.Mensaje,
                            type: aux,
                            showCancelButton: true,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {

                        })
                    }else
                    {
                        var aux = 'warning';

                        swal({
                            title: '',
                            text: json.Mensaje,
                            type: aux,
                            showCancelButton: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Aceptar'
                        }).then((result) => {
                            $("#BateriaModemEditar").val("");
                        })
                    }
                }
            });
        }
    });

    $("#TraspasarResultados").click(function () {
        var Resultados = [];
        var Estados = [];
        var Maquinaria = [];
        var Contenedor = [];
        var count
        var cuenta = $("#Tb_Servicios tbody tr").length;

        $("#Tb_Resultado tbody tr").each(function () {
            if ($(this).find(".dt-checkboxes").is(":checked")) {
                Resultados.push($(this).find("td:eq(21)").html());
                Estados.push($(this).find("td:eq(19)").html())
                Maquinaria.push($(this).find("td:eq(2)").html());
                Contenedor.push($(this).find("td:eq(6)").html());
                localStorage.setItem("IdReservaAntiguo", $(this).find("td:eq(1)").html());
            }
        });

        if(Resultados.length == 0){
            Resultados = [];
            swal('Ups!', '<span class="alerta" key="RegistroResultadoLeaktest" >Debe seleccionar al menos un registro.</span>', 'error');
            return false;
        }else{
            localStorage.setItem("ListaResultados", JSON.stringify(Resultados));
            localStorage.setItem("ListaEstados", JSON.stringify(Estados));
            localStorage.setItem("ListaMaquinaria", JSON.stringify(Maquinaria));
            localStorage.setItem("ListaContenedor", JSON.stringify(Contenedor));
            //OBTENER SOLICITUDES
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetSolicitudes", "Leaktest")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    $('#Solicitudes').empty();
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].IdReserva + "'>" + json[i].IdReserva + "</option>";
                    }
                    $('#Solicitudes').append(optionsAsString);
                    $('#Solicitudes').selectpicker('refresh');
                },
            });
            //OBTENER SOLICITUDES
            $('#Traspaso').trigger('click');
        }
    });


    $("#BotonTraspasar").click(function () {
        $.ajax({
            type: "POST",
            url: '@Url.Action("TraspasarResultados", "Leaktest")',
            data:
            {
                Resultados : JSON.parse(localStorage.getItem("ListaResultados")),
                IdAntiguo : localStorage.getItem("IdReservaAntiguo"),
                IdNuevo : $("#Solicitudes").val(),
                Estado :  JSON.parse(localStorage.getItem("ListaEstados")),
                Maquinaria :  JSON.parse(localStorage.getItem("ListaMaquinaria")),
                Contenedor :  JSON.parse(localStorage.getItem("ListaContenedor")),
            },
            success: function (response) {
                var json = JSON.parse(response);
                var validados = "ID RESULTADOS : ";
                var novalidados = "ID RESULTADOS :";

                for(var i = 0; i < json.length; i++){
                    if(json[i].Validado == 0){
                        validados = validados + " " + json[i].IdServicio + " - ";
                    }else{
                        novalidados = novalidados  + " " + json[i].IdServicio + " - ";
                    }
                }
                swal({
                    title: 'INFO DE RESULTADOS ROLEADOS',
                    type: 'info',
                    html:
                        '<h4>Resultados Roleados</h4>' +
                        '<div>'+validados+'<div>'+
                        '<h4>Resultados No Roleados</h4>'+
                        '<div>'+novalidados+'<div>',
                    customClass: 'swal-wide',
                    confirmButtonText: 'Aceptar',
                }).then((result) => {
                    if (result == true) {
                        location.reload();
                    }
                })
            },
        });
    });

    $("#AsociarBateria").click(function () {

        @*$.ajax({
            type: "POST",
            url: '@Url.Action("GetBateriasCargadas", "Bateria")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                $('#BateriaAsociada').empty();
                var optionsAsString = "";
                var optionsAsString = "<option value='0'>Seleccione Bateria</option>";
                if (cuenta != 0) {
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].IdBateria + "'>" + json[i].NumBateria + "</option>";
                    }
                    $('#BateriaAsociada').append(optionsAsString);
                    $('#BateriaAsociada').selectpicker('refresh');
                }
            },
        });*@

        $('#tipo_esn').val("0");
        $("#tipo_esn").prop("disabled", true);
        $('#tipo_esn').selectpicker('refresh');
        $('#ESN').val("");
        $("#ESN").prop("disabled", true);
        $('#FechaAsociacion').val("");
        $("#FechaAsociacion").prop("disabled", true);
        $('#BateriaAsociada').val("");
        $("#BateriaAsociada").prop("disabled", false);
        $('#AsociarBateriaTrigger').trigger('click');

    });

    $("#Guardar_asociacion").click(function () {
        if ($("#ESN").val() == "") {
            $("#ESN").css("background-color", "rgba(255, 0, 0, 0.4)");
            $("button[data-id=tipo_esn]").css("background", "rgba(255, 0, 0, 0)");
            $("#FechaAsociacion").css("background-color", "rgba(255, 0, 0, 0)");
        } else if ($("#tipo_esn").val() == "0") {
            $("#ESN").css("background-color", "rgba(255, 0, 0, 0)");
            $("button[data-id=tipo_esn]").css("background", "rgba(255, 0, 0, 0.4)");
            $("#FechaAsociacion").css("background-color", "rgba(255, 0, 0, 0)");
        } else if ($("#FechaAsociacion").val() == "" ) {
            $("#ESN").css("background-color", "rgba(255, 0, 0, 0)");
            $("button[data-id=tipo_esn]").css("background", "rgba(255, 0, 0, 0)");
            $("#FechaAsociacion").css("background-color", "rgba(255, 0, 0, 0.4)");
        } else
        {
            var tipoESN="";
            if ($('#tipo_esn').val()=="1")
            {
                tipoESN = "CONTROLADOR";
            } else
            {
                tipoESN = "MODEM";
            }
            $.ajax({
                type: "POST",
                url: '@Url.Action("AsociarBateria", "Bateria")',
                data: {
                    NumBateria: $('#BateriaAsociada').val(),
                    ESN: $('#ESN').val(),
                    TipoESN: tipoESN,
                    FechaAsociacion: $("#FechaAsociacion").val()
                },
                success: function (response) {

                    var json = JSON.parse(response);
                    if (json.validador == 0) {
                        var aux = 'success';
                    } else {
                        var aux = 'warning';
                    }
                    swal({
                        title: '',
                        text: json.Mensaje,
                        type: aux,
                        showCancelButton: false,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Aceptar'
                    }).then((result) => {
                        location.reload();
                    })
                }
            });
        }
    });

    $("#ESN").blur(function () {
        $.ajax({
            type: "POST",
            url: '@Url.Action("ValidarTipoESN", "Controlador")',
            data: {
                ESN: $('#ESN').val()
            },
            success: function (response) {
                if(response=="CONTROLADOR")
                {
                    $('#tipo_esn').val("1");
                    $('#tipo_esn').selectpicker('refresh');
                    $("#tipo_esn").prop("disabled", true);
                }else if (response=="MODEM")
                {
                    $('#tipo_esn').val("2");
                    $('#tipo_esn').selectpicker('refresh');
                    $("#tipo_esn").prop("disabled", true);
                }else
                {
                    $('#tipo_esn').val("0");
                    $("#tipo_esn").prop("disabled", false);
                    $('#tipo_esn').selectpicker('refresh');
                    $('#ESN').val("");
                    swal('Ups!', 'No existe registro de controlador o modem con el número de ESN ingresado.', 'error');
                    return false;
                }

            }
        });
    });

    $("#ValidarBateria").click(function () {
        $.ajax({
            type: "POST",
            url: '@Url.Action("ValidarBateria", "Bateria")',
            data: {
                NumBateria: $('#BateriaAsociada').val()
            },
            success: function (response) {
                var json = JSON.parse(response);
                if (json.validador == 1) {
                    var aux = 'success';
                    swal({
                        title: '',
                        text: json.Mensaje,
                        type: aux,
                        showCancelButton: false,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Aceptar'
                    }).then((result) => {
                        $("#BateriaAsociada").prop("disabled", true);
                        $("#ESN").prop("disabled", false);
                        $("#tipo_esn").prop("disabled", false);
                        $('#FechaAsociacion').prop("disabled", false);
                        $.ajax({
                            type: "POST",
                            url: '@Url.Action("GetEquipoAsociadoByNumBateria", "Bateria")',
                            data: {
                                NumBateria: $('#BateriaAsociada').val()
                            },
                            success: function (response) {
                                var data = [];
                                var json = JSON.parse(response);
                                var cuenta = json.length;
                                if (cuenta != 0) {
                                    if (json.TipoESN == "CONTROLADOR")
                                    {
                                        $('#tipo_esn').val("1");
                                        $("#tipo_esn").prop("disabled", false);
                                        $('#tipo_esn').selectpicker('refresh');

                                    } else if (json.TipoESN == "CONTROLADOR")
                                    {
                                        $('#tipo_esn').val("2");
                                        $("#tipo_esn").prop("disabled", false);
                                        $('#tipo_esn').selectpicker('refresh');
                                    }else
                                    {
                                        $('#tipo_esn').val("0");
                                        $("#tipo_esn").prop("disabled", false);
                                        $('#tipo_esn').selectpicker('refresh');
                                    }

                                    $('#ESN').val(json.ESN);
                                    if(json.FechaAsociacion!=null)
                                    {
                                        $('#FechaAsociacion').val(formatDate(json.FechaAsociacion));
                                    }else
                                    {
                                        $('#FechaAsociacion').val("");
                                    }

                                }
                            },
                        });
                    })
                } else if (json.validador == 2)
                {
                    var aux = 'warning';

                    swal({
                        title: '',
                        text: json.Mensaje,
                        type: aux,
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Aceptar'
                    }).then((result) => {
                        $("#BateriaAsociada").prop("disabled", true);
                        $("#ESN").prop("disabled", false);
                        $("#tipo_esn").prop("disabled", false);
                        $('#FechaAsociacion').prop("disabled", false);
                    })
                }else
                {
                    var aux = 'warning';

                    swal({
                        title: '',
                        text: json.Mensaje,
                        type: aux,
                        showCancelButton: false,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Aceptar'
                    }).then((result) => {
                        $("#BateriaAsociada").val("");
                    })
                }
            }
        });
    });
</script>