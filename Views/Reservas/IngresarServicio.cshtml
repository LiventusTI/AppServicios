
@{
    ViewBag.Title = "IngresarServicio";
    Layout = "~/Views/MasterPage.cshtml";
}

<h2>Ingresar Servicio AC</h2>

<div class="row">
    <div class="col-md-12 col-sm-12 col-xs-12">
        <div class="x_panel">
            <div class="x_title">
                <h3>Buscar Reserva asociada al Servicio AC <small></small></h3>
                <div class="clearfix"></div>
            </div>
            <div class="x_content">
                <br />
                <form id="FormControl" data-parsley-validate class="form-horizontal form-label-left">
                    @*<div class="form-group">
                <div class="col-md-6 col-sm-6 col-xs-12">
                    <label class="control-label col-md-3 col-sm-3 col-xs-6">
                        Booking
                    </label>
                    <div class="col-md-6 col-sm-6 col-xs-6">
                        <input type="text" id="booking" class="form-control col-md-7 col-xs-12">
                    </div>
                </div>
                <div class="col-md-6 col-sm-6 col-xs-12">
                    <label id="lb_naviera" class="control-label col-md3 col-sm-3 col-xs-6">
                        Naviera
                    </label>
                    <div class="col-md-6 col-sm-6 col-xs-6">
                        <select class="custom-select form-control col-md-7 col-xs-12">
                            <option selected>Seleccione una Naviera</option>
                            <option value="1">MOL</option>
                            <option value="2">MSC</option>
                            <option value="3">SEABOARD</option>
                            <option value="4">SEALAND</option>
                            <option value="5">SEATRADE</option>
                            <option value="6">CCNI</option>
                            <option value="7">CMA CGM</option>
                            <option value="8">COOL CARRIERS</option>
                            <option value="9">COSCO</option>
                            <option value="10">EVERGREEN</option>
                            <option value="11">GLOBAL REEFERS</option>
                            <option value="12">HAMBURG SUD</option>
                            <option value="13">HAPAG LLOYD</option>
                            <option value="14">K LINE</option>
                            <option value="15">MAERSK</option>
                        </select>
                    </div>
                    <i class="fa fa-plus" title="Agregar Naviera" id="AgregarNaviera"></i>
                </div>
            </div>
            <div class="form-group">
                <div class="col-md-6 col-sm-6 col-xs-12">
                    <label id="lb_viaje" class="control-label col-md-3 col-sm-3 col-xs-6">
                        Commodity
                    </label>
                    <div class="col-md-6 col-sm-6 col-xs-6">
                        <select class="custom-select form-control col-md-7 col-xs-12">
                            <option selected>Seleccione un Commodity</option>
                            <option value="1">AVOCADOS</option>
                            <option value="2">BLUEBERRY</option>
                            <option value="3">PEACH</option>
                            <option value="4">NECTARINE</option>
                            <option value="5">CHERRY</option>
                            <option value="6">PLUM</option>
                        </select>
                    </div>
                    <i class="fa fa-plus" title="Agregar Commodity" id="AgregarCommodity"></i>
                </div>
                <div class="col-md-6 col-sm-6 col-xs-12">
                    <label id="lb_exportador" class="control-label col-md-3 col-sm-3 col-xs-6">
                        Exportador
                    </label>
                    <div class="col-md-6 col-sm-6 col-xs-6">
                        <select class="custom-select form-control col-md-7 col-xs-12">
                            <option selected>Seleccione un Exportador</option>
                            <option value="1">EXPORTADORA PROPAL S.A.</option>
                            <option value="2">SOUTH PACIFIC LOGISTICS SAC</option>
                            <option value="3">COMERCIALIZADORA FRUFIVA</option>
                        </select>
                    </div>
                    <i class="fa fa-plus" title="Agregar Exportador" id="AgregarExportador"></i>
                </div>
            </div>
            <div class="form-group">
                <div class="col-md-6 col-sm-6 col-xs-12">
                    <label id="lb_viaje" class="control-label col-md-3 col-sm-3 col-xs-6">
                        Puerto Origen
                    </label>
                    <div class="col-md-6 col-sm-6 col-xs-6">
                        <select class="custom-select form-control col-md-7 col-xs-12">
                            <option selected>Seleccione un Puerto de Origen</option>
                            <option value="1">VALPARAISO</option>
                            <option value="2">MANZANILLO</option>
                            <option value="3">CALLAO</option>
                        </select>
                    </div>
                    <i class="fa fa-plus" title="Agregar Puerto Origen" id="AgregarPuertoOrigen"></i>
                </div>
                <div class="col-md-6 col-sm-6 col-xs-12">
                    <label id="lb_exportador" class="control-label col-md-3 col-sm-3 col-xs-6">
                        Puerto Destino
                    </label>
                    <div class="col-md-6 col-sm-6 col-xs-6">
                        <select class="custom-select form-control col-md-7 col-xs-12">
                            <option selected>Seleccione un Puerto de Destino</option>
                            <option value="1">LONDON</option>
                            <option value="2">ROTTERDAM</option>
                            <option value="3">HONG KONG</option>
                        </select>
                    </div>
                    <i class="fa fa-plus" title="Agregar Puerto Destino" id="AgregarPuertoDestino"></i>
                </div>
            </div>
            <div class="form-group">
                <div class="col-md-6 col-sm-6 col-xs-12">
                    <label id="lb_viaje" class="control-label col-md-3 col-sm-3 col-xs-6">
                        Fecha Inicio Busqueda
                    </label>
                    <div class="col-md-6 col-sm-6 col-xs-6">
                        <input type="text" id="fecha_inicio" class="form-control col-md-7 col-xs-12">
                    </div>
                </div>
                <div class="col-md-6 col-sm-6 col-xs-12">
                    <label id="lb_exportador" class="control-label col-md-3 col-sm-3 col-xs-6">
                        Fecha Fin Busqueda
                    </label>
                    <div class="col-md-6 col-sm-6 col-xs-6">
                        <input type="text" id="fecha_termino" class="form-control col-md-7 col-xs-12">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="col-md-2 col-sm-2 col-xs-2">
                    <label id="lb_eta" class="control-label col-md-6 col-sm-6 col-xs-6">
                        Buscar por ETA
                    </label>
                    <div class="col-md-2 col-sm-2 col-xs-2">
                        <input id="chk_eta" type="checkbox" value="" class="checkbox-inline">
                    </div>
                </div>
                <div class="col-md-2 col-sm-2 col-xs-2">
                    <label id="lb_etd" class="control-label col-md-6 col-sm-6 col-xs-6">
                        Buscar por ETD
                    </label>
                    <div class="col-md-2 col-sm-2 col-xs-2">
                        <input id="chk_etd" type="checkbox" value="" class="checkbox-inline">
                    </div>
                </div>
                <div class="col-md-3 col-sm-3 col-xs-4">
                    <label id="lb_etd" class="control-label col-md-6 col-sm-6 col-xs-6">
                        Buscar por Fecha Registro
                    </label>
                    <div class="col-md-2 col-sm-2 col-xs-2">
                        <input id="chk_registro" type="checkbox" value="" class="checkbox-inline">
                    </div>
                </div>
                <div class="col-md-2 col-sm-2 col-xs-2">
                    <label id="lb_etd" class="control-label col-md-6 col-sm-6 col-xs-6">
                        Buscar por Inicio Stacking
                    </label>
                    <div class="col-md-2 col-sm-2 col-xs-2">
                        <input id="chk_inicio_stacking" type="checkbox" value="" class="checkbox-inline">
                    </div>
                </div>
                <div class="col-md-2 col-sm-2 col-xs-2">
                    <label id="lb_etd" class="control-label col-md-6 col-sm-6 col-xs-6">
                        Buscar por Term. Stacking
                    </label>
                    <div class="col-md-2 col-sm-2 col-xs-2">
                        <input id="chk_termino_stacking" type="checkbox" value="" class="checkbox-inline">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="col-md-12 col-sm-12 col-xs-12" style="text-align:center">
                    <button type="button" class="btn btn-success" onclick="ValidarFormulario()">Buscar</button>
                </div>
            </div>*@
                    <br />
                    <div class="col-sm-12 col-md-12 col-lg-12">
                        <table id="Tb_Reserva" class="table table-striped table-bordered">
                            <thead>
                                <tr>
                                    <th style="display:none;">IdReserva</th>
                                    <th>Booking</th>
                                    <th>Naviera</th>
                                    <th>Nave</th>
                                    <th>Viaje</th>
                                    <th>Exportador</th>
                                    <th>Fecha Registro Reserva</th>
                                    <th>Inicio Stacking</th>
                                    <th>Termino Stacking</th>
                                    <th>ETD</th>
                                    <th>ETA</th>
                                    <th>Commodity</th>
                                    <th>Puerto Origen</th>
                                    <th>Puerto Destino</th>
                                    <th>Setpoint</th>
                                    <th>T°</th>
                                    <th>Cant. Servicios Reservados</th>
                                    <th>Cant. Servicios Prestados</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="display:none;">1</td>
                                    <td>070ISA0610891</td>
                                    <td>CMA CGM</td>
                                    <td>JPO LIBRA</td>
                                    <td>030AMN</td>
                                    <td>PRIAGRO</td>
                                    <td>28-09-2017</td>
                                    <td>28-09-2017</td>
                                    <td>27-09-2017</td>
                                    <td>29-09-2017</td>
                                    <td>02-10-2017</td>
                                    <td>AVOCADOS</td>
                                    <td>SAN ANTONIO</td>
                                    <td>PHILADELPHIA</td>
                                    <td>12% C02, 8% O2</td>
                                    <td>4.5</td>
                                    <td>4</td>
                                    <td>3</td>
                                </tr>
                                <tr>
                                    <td style="display:none;">2</td>
                                    <td>070ISA067894</td>
                                    <td>CMA CGM</td>
                                    <td>JPO LIBRA</td>
                                    <td>030AMN</td>
                                    <td>PRIAGRO</td>
                                    <td>28-09-2017</td>
                                    <td>28-09-2017</td>
                                    <td>27-09-2017</td>
                                    <td>29-09-2017</td>
                                    <td>02-10-2017</td>
                                    <td>AVOCADOS</td>
                                    <td>SAN ANTONIO</td>
                                    <td>PHILADELPHIA</td>
                                    <td>10% C02, 8% O2</td>
                                    <td>4.5</td>
                                    <td>4</td>
                                    <td>2</td>
                                </tr>
                                @*<tr>
                            <td>087LIM230642</td>
                            <td>MSC</td>
                            <td>MSC SOFIA CELESTE</td>
                            <td>NX716R</td>
                            <td>HASS PERU SA</td>
                            <td>28/03/2017</td>
                            <td>30/03/2017</td>
                            <td>26/04/2017</td>
                            <td>AVOCADOS</td>
                            <td>CALLAO</td>
                            <td>ROTTERDAM</td>
                            <td>12</td>
                            <td>8</td>
                            <td>6.5</td>
                            <td>5</td>
                            <td style="font-size:18px; text-align:center"><i class="fa fa-plus" title="Agregar" id="Agregar"></i></td>
                        </tr>
                        <tr>
                            <td>087LIM230816</td>
                            <td>MSC</td>
                            <td>MSC SOFIA CELESTE</td>
                            <td>NX716R</td>
                            <td>M & C FRUITS COMPANY S.A.C.</td>
                            <td>28/05/2017</td>
                            <td>29/09/2017</td>
                            <td>15/10/2017</td>
                            <td>AVOCADOS</td>
                            <td>CALLAO</td>
                            <td>HOUSTON</td>
                            <td>12</td>
                            <td>8</td>
                            <td>6</td>
                            <td>5</td>
                            <td style="font-size:18px; text-align:center"><i class="fa fa-plus" title="Agregar" id="Agregar"></i></td>
                        </tr>
                        <tr>
                            <td>070ISA0610891</td>
                            <td>CMA CGM</td>
                            <td>JPO LIBRA</td>
                            <td>030AMN</td>
                            <td>PRIAGRO</td>
                            <td>28/05/2017</td>
                            <td>29/09/2017</td>
                            <td>15/10/2017</td>
                            <td>AVOCADOS</td>
                            <td>SAN ANTONIO</td>
                            <td>PHILADELPHIA</td>
                            <td>12</td>
                            <td>8</td>
                            <td>4.5</td>
                            <td>5</td>
                            <td style="font-size:18px; text-align:center"><i class="fa fa-plus" title="Agregar" id="Agregar"></i></td>
                        </tr>
                        <tr>
                            <td>070ISA0610891</td>
                            <td>CMA CGM</td>
                            <td>JPO LIBRA</td>
                            <td>030AMN</td>
                            <td>PRIAGRO</td>
                            <td>28/05/2017</td>
                            <td>29/09/2017</td>
                            <td>15/10/2017</td>
                            <td>AVOCADOS</td>
                            <td>SAN ANTONIO</td>
                            <td>PHILADELPHIA</td>
                            <td>12</td>
                            <td>8</td>
                            <td>4.5</td>
                            <td>5</td>
                            <td style="font-size:18px; text-align:center"><i class="fa fa-plus" title="Agregar" id="Agregar"></i></td>
                        </tr>*@
                            </tbody>
                            <tfoot>
                                <tr>
                                    <th style="display:none;">IdReserva</th>
                                    <th>Booking</th>
                                    <th>Naviera</th>
                                    <th>Nave</th>
                                    <th>Viaje</th>
                                    <th>Exportador</th>
                                    <th>Fecha Registro Reserva</th>
                                    <th>Inicio Stacking</th>
                                    <th>Termino Stacking</th>
                                    <th>ETD</th>
                                    <th>ETA</th>
                                    <th>Commodity</th>
                                    <th>Puerto Origen</th>
                                    <th>Puerto Destino</th>
                                    <th>Setpoint</th>
                                    <th>T°</th>
                                    <th>Cant. Servicios Reservados</th>
                                    <th>Cant. Servicios Prestados</th>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                    <div class="col-lg-8 col-sm-12">
                        <input type="text" class="input form_control" id="IdReserva" disabled="disabled" placeholder="Id Reserva Servicio" style="text-align:center; text-align-last:center; display:none;" />
                        <input type="text" class="input form_control" id="Booking" disabled="disabled" placeholder="Booking" style="text-align:center; text-align-last:center;" />
                        <button type="button" class="btn btn-primary" id="Agregar">Agregar Servicio</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>

    $(document).ready(function () {
        $('#Tb_Reserva tfoot th').each(function () {
            var title = $(this).text();
            $(this).html('<input type="text" placeholder="Buscar" />');
        });

        var table = $('#Tb_Reserva').DataTable({

        });

        table.columns().every(function () {
            var that = this;

            $('input', this.footer()).on('keyup change', function () {
                if (that.search() !== this.value) {
                    that
                        .search(this.value)
                        .draw();
                }
            });
        });

        $('#Tb_Reserva tbody').on('click', 'tr', function () {
            if ($(this).hasClass('selected')) {
                $("#IdReserva").val(this.children[0].innerText);
                $("#Booking").val(this.children[1].innerText);
                $(this).removeClass('selected');
            }
            else {
                table.$('tr.selected').removeClass('selected');
                $("#IdReserva").val(this.children[0].innerText);
                $("#Booking").val(this.children[1].innerText);
                $(this).addClass('selected');
            }
        });


        @*$.ajax({
            type: "POST",
            url: '/Reservas/GetReservas/',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                $('#Tb_Reservas').show(500);
                for (var i = 0 ; i < cuenta ; i++) {
                    //if (json[i].Activo == 0) {
                    //    var estado = 'Activo';
                    //} else {
                    //    var estado = 'No Activo';
                    //}
                    data.push([json[i].Booking, json[i].IdNaviera, json[i].Nave, json[i].Viaje, json[i].IdExportador, json[i].FechaRegistro, json[i].FechaIniStacking, json[i].FechaFinStacking, json[i].Etd, json[i].Eta, json[i].IdCommodity, json[i].IdPuertoOrigen, json[i].IdPuertoDestino, json[i].IdSetpoint, json[i].Temperatura, json[i].CantServiciosReservados, json[i].CantServiciosPrestados]);
                }
                var table = $('#Tb_Reservas').DataTable({
                    data: data,
                    "language": {
                        "url": "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Spanish.json"
                    },
                    fixedColumns: true,
                    "columnDefs": [{
                        "targets": -1,
                        "data": null,
                        "defaultContent": "<i class='fa fa-plus fa-2x' title='Agregar Servicio'></i>"
                    }]

                });

                $('#Tb_Reservas tbody').on('click', 'i', function () {
                    var data = table.row($(this).parents('tr')).data();

                    var url = '@Url.Action("IngresarPrestacionServicio", "Reservas")?booking=' + data[0] + '&naviera=' + data[1] + '&nave=' + data[2] + '&viaje=' + data[3] + '&exportador=' + data[4] + '&fechaReserva=' + data[5] + '&iniciostacking=' + data[6] + '&terminostacking=' + data[7] + '&etd=' + data[8] + '&eta=' + data[9] + '&commodity=' + data[10] + '&porigen=' + data[11] + '&pdestino=' + data[12] + '&setpoint=' + data[13] + '&temperatura=' + data[14] + '&cantServicios=' + data[15] + '&serviciosPrestados=' + data[16];
                    window.location.href = url;*@
                    //swal({
                    //    showCancelButton: true,
                    //    cancelButtonText: "Cancelar",
                    //    title: 'Editar Reserva',
                    //    html:
                    //        '<div class="row">' +
                    //            '<div class="form-group col-lg-6"><label for="Continente">Continente</label><input type="text" class="form-control" id="Continente" placeholder="Escriba Continente"></div>' +
                    //            '<div class="form-group col-lg-6"><label for="Estado">Estado</label><select class="form-control" id="Estado"><option value="0">Activo</option><option value="1">Deshabilitado</option></select></div>' +
                    //        '</div>',
                    //    preConfirm: function () {
                    //        return new Promise(function (resolve) {
                    //            resolve([
                    //                //asignar valores a las variables
                    //            ])
                    //        })
                    //    },
                    //    onOpen: function () {
                    //        $('#Continente').focus();
                    //        $('#Continente').val(data[1]);
                    //    }
                    //}).then(function (result) {
                    //    //enviar datos para agregar Naviera
                    //    $.ajax({
                    //        type: "POST",
                    //        url: '/Paises/EditarContinente/',
                    //        data: { NombreContinente: $("#Continente").val(), Estado: $("#Estado").val(), IdContinente: data[0] },
                    //        success: function (response) {
                    //            var json = JSON.parse(response);
                    //            swal({
                    //                title: '',
                    //                text: json.Mensaje,
                    //                type: 'success',
                    //                showCancelButton: false,
                    //                confirmButtonColor: '#3085d6',
                    //                cancelButtonColor: '#d33',
                    //                confirmButtonText: 'Aceptar'
                    //            }).then((result) => {
                    //                location.reload();
                    //            })
                    //        }
                    //    });
                    //}).catch(swal.noop)
    //            });
    //        }
    //    });
    });

    //Botón Agregar Servicio//
    $("#Agregar").click(function () {
         var id = $("#IdReserva").val();

         var url = '@Url.Action("IngresarPrestacionServicio", "Reservas")?IdReserva=' + id;
        window.location.href = url;
    });
    //Botón Agregar Servicio//

    //function MostrarIngresoServicio()
    //{
    //    var Booking = $("#booking").val();
    //    var Viaje = $("#viaje").val();

    //    //if (Booking == "") {
    //    //    swal('Error...', 'Campo Booking Obligatorio', 'error')
    //    //} else if (Nave == "") {
    //    //    swal('Error...', 'Campo Viaje Obligatorio', 'error')
    //    //}

    //    document.getElementById("lb_contenedor").style.visibility = "visible";
    //    document.getElementById("contenedor").style.visibility = "visible";
    //    document.getElementById("lb_fecha_servicio").style.visibility = "visible";
    //    document.getElementById("fecha_servicio").style.visibility = "visible";
    //    document.getElementById("lb_hora_llegada").style.visibility = "visible";
    //    document.getElementById("hora_llegada").style.visibility = "visible";
    //}

    //function ValidarFormulario() {
    //    var Booking = $("#booking").val();
    //    var Contenedor = $("#contenedor").val();
    //    var Viaje = $("#viaje").val();
    //    var FechaServicio = $("#fecha_servicio").val();
    //    var HoraLlegada = $("#hora_llegada").val();

    //    if (Booking == "") {
    //        swal('Error...', 'Campo Booking Obligatorio', 'error')
    //    } else if (Contenedor == "") {
    //        swal('Error...', 'Campo Contenedor Obligatorio', 'error')
    //    } else if (Viaje == "") {
    //        swal('Error...', 'Campo Viaje Obligatorio', 'error')
    //    } else if (FechaServicio == "") {
    //        swal('Error...', 'Campo Fecha Servicio Obligatorio', 'error')
    //    } else if (HoraLlegada == "") {
    //        swal('Error...', 'Campo Hora Llegada Obligatorio', 'error')
    //    }

    //    $.ajax({
    //        type: "POST",
    //        url: "/Reservas/IngresarDatos",
    //        content: "application/json; charset=utf-8",
    //        dataType: "json",
    //        data: {
    //            Booking: Booking,
    //            Nave: Nave,
    //            Naviera: Naviera,
    //            Exportador: Exportador,
    //            Producto: Producto,
    //            Destino: Destino,
    //            Origen: Origen,
    //            Viaje: Viaje,
    //            FechaArribo: Eta,
    //            FechaSalida: Etd,
    //            CantidadCO: CantidadCo,
    //            CantidadO: CantiadO,
    //            Temperatura: Temperatura,
    //            Tamano: Tamano
    //        },
    //        success: function (d) {
    //            if (d.success == true)
    //                alert('Has introducido un nuevo coche!!');
    //            else { }
    //        },
    //        error: function (xhr, textStatus, errorThrown) {
    //            alert('Error!!');
    //        }
    //    });
    //}

    $(function () {
        $("#fecha_inicio").datepicker({
            dateFormat: "dd-mm-yy",
            firstDay: 1,
            dayNamesMin: ["Do", "Lu", "Ma", "Mi", "Ju", "Vi", "Sa"],
            dayNamesShort: ["Dom", "Lun", "Mar", "Mie", "Jue", "Vie", "Sab"],
            monthNames:
                ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio",
                "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
            monthNamesShort:
                ["Ene", "Feb", "Mar", "Abr", "May", "Jun",
                "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"]
        });

        $("#fecha_termino").datepicker({
            dateFormat: "dd-mm-yy",
            firstDay: 1,
            dayNamesMin: ["Do", "Lu", "Ma", "Mi", "Ju", "Vi", "Sa"],
            dayNamesShort: ["Dom", "Lun", "Mar", "Mie", "Jue", "Vie", "Sab"],
            monthNames:
                ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio",
                "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
            monthNamesShort:
                ["Ene", "Feb", "Mar", "Abr", "May", "Jun",
                "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"]
        });
    });
</script>