
@{
    ViewBag.Title = "GestionarDepositos2";
    Layout = "~/Views/MasterPage.cshtml";
    int PerfilInterior = Convert.ToInt32(Session["PerfilInterior"]);
    string Usuario = Session["User"].ToString().ToUpper();
}

<style>
    .swal-wide {
        width: 850px !important;
    }

    .cancelarservicio {
        width: 600px !important;
    }

    .btn-sm {
        width: 18%;
        table-layout: fixed;
        border-collapse: collapse;
    }
</style>

<div class="col-sm-12">
    <div class="x_panel">
        <div class="x_title">
            <div class="row">
                <div class="col-sm-7">
                    <h3 class="tr" key="gestionreservas">Gestión Depósitos</h3>
                </div>
            </div>
            <div class="clearfix"></div>
        </div>

        <div class="x_content">
            <div class="x_panel">
                <div class="col-sm-12 col-md-12 col-lg-12">
                    <div id="guardadocorrectamente" hidden="hidden"><p style="color:red">Guardado Correctamente</p></div>
                    <table id="Tb_Servicios" class="table table-striped table-bordered display nowrap">
                        <thead>
                            <tr>
                                <th class="tr" key="estadoservicio">RESERVA</th>
                                <th>N° CONTENEDOR</th>
                                <th class="tr" key="">COMMODITY</th>
                                <th class="tr" key="">TIPO ENTREGA</th>
                                <th>LLEVA SCRUBBER</th>
                                <th>N° ORDEN DE CARGA</th>
                                <th class="tr" key="">FECHA ASOC. CONTENEDOR</th>
                                <th class="tr" key="">DEPÓSITO INSTALÓ MODEM?</th>
                                <th>OBSERVACIONES</th>
                                <th>DEPOSITO ASOCIADO</th>
                                <th>MODEM</th>
                                <th>ID SERVICIO</th>
                            </tr>
                            <tr>
                                <th class="tr" key="estadoservicio">RESERVA</th>
                                <th>N° CONTENEDOR</th>
                                <th class="tr" key="">COMMODITY</th>
                                <th class="tr" key="">TIPO ENTREGA</th>
                                <th class="tr" key="">LLEVA SCRUBBER</th>
                                <th class="tr" key="">N° ORDEN DE CARGA</th>
                                <th class="tr" key="">FECHA ASOC. CONTENEDOR</th>
                                <th class="tr" key="">DEPÓSITO INSTALÓ MODEM?</th>
                                <th>OBSERVACIONES</th>
                                <th>DEPOSITO ASOCIADO</th>
                                <th>MODEM</th>
                                <th>ID SERVICIO</th>
                            </tr>
                        </thead>
                        <tfoot>
                            <tr>
                                <th class="tr" key="estadoservicio">1. RESERVA</th>
                                <th>2. N° CONTENEDOR</th>
                                <th class="tr" key="">3. COMMODITY</th>
                                <th class="tr" key="">4. TIPO ENTREGA</th>
                                <th class="tr" key="">5. LLEVA SCRUBBER</th>
                                <th class="tr" key="">6. N° ORDEN DE CARGA</th>
                                <th class="tr" key="">7. FECHA ASOC. CONTENEDOR</th>
                                <th class="tr" key="">8. DEPÓSITO INSTALÓ MODEM?</th>
                                <th>9. OBSERVACIONES</th>
                                <th>10. DEPOSITO ASOCIADO</th>
                                <th>11. MODEM</th>
                                <th>12. ID SERVICIO</th>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
            <div class="divider"></div>
            <div class="row" id="botonesacciones">
                <div class="col-lg-11 col-lg-offset-1">
                    @*<button type="button" class="btn btn-primary tr btn-sm" key="AgregarReserva" id="AgregarReserva">Agregar Reserva</button>*@
                    @*@<button class="btn btn-primary tr btn-success btn-sm" key="ValidarServicios" id="ValidarServicios">Validación Técnica</button>*@
                </div>
            </div>
        </div>
    </div>
</div>


<!--Modal Editar Celdas-->
<div class="modal fade" id="myModal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="margin-left:100px; margin-right:10px; width:85%">
    <div class="modal-dialog" role="document" style="width:100%">
        <div class="modal-content">
            <div class="modal-header titulo">
                <button type="button" class="close closeCelda" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h2 class="modal-title tr" id="titulocelda"></h2>
            </div>
            <div class="modal-body">
                <div class="row" id="ColumnaNave1" hidden="hidden">
                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center"></div>
                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                        <label class="control-label tr">Nave 1 (*)</label>
                        <div>
                            <select class="selectpicker form-control" data-live-search="true" name="EditarNave1" id="EditarNave1"></select>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center"></div>
                </div>
                <div class="row" id="ColumnaNumeroCarga" hidden="hidden">
                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center"></div>
                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                        <label class="control-label tr">N° Orden de Carga (*)</label>
                        <div>
                            <input type="number" id="EditarNumeroCarga" class="form-control" />
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center"></div>
                </div>
                <div id="ColumnaContenedorEditar" hidden="hidden">
                    <div class="alert alert-info row" role="alert">
                        <i class="glyphicon glyphicon-info-sign fa-2x" style="vertical-align:middle;"></i>
                        <span style="vertical-align:middle;">En la lista desplegable solo figurarán los contenedores disponibles para servicio, si no aparece un contenedor se debe presionar el boton <b>Agregar</b></span>
                    </div>
                    <div class="alert alert-info row" role="alert">
                        <i class="glyphicon glyphicon-info-sign fa-2x" style="vertical-align:middle;"></i>
                        <span style="vertical-align:middle;">Los número de contenedor se deben agregar bajo el siguiente formato: <b>"CXRU1402123"</b>, sin el guión que separa el número del dígito verificador.</span>
                    </div>
                    <div class="row" id="contenedordatos">
                        <div class="col-lg-6" style="text-align:center">
                            <label class="checkbox-inline">
                                <input type="checkbox" id="quitar">Quitar contenedor
                            </label>
                        </div>
                        <div class="col-lg-6" style="text-align:center">
                            <label class="checkbox-inline">
                                <input type="checkbox" id="cambiar"> Agregar / Cambiar contenedor
                            </label>
                        </div>
                    </div>
                    <div class="divider"></div>
                    <div id="cambiarcontenedor" hidden="hidden">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center"></div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr">N° Contenedor (*)</label>
                                    <div>
                                        <select class="selectpicker form-control" data-live-search="true" name="EditarContenedor" id="EditarContenedor"></select>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <button type="button" class="btn btn-info" id="AgregarContenedorBtn">Agregar</button>
                                </div>
                            </div>
                        </div>
                        <div class="divider"></div>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="col-lg-3 col-md-3 col-sm-12" style="text-align:center">
                                    <label class="control-label tr">Sello Panel 1</label>
                                    <div>
                                        <input type="text" id="EditarSelloperno1" class="form-control" onkeyup="this.value = this.value.toUpperCase();" readonly />
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-12" style="text-align:center">
                                    <label class="control-label tr">Sello Panel 2</label>
                                    <div>
                                        <input type="text" id="EditarSelloperno2" class="form-control" onkeyup="this.value = this.value.toUpperCase();" readonly />
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-12" style="text-align:center">
                                    <label class="control-label tr">Sello Security</label>
                                    <div>
                                        <input type="text" id="EditarTapa" class="form-control" onkeyup="this.value = this.value.toUpperCase();" readonly />
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-12" style="text-align:center">
                                    <label class="control-label tr">Deposito</label>
                                    <div>
                                        <input type="text" id="EditarDeposito" class="form-control" onkeyup="this.value = this.value.toUpperCase();" readonly />
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-12" style="text-align:center; display:none;">
                                    <label class="control-label tr">Deposito</label>
                                    <div>
                                        <input type="text" id="EditarPais" class="form-control" onkeyup="this.value = this.value.toUpperCase();" readonly />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="agregarcontenedor" hidden="hidden">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center"></div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <label class="control-label tr">N° Contenedor (*)</label>
                                    <div>
                                        <input type="text" id="AgregarContenedorInput" class="form-control" onkeyup="this.value = this.value.toUpperCase();" />
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                                    <button type="button" class="btn btn-success" id="ValidarContenedor">Validar</button>
                                </div>
                            </div>
                        </div>
                        <div class="divider"></div>

                    </div>
                    <div id="quitarcontenedor" hidden="hidden">
                        <input type="text" id="IdServcioEditarContendor" hidden="hidden" />
                        <div class="row">
                            <div class="col-lg-6 col-md-6 col-sm-6" style="text-align:center">
                                <div>
                                    <input type="text" id="EditarContenedorInput" class="form-control" onkeyup="this.value = this.value.toUpperCase();" readonly />
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-6" style="text-align:center;">
                                <div>
                                    <button type="button" class="btn btn-danger" id="QuitarContenedor">Quitar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="ColumnaControladorEditar" hidden="hidden">
                    <div>
                        <form class="form-inline">
                            <div class="form-group col-lg-6 col-md-6 col-sm-6">
                                <input type="email" class="form-control" id="EditarControlador" placeholder="Controlador (ESN)" onkeyup="this.value = this.value.toUpperCase();">
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-6">
                                <button type="button" class="btn btn-success" id="ValidarControlador">Validar</button>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="row" id="ColumnaSelloSecurityServicioEditar" hidden="hidden">
                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center"></div>
                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                        <label class="control-label tr">N° Sello Liventus</label>
                        <div>
                            <input type="text" id="EditarSelloSecurityServicio" class="form-control" onkeyup="this.value = this.value.toUpperCase();" />
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center"></div>
                </div>
                <div class="row" id="ColumnaFechacontroladorEditar" hidden="hidden">
                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center"></div>
                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                        <label class="control-label tr">Fecha Instalación Controlador (*)</label>
                        <div>
                            <input type="text" id="EditarFechaControlador" class="form-control" onkeyup="this.value = this.value.toUpperCase();" />
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center"></div>
                </div>

                <div class="row" id="ColumnaNotaServicioEditar" hidden="hidden">
                    <div class="col-lg-12 col-md-12 col-sm-12" style="text-align:center">
                        <label class="control-label tr">Observaciones </label>
                        <div>
                            <textarea class="form-control" rows="5" id="EditarComentarioDeposito"></textarea>
                        </div>
                    </div>
                </div>
                <div id="ColumnaModemEditar" hidden="hidden">
                    <div>
                        <form class="form-inline">
                            <div class="form-group col-lg-6 col-md-6 col-sm-6">
                                <input type="email" class="form-control" id="EditarModem" placeholder="Modem (ESN)" onkeyup="this.value = this.value.toUpperCase();">
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-6">
                                <button type="button" class="btn btn-success" id="ValidarModem">Validar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer EditarCelda" style="text-align:center">
                <button type="button" class="btn btn-success btn-lg" id="EditarCelda">Guardar</button>
            </div>
            <div class="modal-footer EditarBooking" style="text-align:center;">
                <button type="button" class="btn btn-success btn-lg" id="Rolear">Rolear</button>
            </div>
            <div class="modal-footer EditarRoleoBooking" style="text-align:center;">
                <button type="button" class="btn btn-success btn-lg" id="RolearEditar" onclick="RolearEditar()">Rolear</button>
            </div>
        </div>
    </div>
</div>
<!--Modal Editar Celdas-->
<!--Modal Editar Reserva-->
<div class="modal fade" id="myModal3" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="margin-left:80px; margin-right:10px;">
    <div class="modal-dialog" role="document" style="width:100%">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h2 class="modal-title tr" id="myModalLabel" key="tituloposturacortinaagregar">Agregar Servicios a Reserva</h2>
            </div>
            <div class="modal-body">
                <div class="divider"></div>
                <div class="row" id="ColumnaConsignatario">
                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center"></div>
                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                        <label class="control-label tr">BOOKING (*)</label>
                        <div>
                            <input type="text" id="AgregarServicioBooking" class="form-control" onkeyup="this.value = this.value.toUpperCase();" />
                        </div>
                    </div>

                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                        <button type="button" class="btn btn-success" id="ValidarBooking2">Validar</button>
                    </div>
                </div>
                <div class="row" id="ColumnaServicios">
                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center"></div>
                    <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                        <label class="control-label tr">CANTIDAD SERVICIOS (*)</label>
                        <div>
                            <input type="number" id="CantidadServiciosBooking" class="form-control" min="0" max="100" />
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="text-align:center">
                <button type="button" class="btn btn-success btn-lg" id="AgregarServicio">Agregar</button>
            </div>
        </div>
    </div>
</div>
<!--Modal Editar Reserva-->

<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal8" id="EditarServicioViajeTrigger" style="display:none;"></button>
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal" id="EditarReservaTrigger" style="display:none;"></button>
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal2" id="EditarCeldas" style="display:none;"></button>
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal3" id="AgregarCeldas" style="display:none;"></button>
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal4" id="HistoricoControlador" style="display:none;"></button>
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal5" id="EditarReservaNaveTrigger" style="display:none;"></button>
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal6" id="HistoricoValidacionServicioTrigger" style="display:none;"></button>
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal7" id="GraficoUnitarioModal" style="display:none;"></button>

<input type="text" class="input form_control" id="BookingEditar" disabled="disabled" hidden />
<input type="text" class="input form_control" id="ContenedorEliminar" disabled="disabled" hidden />

<script src="~/build/js/Perfiles.js"></script>
<script src="~/build/js/PerfilGestionServicios.js"></script>
<script type="text/javascript">

    var lenguaje = document.cookie;

    if (@PerfilInterior == 19 || @PerfilInterior == 5 || @PerfilInterior == 6 || @PerfilInterior == 7 ||
        @PerfilInterior == 8 || @PerfilInterior == 9 || @PerfilInterior == 10) {
        $("#botonesacciones").hide();
    }

    function formatDate(date) {
        if(date != null){
            var fecha = date.substring(0, 10);
            var ano = date.substring(0, 4);
            var mes = date.substring(5, 7);
            var dia = date.substring(8, 10);
            return dia + "-" + mes + "-" + ano;
        }else {
            return "";
        }
    }

    function getCurrentDate(date) {
        var today = new Date();
        var dd = today.getDate();
        var mm = today.getMonth()+1; //January is 0!

        var yyyy = today.getFullYear();
        if(dd<10){
            dd='0'+dd;
        }
        if(mm<10){
            mm='0'+mm;
        }
        var today = dd+'-'+mm+'-'+yyyy;
        return today;
    }

    $(document).ready(function () {

        $('#Tb_Servicios thead tr:eq(1) th').each( function (i) {
            var title = $('#example thead tr:eq(0) th').eq( $(this).index() ).text();
            $(this).html( '<input type="text" class="form-control" placeholder="FILTER" data-index="'+i+'"/>' );
        });

        var table = $("#Tb_Servicios").DataTable({
            scrollX: true,
            pageLength: 15,
            ajax: {
                "url": "@Url.Action("GetServiciosDeposito2", "Reservas")",
                "dataSrc": ''
            },
            dom: 'Bfrtip',
            buttons: [
                {
                    extend: 'excel',
                    exportOptions: {
                        orthogonal: 'export'
                    },
                }
            ],
            columns: [
                { "data": "Booking"},
                { "data": "Contenedor" },
                { "data": "Commodity" },
                { "data": "TipoEntrega" },
                { "data": "Scrubber" ,
                    "render":
                    function( data, type, row, meta){
                        if(data == -1){
                            return "";
                        }else if(data == 0){
                            return "NO";
                        }else if(data == 1){
                            return "SI";
                        }else{
                            return "DESCONOCIDO";
                        }
                    }
                },
                { "data": "NumeroOrdenCarga" },
                { "data": "FechaContenedor",
                    "render":
                      function( data, type, row, meta){
                          if(data != null){
                              var fecha = FormatDate(data);
                              return fecha;
                          }else{
                              return "";
                          }
                      }
                },
                { "data": "ControladorPorDeposito" },
                { "data": "Comentario" },
                { "data": "Deposito" },
                { "data": "Modem" },
                { "data": "IdServicio" }
            ],
        });

        $( table.table().container() ).on('keyup', 'thead input', function () {
            table
                .column( $(this).data('index'))
                .search( this.value )
                .draw();
        });

        function diferenciaDias(FechaLeaktest) {
            var date1 = new Date(FechaLeaktest);
            var date2 = new Date();
            if (date1 < date2) {
                var aux = -1;
            } else {
                var aux = 1;
            }
            var timeDiff = Math.abs(date2.getTime() - date1.getTime());
            var diffDays = Math.ceil((timeDiff / (1000 * 3600 * 24)) * aux);
            return diffDays;
        };

        function FormatDate(data) {
            var dateString = data.substr(6);
            var currentTime = new Date(parseInt(dateString));
            var month = currentTime.getMonth() + 1;
            var day = currentTime.getDate();
            var year = currentTime.getFullYear();

            if (month < 10) {
                month = "0" + month;
            } else {
                month;
            }

            if (day < 10) {
                day = "0" + day;
            } else {
                day;
            }

            var date = day + "-" + month + "-" + year;
            return date;
        }

        function FormatDateControlador(data) {
            var dateString = data.substr(6);
            var currentTime = new Date(parseInt(dateString));
            var month = currentTime.getMonth() + 1;
            var day = currentTime.getDate();
            var year = currentTime.getFullYear();
            var Hora = currentTime.getHours();
            var Minutos = currentTime.getMinutes();

            if (month < 10) {
                month = "0" + month;
            } else {
                month;
            }

            if (day < 10) {
                day = "0" + day;
            } else {
                day;
            }

            if (Hora < 10 && Hora != 0) {
                Hora = "0" + Hora;
            } else if(Hora == 0) {
                Hora = "00";
            }else {
                Hora;
            }

            if (Minutos < 10 && Minutos != 0) {
                Minutos = "0" + Minutos;
            } else if(Minutos == 0) {
                Minutos = "00" ;
            }else {
                Minutos;
            }

            var date = day + "-" + month + "-" + year + " " + Hora + ":" + Minutos;
            return date;
        }

        function FormatDateStacking(data) {
            var dateString = data.substr(6);
            var currentTime = new Date(parseInt(dateString));
            var month = currentTime.getMonth() + 1;
            var day = currentTime.getDate();
            var year = currentTime.getFullYear();

            if (month < 10) {
                month = "0" + month;
            } else {
                month;
            }

            if (day < 10) {
                day = "0" + day;
            } else {
                day;
            }

            var date = month + "-" + day + "-" + year;
            return date;
        }

        function FormatDateSemana(data){
            var dateString = data.substr(6);
            var currentTime = new Date(parseInt(dateString ));
            var month = currentTime.getMonth() + 1;
            var day = currentTime.getDate();
            var year = currentTime.getFullYear();
            var date = month + "-" + day + "-" + year;
            return date;
        }

        $(function () {
            $("#Fecha_inicio").datepicker({
                dateFormat: "dd-mm-yy",
                firstDay: 1,
                dayNamesMin: ["Do", "Lu", "Ma", "Mi", "Ju", "Vi", "Sa"],
                dayNamesShort: ["Dom", "Lun", "Mar", "Mie", "Jue", "Vie", "Sab"],
                monthNames:
                    ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio",
                    "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
                monthNamesShort:
                    ["Ene", "Feb", "Mar", "Abr", "May", "Jun",
                    "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"],
                showWeek: true
            });

            $('#EditarFechaControlador').datetimepicker({});
        });
    });

    $('#Tb_Servicios').on( 'click', 'tbody td:not(:first-child)', function (e) {
        //VALIDAR DATOS QUE NO SE PODRAN MODIFICAR
        var Cabecera = $('#Tb_Servicios thead tr th').eq($(this).index()).text().trim();
        var texto = "EDITAR " + Cabecera;
        $(".titulo").find('h2').text("");
        $(".titulo").find('h2').text(texto)
        $("#guardadocorrectamente").hide();
            if(Cabecera == "RESERVA" ){
                swal('Ups!', 'No es posible editar este campo, ya que es un campo de la Reserva.', 'error');
                return false;
            }else if(Cabecera == "NAVE" || Cabecera=="ESTADO SERVICIO"){
                swal('Ups!', 'No es posible editar este campo, ya que es un campo de la Reserva.', 'error');
                return false;
            }else if(Cabecera == "TIPO ENTREGA" || Cabecera == "TIPO CONTROLADOR" || Cabecera == "COMMODITY" ){
                swal('Ups!', 'No es posible editar este campo, ya que es un campo de la Reserva.', 'error');
                return false;
            }else if (Cabecera == "N° CONTENEDOR") {

                $('#quitarcontenedor').hide();
                $('#cambiarcontenedor').hide();
                $('#quitar').prop('checked', false);
                $('#cambiar').prop('checked', false);
                $('.EditarCelda').hide();

                localStorage.setItem("Fila", $(this).parent().index());
                localStorage.setItem("Columna", $(this).parent().children().index($(this)));
                localStorage.setItem("Campo", "Contenedor");
                localStorage.setItem("CampoBase", "ID_CONTENEDOR");

                //if ($('#Tb_Servicios tbody tr:eq(' + $(this).parent().index() + ') td:eq(' + $(this).parent().children().index($(this)) + ')').text() != "") {
                //    $("#EditarContenedorInput").val($('#Tb_Servicios tbody tr:eq(' + $(this).parent().index() + ') td:eq(' + $(this).parent().children().index($(this)) + ')').text());
                //    $("#IdServcioEditarContendor").val($('#Tb_Servicios tbody tr:eq(' + $(this).parent().index() + ') td:eq(61)').text());
                //}

                $('#agregarcontenedor').hide();
                $('#AgregarContenedorInput').val("");

                $('#EditarSelloperno1').val("");
                $('#EditarSelloperno2').val("");
                $('#EditarTapa').val("");
                $('#EditarDeposito').val("");
                $('#EditarPais').val("");
                $('#ColumnaConsignatarioEditar').hide();
                $('#ColumnaNave1').hide();
                $('#ColumnaNave2').hide();
                $('#ColumnaNave3').hide();
                $('#ColumnaViajeEditar').hide();
                $('#ColumnaViajeEditar2').hide();
                $('#ColumnaViajeEditar3').hide();
                $('#ColumnaEtaNaveEditar').hide();
                $('#ColumnaIniStackingEditar').hide();
                $('#ColumnaFinStackingEditar').hide();
                $('#ColumnaFreightforwarderEditar').hide();
                $('#ColumnaEtdEditar').hide();
                $('#ColumnaEtaPuertoEditar').hide();
                $('#ColumnaPuertoOrigenEditar').hide();
                $('#ColumnaPuertoDestinoEditar').hide();
                $('#ColumnaBookingEditar').hide();
                $('#ColumnaCommodityEditar').hide();
                $('#ColumnaTemperaturaEditar').hide();
                $('#ColumnaContenedorEditar').show();
                $('#ColumnaControladorEditar').hide();
                $('#ColumnaTipolugarcontroladorEditar').hide();
                $('#ColumnaTecnicocontroladorEditar').hide();
                $('#ColumnaBateriaEditar').hide();
                $('#ColumnaPrecintoEditar').hide();
                $('#ColumnaCandadoEditar').hide();
                $('#ColumnaSelloP1ServicioEditar').hide();
                $('#ColumnaSelloP2ServicioEditar').hide();
                $('#ColumnaObservacionesSellosEditar').hide();
                $('#ColumnaSelloSecurityServicioEditar').hide();
                $('#ColumnaHorallegadaEditar').hide();
                $('#ColumnaHorasalidaEditar').hide();
                $('#ColumnaTipolugarcortinaEditar').hide();
                $('#ColumnaFechacontroladorEditar').hide();
                $('#ColumnaFechacortinaEditar').hide();
                $('#ColumnaPurafilEditar').hide();
                $('#ColumnaTecnicocortinaEditar').hide();
                $('#ColumnaFechagasificacionEditar').hide();
                $('#ColumnaTipolugargasificacionEditar').hide();
                $('#ColumnaGasesEditar').hide();
                $('#ColumnaTenicogasificacionEditar').hide();
                $('#ColumnaTratamientoEditar').hide();
                $('#ColumnaFiltrosEditar').hide();
                $('#ColumnaCalEditar').hide();
                $('#ColumnaNotaServicioEditar').hide();
                $('#ColumnaNotaLogisticaEditar').hide();
                $('#ColumnaValidado').hide();
                $('#ColumnaHabilitacion').hide();
                $('#ColumnaModemEditar').hide();
                $('#ColumnaValidacionPreZarpe').hide();
                $('#ColumnaFechaValidacionPreZarpeEditar').hide();
                $('#ColumnaPosContenedorNave').hide();
                $('#ColumnaNumeroCarga').hide();
                $('.EditarCelda').hide();
                $(".EditarBooking").hide();
                $(".EditarRoleoBooking").hide();
                $('#ColumnaGestionServicio').hide();
                $('#EditarCeldas').trigger('click');
            }else if(Cabecera == "N° CONTROLADOR") {
                if($('#Tb_Servicios tbody tr:eq(1) td:eq('+$(this).parent().index()+')').text() == "NOT RECOVERED"){
                    swal('Ups!', 'No es posible modificar controlador de un servicio que esta "NOT RECOVERED"', 'error');
                    return false;
                }else if($('#Tb_Servicios tbody tr:eq(1) td:eq('+$(this).parent().index()+')').text() == "RECOVERED"){
                    swal('Ups!', 'No es posible modificar controlador de un servicio que esta "RECOVERED"', 'error');
                    return false;
                }else if($('#Tb_Servicios tbody tr:eq(1) td:eq('+$(this).parent().index()+')').text() == "CANCELLED"){
                    swal('Ups!', 'No es posible modificar controlador de un servicio que esta "CANCELLED"', 'error');
                    return false;
                }else{
                    localStorage.setItem("Fila", $(this).parent().index());
                    localStorage.setItem("Columna", $(this).parent().children().index($(this)));
                    localStorage.setItem("Campo", "Controlador");
                    localStorage.setItem("CampoBase", "ID_CONTROLADOR");
                    var id_servicio = $('#Tb_Servicios tbody tr:eq('+ $(this).parent().index() +') td:eq(10)').text();
                    localStorage.setItem("Id_Servicio", id_servicio);


                    $("button[data-id=TipoNodoControlador]").css("background", "rgba(255, 0, 0, 0)");
                    $("button[data-id=NodoControlador]").css("background", "rgba(255, 0, 0, 0)");
                    if($('#Tb_Servicios tbody tr:eq('+$(this).parent().index()+') td:eq('+$(this).parent().children().index($(this))+')').text() != ""){
                        $('#LugarOrigen').show();
                        $.ajax({
                            type: "POST",
                            url: '@Url.Action("GetTipoLugares", "TipoLugar")',
                            async: false,
                            success: function (response) {
                                var data = [];
                                var json = JSON.parse(response);
                                var cuenta = json.length;
                                var optionsAsString = "";
                                $('#TipoNodoControlador').empty();

                                for (var i = 0; i < cuenta; i++) {
                                    optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                                }
                                $('#TipoNodoControlador').append(optionsAsString);
                                $('#TipoNodoControlador').selectpicker('refresh');
                            },
                        });
                    }else{
                        $('#LugarOrigen').hide();
                    }

                    $('#EditarControlador').val("");
                    $('#ColumnaConsignatarioEditar').hide();
                    $('#ColumnaNave1').hide();
                    $('#ColumnaNave2').hide();
                    $('#ColumnaNave3').hide();
                    $('#ColumnaViajeEditar').hide();
                    $('#ColumnaViajeEditar2').hide();
                    $('#ColumnaViajeEditar3').hide();
                    $('#ColumnaEtaNaveEditar').hide();
                    $('#ColumnaIniStackingEditar').hide();
                    $('#ColumnaFinStackingEditar').hide();
                    $('#ColumnaFreightforwarderEditar').hide();
                    $('#ColumnaEtdEditar').hide();
                    $('#ColumnaEtaPuertoEditar').hide();
                    $('#ColumnaPuertoOrigenEditar').hide();
                    $('#ColumnaPuertoDestinoEditar').hide();
                    $('#ColumnaBookingEditar').hide();
                    $('#ColumnaCommodityEditar').hide();
                    $('#ColumnaTemperaturaEditar').hide();
                    $('#ColumnaContenedorEditar').hide();
                    $('#ColumnaControladorEditar').show();
                    $('#ColumnaTipolugarcontroladorEditar').hide();
                    $('#ColumnaTecnicocontroladorEditar').hide();
                    $('#ColumnaBateriaEditar').hide();
                    $('.EditarCelda').hide();
                    $('#ColumnaPrecintoEditar').hide();
                    $('#ColumnaCandadoEditar').hide();
                    $('#ColumnaSelloP1ServicioEditar').hide();
                    $('#ColumnaSelloP2ServicioEditar').hide();
                    $('#ColumnaObservacionesSellosEditar').hide();
                    $('#ColumnaSelloSecurityServicioEditar').hide();
                    $('#ColumnaHorallegadaEditar').hide();
                    $('#ColumnaHorasalidaEditar').hide();
                    $('#ColumnaTipolugarcortinaEditar').hide();
                    $('#ColumnaFechacontroladorEditar').hide();
                    $('#ColumnaFechacortinaEditar').hide();
                    $('#ColumnaPurafilEditar').hide();
                    $('#ColumnaTecnicocortinaEditar').hide();
                    $('#ColumnaFechagasificacionEditar').hide();
                    $('#ColumnaTipolugargasificacionEditar').hide();
                    $('#ColumnaGasesEditar').hide();
                    $('#ColumnaTenicogasificacionEditar').hide();
                    $('#ColumnaTratamientoEditar').hide();
                    $('#ColumnaFiltrosEditar').hide();
                    $('#ColumnaCalEditar').hide();
                    $('#ColumnaNotaServicioEditar').hide();
                    $('#ColumnaNotaLogisticaEditar').hide();
                    $('#ColumnaValidado').hide();
                    $('#ColumnaHabilitacion').hide();
                    $('#ColumnaModemEditar').hide();
                    $('#ColumnaValidacionPreZarpe').hide();
                    $('#ColumnaFechaValidacionPreZarpeEditar').hide();
                    $('#ColumnaPosContenedorNave').hide();
                    $('#ColumnaNumeroCarga').hide();
                    $(".EditarBooking").hide();
                    $(".EditarRoleoBooking").hide();
                    $('#ColumnaGestionServicio').hide();
                    $('#EditarCeldas').trigger('click');
                }
            }else if(Cabecera == "N° SELLO LIVENTUS") {
                localStorage.setItem("Fila", $(this).parent().index());
                localStorage.setItem("Columna", $(this).parent().children().index($(this)));
                localStorage.setItem("Campo", "SelloSecurityServicio");
                localStorage.setItem("CampoBase", "SELLOSECURITYSERVICIO");
                $('#EditarSelloSecurityServicio').val("");
                $('#ColumnaConsignatarioEditar').hide();
                $('#ColumnaNave1').hide();
                $('#ColumnaNave2').hide();
                $('#ColumnaNave3').hide();
                $('#ColumnaViajeEditar').hide();
                $('#ColumnaViajeEditar2').hide();
                $('#ColumnaViajeEditar3').hide();
                $('#ColumnaEtaNaveEditar').hide();
                $('#ColumnaIniStackingEditar').hide();
                $('#ColumnaFinStackingEditar').hide();
                $('#ColumnaFreightforwarderEditar').hide();
                $('#ColumnaEtdEditar').hide();
                $('#ColumnaEtaPuertoEditar').hide();
                $('#ColumnaPuertoOrigenEditar').hide();
                $('#ColumnaPuertoDestinoEditar').hide();
                $('#ColumnaBookingEditar').hide();
                $('#ColumnaCommodityEditar').hide();
                $('#ColumnaTemperaturaEditar').hide();
                $('#ColumnaContenedorEditar').hide();
                $('#ColumnaControladorEditar').hide();
                $('#ColumnaTipolugarcontroladorEditar').hide();
                $('#ColumnaTecnicocontroladorEditar').hide();
                $('#ColumnaBateriaEditar').hide();
                $('#ColumnaCandadoEditar').hide();
                $('#ColumnaPrecintoEditar').hide();
                $('#ColumnaCandadoEditar').hide();
                $('#ColumnaSelloP1ServicioEditar').hide();
                $('#ColumnaSelloP2ServicioEditar').hide();
                $('#ColumnaObservacionesSellosEditar').hide();
                $('#ColumnaSelloSecurityServicioEditar').show();
                $('#ColumnaHorallegadaEditar').hide();
                $('#ColumnaHorasalidaEditar').hide();
                $('#ColumnaTipolugarcortinaEditar').hide();
                $('#ColumnaFechacontroladorEditar').hide();
                $('#ColumnaFechacortinaEditar').hide();
                $('#ColumnaPurafilEditar').hide();
                $('#ColumnaTecnicocortinaEditar').hide();
                $('#ColumnaFechagasificacionEditar').hide();
                $('#ColumnaTipolugargasificacionEditar').hide();
                $('#ColumnaGasesEditar').hide();
                $('#ColumnaTenicogasificacionEditar').hide();
                $('#ColumnaTratamientoEditar').hide();
                $('#ColumnaFiltrosEditar').hide();
                $('#ColumnaCalEditar').hide();
                $('#ColumnaNotaServicioEditar').hide();
                $('#ColumnaNotaLogisticaEditar').hide();
                $('#ColumnaValidado').hide();
                $('#ColumnaHabilitacion').hide();
                $('#ColumnaModemEditar').hide();
                $('#ColumnaValidacionPreZarpe').hide();
                $('#ColumnaFechaValidacionPreZarpeEditar').hide();
                $('#ColumnaPosContenedorNave').hide();
                $('#ColumnaNumeroCarga').hide();
                $(".EditarCelda").show();
                $(".EditarBooking").hide();
                $(".EditarRoleoBooking").hide();
                $('#ColumnaGestionServicio').hide();
                $('#EditarCeldas').trigger('click');
            }else if(Cabecera == "FECHA INSTALACION CONTROLADOR") {
                localStorage.setItem("Fila", $(this).parent().index());
                localStorage.setItem("Columna", $(this).parent().children().index($(this)));
                localStorage.setItem("Campo", "FechaControlador");
                localStorage.setItem("CampoBase", "FECHACONTROLADOR");
                $('#EditarFechaControlador').val("");
                $('#ColumnaConsignatarioEditar').hide();
                $('#ColumnaNave1').hide();
                $('#ColumnaNave2').hide();
                $('#ColumnaNave3').hide();
                $('#ColumnaViajeEditar').hide();
                $('#ColumnaViajeEditar2').hide();
                $('#ColumnaViajeEditar3').hide();
                $('#ColumnaEtaNaveEditar').hide();
                $('#ColumnaIniStackingEditar').hide();
                $('#ColumnaFinStackingEditar').hide();
                $('#ColumnaFreightforwarderEditar').hide();
                $('#ColumnaEtdEditar').hide();
                $('#ColumnaEtaPuertoEditar').hide();
                $('#ColumnaPuertoOrigenEditar').hide();
                $('#ColumnaPuertoDestinoEditar').hide();
                $('#ColumnaBookingEditar').hide();
                $('#ColumnaCommodityEditar').hide();
                $('#ColumnaTemperaturaEditar').hide();
                $('#ColumnaContenedorEditar').hide();
                $('#ColumnaControladorEditar').hide();
                $('#ColumnaTipolugarcontroladorEditar').hide();
                $('#ColumnaTecnicocontroladorEditar').hide();
                $('#ColumnaBateriaEditar').hide();
                $('#ColumnaCandadoEditar').hide();
                $('#ColumnaPrecintoEditar').hide();
                $('#ColumnaCandadoEditar').hide();
                $('#ColumnaSelloP1ServicioEditar').hide();
                $('#ColumnaSelloP2ServicioEditar').hide();
                $('#ColumnaObservacionesSellosEditar').hide();
                $('#ColumnaSelloSecurityServicioEditar').hide();
                $('#ColumnaHorallegadaEditar').hide();
                $('#ColumnaHorasalidaEditar').hide();
                $('#ColumnaTipolugarcortinaEditar').hide();
                $('#ColumnaFechacontroladorEditar').show();
                $('#ColumnaFechacortinaEditar').hide();
                $('#ColumnaPurafilEditar').hide();
                $('#ColumnaTecnicocortinaEditar').hide();
                $('#ColumnaFechagasificacionEditar').hide();
                $('#ColumnaTipolugargasificacionEditar').hide();
                $('#ColumnaGasesEditar').hide();
                $('#ColumnaTenicogasificacionEditar').hide();
                $('#ColumnaTratamientoEditar').hide();
                $('#ColumnaFiltrosEditar').hide();
                $('#ColumnaCalEditar').hide();
                $('#ColumnaNotaServicioEditar').hide();
                $('#ColumnaNotaLogisticaEditar').hide();
                $('#ColumnaValidado').hide();
                $('#ColumnaHabilitacion').hide();
                $('#ColumnaModemEditar').hide();
                $('#ColumnaValidacionPreZarpe').hide();
                $('#ColumnaFechaValidacionPreZarpeEditar').hide();
                $('#ColumnaPosContenedorNave').hide();
                $('#ColumnaNumeroCarga').hide();
                $(".EditarCelda").show();
                $(".EditarBooking").hide();
                $(".EditarRoleoBooking").hide();
                $('#ColumnaGestionServicio').hide();
                $('#EditarCeldas').trigger('click');
            }else if(Cabecera == "OBSERVACIONES") {

                if(@PerfilInterior == 1023 || @PerfilInterior == 1028){
                    swal('Ups!', 'Su perfil de usuario no puede agregar observaciones del servicio.', 'error');
                    return false;
                }
                else
                {
                    localStorage.setItem("Fila", $(this).parent().index());
                    localStorage.setItem("Columna", $(this).parent().children().index($(this)));
                    localStorage.setItem("Campo", "ComentarioDeposito");
                    localStorage.setItem("CampoBase", "COMENTARIODEPOSITO");
                    $('#ColumnaConsignatarioEditar').hide();
                    $('#ColumnaNave1').hide();
                    $('#ColumnaNave2').hide();
                    $('#ColumnaNave3').hide();
                    $('#ColumnaViajeEditar').hide();
                    $('#ColumnaViajeEditar2').hide();
                    $('#ColumnaViajeEditar3').hide();
                    $('#ColumnaEtaNaveEditar').hide();
                    $('#ColumnaIniStackingEditar').hide();
                    $('#ColumnaFinStackingEditar').hide();
                    $('#ColumnaFreightforwarderEditar').hide();
                    $('#ColumnaEtdEditar').hide();
                    $('#ColumnaEtaPuertoEditar').hide();
                    $('#ColumnaPuertoOrigenEditar').hide();
                    $('#ColumnaPuertoDestinoEditar').hide();
                    $('#ColumnaBookingEditar').hide();
                    $('#ColumnaCommodityEditar').hide();
                    $('#ColumnaTemperaturaEditar').hide();
                    $('#ColumnaContenedorEditar').hide();
                    $('#ColumnaControladorEditar').hide();
                    $('#ColumnaTipolugarcontroladorEditar').hide();
                    $('#ColumnaTecnicocontroladorEditar').hide();
                    $('#ColumnaBateriaEditar').hide();
                    $('#ColumnaCandadoEditar').hide();
                    $('#ColumnaPrecintoEditar').hide();
                    $('#ColumnaCandadoEditar').hide();
                    $('#ColumnaSelloP1ServicioEditar').hide();
                    $('#ColumnaSelloP2ServicioEditar').hide();
                    $('#ColumnaObservacionesSellosEditar').hide();
                    $('#ColumnaSelloSecurityServicioEditar').hide();
                    $('#ColumnaHorallegadaEditar').hide();
                    $('#ColumnaHorasalidaEditar').hide();
                    $('#ColumnaTipolugarcortinaEditar').hide();
                    $('#ColumnaFechacontroladorEditar').hide();
                    $('#ColumnaFechacortinaEditar').hide();
                    $('#ColumnaPurafilEditar').hide();
                    $('#ColumnaTecnicocortinaEditar').hide();
                    $('#ColumnaFechagasificacionEditar').hide();
                    $('#ColumnaTipolugargasificacionEditar').hide();
                    $('#ColumnaGasesEditar').hide();
                    $('#ColumnaTenicogasificacionEditar').hide();
                    $('#ColumnaTratamientoEditar').hide();
                    $('#ColumnaFiltrosEditar').hide();
                    $('#ColumnaCalEditar').hide();
                    $('#ColumnaNotaServicioEditar').show();
                    $('#ColumnaNotaLogisticaEditar').hide();
                    $('#ColumnaValidado').hide();
                    $('#ColumnaHabilitacion').hide();
                    $('#ColumnaModemEditar').hide();
                    $('#ColumnaValidacionPreZarpe').hide();
                    $('#ColumnaFechaValidacionPreZarpeEditar').hide();
                    $('#ColumnaPosContenedorNave').hide();
                    $('#ColumnaNumeroCarga').hide();
                    $(".EditarCelda").show();
                    $(".EditarBooking").hide();
                    $(".EditarRoleoBooking").hide();
                    $('#ColumnaGestionServicio').hide();
                    $('#EditarCeldas').trigger('click');
                }


            }else if(Cabecera == "N° ORDEN DE CARGA") {
                localStorage.setItem("Fila", $(this).parent().index());
                localStorage.setItem("Columna", $(this).parent().children().index($(this)));
                localStorage.setItem("Campo", "NumeroCarga");
                localStorage.setItem("CampoBase", "NUMEROCARGA");
                $('#ColumnaConsignatarioEditar').hide();
                $('#ColumnaNave1').hide();
                $('#ColumnaNave2').hide();
                $('#ColumnaNave3').hide();
                $('#ColumnaViajeEditar').hide();
                $('#ColumnaViajeEditar2').hide();
                $('#ColumnaViajeEditar3').hide();
                $('#ColumnaEtaNaveEditar').hide();
                $('#ColumnaIniStackingEditar').hide();
                $('#ColumnaFinStackingEditar').hide();
                $('#ColumnaFreightforwarderEditar').hide();
                $('#ColumnaEtdEditar').hide();
                $('#ColumnaEtaPuertoEditar').hide();
                $('#ColumnaPuertoOrigenEditar').hide();
                $('#ColumnaPuertoDestinoEditar').hide();
                $('#ColumnaBookingEditar').hide();
                $('#ColumnaCommodityEditar').hide();
                $('#ColumnaTemperaturaEditar').hide();
                $('#ColumnaContenedorEditar').hide();
                $('#ColumnaControladorEditar').hide();
                $('#ColumnaTipolugarcontroladorEditar').hide();
                $('#ColumnaTecnicocontroladorEditar').hide();
                $('#ColumnaBateriaEditar').hide();
                $('#ColumnaCandadoEditar').hide();
                $('#ColumnaPrecintoEditar').hide();
                $('#ColumnaCandadoEditar').hide();
                $('#ColumnaSelloP1ServicioEditar').hide();
                $('#ColumnaSelloP2ServicioEditar').hide();
                $('#ColumnaObservacionesSellosEditar').hide();
                $('#ColumnaSelloSecurityServicioEditar').hide();
                $('#ColumnaHorallegadaEditar').hide();
                $('#ColumnaHorasalidaEditar').hide();
                $('#ColumnaTipolugarcortinaEditar').hide();
                $('#ColumnaFechacontroladorEditar').hide();
                $('#ColumnaFechacortinaEditar').hide();
                $('#ColumnaPurafilEditar').hide();
                $('#ColumnaTecnicocortinaEditar').hide();
                $('#ColumnaFechagasificacionEditar').hide();
                $('#ColumnaTipolugargasificacionEditar').hide();
                $('#ColumnaGasesEditar').hide();
                $('#ColumnaTenicogasificacionEditar').hide();
                $('#ColumnaTratamientoEditar').hide();
                $('#ColumnaFiltrosEditar').hide();
                $('#ColumnaCalEditar').hide();
                $('#ColumnaNotaServicioEditar').hide();
                $('#ColumnaNotaLogisticaEditar').hide();
                $('#ColumnaValidado').hide();
                $('#ColumnaHabilitacion').hide();
                $('#ColumnaModemEditar').hide();
                $('#ColumnaValidacionPreZarpe').hide();
                $('#ColumnaFechaValidacionPreZarpeEditar').hide();
                $('#ColumnaPosContenedorNave').hide();
                $('#ColumnaNumeroCarga').show();
                $(".EditarBooking").hide();
                $(".EditarRoleoBooking").hide();
                $('#ColumnaGestionServicio').hide();
                $('#EditarCeldas').trigger('click');
            }
            else if (Cabecera == "MODEM") {

                /*if ($('#Tb_Servicios tbody tr:eq(2) td:eq(' + $(this).parent().index() + ')').text() == "NOT RECOVERED") {
                    swal('Ups!', 'No es posible modificar Modem de un servicio que esta "NOT RECOVERED"', 'error');
                    return false;
                } else if ($('#Tb_Servicios tbody tr:eq(2) td:eq(' + $(this).parent().index() + ')').text() == "RECOVERED") {
                    swal('Ups!', 'No es posible modificar Modem de un servicio que esta "RECOVERED"', 'error');
                    return false;
                } else if ($('#Tb_Servicios tbody tr:eq(2) td:eq(' + $(this).parent().index() + ')').text() == "CANCELLED") {
                    swal('Ups!', 'No es posible modificar Modem de un servicio que esta "CANCELLED"', 'error');
                    return false;
                } else {*/
                    localStorage.setItem("Fila", $(this).parent().index());
                    localStorage.setItem("Columna", $(this).parent().children().index($(this)));
                    localStorage.setItem("Campo", "Modem");
                    localStorage.setItem("CampoBase", "MODEM");

                    $('#EditarModem').val("");
                    $('#ColumnaConsignatarioEditar').hide();
                    $('#ColumnaNave1').hide();
                    $('#ColumnaNave2').hide();
                    $('#ColumnaNave3').hide();
                    $('#ColumnaViajeEditar').hide();
                    $('#ColumnaViajeEditar2').hide();
                    $('#ColumnaViajeEditar3').hide();
                    $('#ColumnaEtaNaveEditar').hide();
                    $('#ColumnaIniStackingEditar').hide();
                    $('#ColumnaFinStackingEditar').hide();
                    $('#ColumnaFreightforwarderEditar').hide();
                    $('#ColumnaEtdEditar').hide();
                    $('#ColumnaEtaPuertoEditar').hide();
                    $('#ColumnaPuertoOrigenEditar').hide();
                    $('#ColumnaPuertoDestinoEditar').hide();
                    $('#ColumnaBookingEditar').hide();
                    $('#ColumnaCommodityEditar').hide();
                    $('#ColumnaTemperaturaEditar').hide();
                    $('#ColumnaContenedorEditar').hide();
                    $('#ColumnaControladorEditar').hide();
                    $('#ColumnaModemEditar').show();
                    $('#ColumnaTipolugarcontroladorEditar').hide();
                    $('#ColumnaTecnicocontroladorEditar').hide();
                    $('#ColumnaTipolugarModemEditar').hide();
                    $('#ColumnaTecnicoModemEditar').hide();
                    $('#ColumnaFechaModemEditar').hide();
                    $('#ColumnaLlevaModemEditar').hide();
                    $('#ColumnaBateriaEditar').hide();
                    $('.EditarCelda').hide();
                    $('#ColumnaPrecintoEditar').hide();
                    $('#ColumnaCandadoEditar').hide();
                    $('#ColumnaSelloP1ServicioEditar').hide();
                    $('#ColumnaSelloP2ServicioEditar').hide();
                    $('#ColumnaObservacionesSellosEditar').hide();
                    $('#ColumnaSelloSecurityServicioEditar').hide();
                    $('#ColumnaHorallegadaEditar').hide();
                    $('#ColumnaHorasalidaEditar').hide();
                    $('#ColumnaTipolugarcortinaEditar').hide();
                    $('#ColumnaFechacontroladorEditar').hide();
                    $('#ColumnaFechacortinaEditar').hide();
                    $('#ColumnaPurafilEditar').hide();
                    $('#ColumnaTecnicocortinaEditar').hide();
                    $('#ColumnaFechagasificacionEditar').hide();
                    $('#ColumnaTipolugargasificacionEditar').hide();
                    $('#ColumnaGasesEditar').hide();
                    $('#ColumnaTenicogasificacionEditar').hide();
                    $('#ColumnaTratamientoEditar').hide();
                    $('#ColumnaFiltrosEditar').hide();
                    $('#ColumnaCalEditar').hide();
                    $('#ColumnaNotaServicioEditar').hide();
                    $('#ColumnaNotaLogisticaEditar').hide();
                    $('#ColumnaValidado').hide();
                    $('#ColumnaHabilitacion').hide();
                    $('#ColumnaValidacionPreZarpe').hide();
                    $('#ColumnaFechaValidacionPreZarpeEditar').hide();
                    $('#ColumnaPosContenedorNave').hide();
                    $(".EditarBooking").hide();
                    $(".EditarRoleoBooking").hide();
                    $('#ColumnaGestionServicio').hide();
                    $('#EditarCeldas').trigger('click');
                /*}*/
            }
    });

    $("#EditarCelda").click(function () {

        var fila = localStorage.getItem("Fila");
        var Columna = localStorage.getItem("Columna");
        var Campo = localStorage.getItem("Campo");
        console.log('fila: ' + fila);
        console.log('Columna: ' + Columna);
        console.log('Campo: ' + Campo);

        var dato = $("#Editar" + localStorage.getItem("Campo")).val();
        console.log('dato: ' + dato);

        if(localStorage.getItem("Campo") == "Contenedor"){
            if($("#EditarContenedor").val() == "0" || $("#EditarContenedor").val() == null){
                swal('Ups!', 'Debe seleccionar un dato.', 'error');
                return false;
            }else if($("#AgregarContenedorInput").val()!="")
            {
                var dato = $("#AgregarContenedorInput").val();
            }
        }

        $.ajax({
            type: "POST",
            url: '@Url.Action("EditarCelda", "Reservas")',
            data: {
                IdServicio : $('#Tb_Servicios tbody tr:eq('+fila+') td:eq(10)').text(),
                Campo : localStorage.getItem("Campo"),
                Valor : dato.toString(),
                Columna : localStorage.getItem("CampoBase"),
                IdSetpoint : 0,
                IdLugarControlador : 0,
                IdLugarCortina : 0,
                IdLugarGasificacion : 0,
                IdTipoNodoControladorOrigen : 0,
                IdNodoControladorOrigen : 0,
                IdLugarModem: 0
            },
            success: function (response) {
                var json = JSON.parse(response);
                if (json.validador == 0) {
                    $("#guardadocorrectamente").show();
                    if($("#Editar"+localStorage.getItem("Campo")+" option:selected").text() == ""){
                        if(localStorage.getItem("Campo") == "Controlador"){
                            $('#Tb_Servicios tbody tr:eq('+fila+') td:eq('+Columna+')').text(dato);
                        //$('#Tb_Servicios tbody tr:eq('+fila+') td:eq(10)').text(getCurrentDate());
                        }
                        else{
                            $('#Tb_Servicios tbody tr:eq('+fila+') td:eq('+Columna+')').text(dato);
                        }
                    }else{
                        if(localStorage.getItem("Campo") == "Contenedor"){
                            if($("#AgregarContenedorInput").val()!="")
                            {
                                $('#Tb_Servicios tbody tr:eq('+fila+') td:eq('+Columna+')').text($("#AgregarContenedorInput").val());
                            }else
                            {
                                $('#Tb_Servicios tbody tr:eq('+fila+') td:eq('+Columna+')').text($("#Editar"+localStorage.getItem("Campo")+" option:selected").text());
                            }
                            $('#Tb_Servicios tbody tr:eq('+fila+') td:eq(5)').text(getCurrentDate());
                        }else{
                            $('#Tb_Servicios tbody tr:eq('+fila+') td:eq('+Columna+')').text($("#Editar"+localStorage.getItem("Campo")+" option:selected").text());
                        }
                    }
                }
            }
        });


        $('.closeCelda').trigger('click');
    });

    $('#quitar').change(function () {
        if ($(this).prop("checked")) {
            $('#quitarcontenedor').show();
            $('#cambiarcontenedor').hide();
            $('#AgregarContenedorInput').hide();
            $('#AgregarContenedorInput').val("");
            $('#cambiar').prop('checked', false);
            $('.EditarCelda').hide();
            $("#EditarContenedorInput").css("background-color", "rgba(255, 0, 0, 0");
            return;
        } else {
            $('#quitarcontenedor').hide();
            $('#AgregarContenedorInput').val("");
            return;
        }
    });

    $('#cambiar').change(function () {
        if ($(this).prop("checked")) {
            $('#EditarSelloperno1').val("");
            $('#EditarSelloperno2').val("");
            $('#EditarTapa').val("");
            $('#EditarDeposito').val("");
            $('#EditarPais').val("");
            $('#AgregarContenedorInput').val("");
            $('#cambiarcontenedor').show();
            $('#AgregarContenedorInput').hide();
            $('#quitarcontenedor').hide();
            $('#quitar').prop('checked', false);
            $('.EditarCelda').show();
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetContenedoresAprobados", "Contenedores")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    $('#EditarContenedor').empty();
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].IdContenedor + "'>" + json[i].NumeroContenedor + "</option>";
                    }
                    $('#EditarContenedor').append(optionsAsString);
                    $('#EditarContenedor').selectpicker('refresh');
                },
            });
            return;
        } else {
            $('#cambiarcontenedor').hide();
            $('#agregarcontenedor').hide();
            $('#AgregarContenedorInput').val("");
            $('.EditarCelda').hide();
            return;
        }
    });

    $("#QuitarContenedor").click(function () {
        if ($("#EditarContenedorInput").val() != "") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("QuitarContenedor", "Reservas")',
                data: {
                    NumContenedor: $("#EditarContenedorInput").val(),
                    IdServicio: $("#IdServcioEditarContendor").val()
                },
                success: function (response) {
                    var json = JSON.parse(response);
                    if (json.validador == 0) {
                        var aux = 'success';
                    } else {
                        var aux = 'warning';
                    }
                    swal({
                        title: '',
                        text: json.Mensaje,
                        type: aux,
                        showCancelButton: false,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Aceptar'
                    }).then((result) => {
                        $('#Tb_Servicios tbody tr:eq(' + localStorage.getItem("Fila") + ') td:eq(' + localStorage.getItem("Columna") + ')').text("")
                        $('#quitarcontenedor').hide();
                        $('#quitar').prop('checked', false);
                    })
                },
            });
        } else {
            $("#EditarContenedorInput").css("background-color", "rgba(255, 0, 0, 0.4");
        }
    });

    $("#AgregarContenedorBtn").click(function () {
            $('#agregarcontenedor').show();
            $('#cambiarcontenedor').hide();
            $('#AgregarContenedorInput').show();
            $('.EditarCelda').hide();
    });

    //VALIDAR CONTENEDOR
    $("#ValidarContenedor").click(function () {
        $("#ValidarContenedor").click(function () {
            if ($("#AgregarContenedorInput").val() != "") {

                $.ajax({
                    type: "POST",
                    url: '@Url.Action("ValidarNumeroContenedor", "Contenedores")',
                    data: { containerNumberToCheck: $("#AgregarContenedorInput").val() },
                    success: function (response) {
                        if (response == "False") {
                            swal('Ups!', '<span>Número contenedor inválido.</span>', 'warning');
                            $("#AgregarContenedorInput").val("");
                            return false;
                        } else {
                            $.ajax({
                                type: "POST",
                                url: '@Url.Action("ValidarContenedor", "Controlador")',
                                data: { Contenedor: $("#AgregarContenedorInput").val() },
                                async: false,
                                success: function (response) {
                                    var json = JSON.parse(response);
                                    if (json.validador == 0 || json.validador == 2 || json.validador == 3 || json.validador == 5 || json.validador == 6 || json.validador==7) {
                                        swal('Válido!', '<span>Número contenedor válido.</span>', 'success');
                                        $('.EditarCelda').show();
                                    } else {
                                        swal({
                                            title: '',
                                            text: json.Mensaje,
                                            type: 'warning',
                                            showCancelButton: false,
                                            confirmButtonColor: '#3085d6',
                                            cancelButtonColor: '#d33',
                                            confirmButtonText: 'Aceptar'
                                        }).then((result) => {

                                        })
                                    }
                                },
                            });
                        }
                    }
                });


            }
        });
    });
    //VALIDAR CONTENEDOR

    //VALIDAR CONTROLADOR
    $("#ValidarControlador").click(function () {
        if ($("#EditarControlador").val() != "") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("ValidarControlador", "Controlador")',
                data: {
                    Controlador: $("#EditarControlador").val(),
                    IdServicio: localStorage.getItem("Id_Servicio")
                },
                success: function (response)
                {
                    if (response == 0)
                    {
                        swal('Ups!', '<span>Controlador no existe en los registros</span>', 'warning');
                        $("#EditarControlador").val("");
                    }
                    else if(response==2)
                    {
                        swal('Ups!', '<span>Controlador se encuentra asociado a otro servicio</span>', 'warning');
                        $("#EditarControlador").val("");
                    }
                    else if(response==3)
                    {
                        swal('Ups!', '<span>El commodity programado en el controlador no corresponde al reservado por el cliente</span>', 'warning');
                        $("#EditarControlador").val("");
                    }
                    else
                    {
                        swal('Validado!', '<span>Número controlador válido.</span>', 'success');
                        $(".EditarCelda").show();
                    }
                }
            });
        }else {
            swal('Ups!', '<span>Debe ingresar un dato</span>', 'warning');
            return false;
        }
    });
    //VALIDAR CONTROLADOR

    // NO SE UTILIZA, ANTES ACCIONABA EL BOTON DE VALIDACION TECNICA, CON LA PRIMERA COLUMNA DE CHECKBOX
    //VALIDAR SERVICIOS
    $("#ValidarServicios").click(function () {
        var Bookings = [];
        var Servicios = [];
        var Controladores = [];
        var Commodity = [];
        var Contenedores = [];
        var FechasInicio = [];
        var Estados = [];
        var count = 0;
        var cuenta = $("#Tb_Servicios tbody tr").length;
        var bool = true;

        $("#Tb_Servicios tbody tr").each(function () {
            if ($(this).find(".dt-checkboxes").is(":checked")) {
                var Estado = $(this).find("td:eq(1)").html()
                Estados.push($(this).find("td:eq(1)").html());
                var validar = ValidarEstado(Estados);
                if(validar == 0){
                    Bookings.push($(this).find("td:eq(2)").html());
                    Servicios.push($(this).find("td:eq(16)").html());
                    Controladores.push($(this).find("td:eq(9)").html());
                    Commodity.push($(this).find("td:eq(4)").html());
                    Contenedores.push($(this).find("td:eq(12)").html());
                    FechasInicio.push($(this).find("td:eq(10)").html());
                    bool = true;
                }
                else{
                    Bookings = [];
                    Servicios = [];
                    Controladores = [];
                    Commodity = [];
                    Contenedores = [];
                    FechasInicio = [];
                    Estados = [];
                    swal('Ups!', 'Debe seleccionar solo servicios en viaje.', 'error');
                    bool = false;
                    return false;
                }
            }else{
                count = count + 1;
                if(count == cuenta){
                    Bookings = [];
                    swal('Ups!', 'Debe seleccionar al menos un registro.', 'error');
                    return false;
                }
            }
        });

        if(count != cuenta && bool == true){
            $.ajax({
                type: "POST",
                url: '@Url.Action("ValidarServicio", "Reservas")',
                data: {
                    Bookings : Bookings,
                    Servicios : Servicios,
                    Controladores : Controladores,
                    Commodity : Commodity,
                    Contenedores : Contenedores,
                    FechasInicio : FechasInicio,
                },
                success: function (response) {
                    var json = JSON.parse(response);
                    var datostabla = "";
                    for(var i = 0; i < json.length; i++){
                        if(json[i].Validado == 0){
                            var validado = "Validado";
                        }else{
                            var validado = "No Validado";
                        }
                        datostabla = datostabla +
                            "<tr>" +
                                "<td style='text-align:center'>" + json[i].IdServicio + "</td>" +
                                "<td style='text-align:center'>" + json[i].Bookingaux + "</td>" +
                                "<td style='text-align:center'>" + json[i].Controladoraux + "</td>" +
                                "<td style='text-align:center'>" + json[i].Contenedoraux + "</td>" +
                                "<td style='text-align:center'>" + json[i].Commodityaux + "</td>" +
                                "<td style='text-align:center'>" + json[i].FechaInicioServicioaux + "</td>" +
                                "<td style='text-align:center'>" + validado + "</td>" +
                            "</tr>";
                    }

                    swal({
                        title: 'INFO DE SERVICIOS VALIDADOS',
                        type: 'info',
                        html:
                                "<table class='table table-striped table-bordered display nowrap'>" +
                                        "<tr>" +
                                            "<th>ID SERVICIO</th>" +
                                            "<th>BOOKING</th>" +
                                            "<th>CONTROLADOR</th>" +
                                            "<th>CONTENEDOR</th>" +
                                            "<th>COMMODITY</th>" +
                                            "<th>FECHA</th>" +
                                            "<th>ESTADO</th>" +
                                        "</tr>" + datostabla +
                                "</table>",
                        customClass: 'swal-wide',
                        confirmButtonText: 'Aceptar',
                    }).then((result) => {
                        if (result == true) {
                            location.reload();
                        }
                    })
                },
            });
        }
    });

    //VALIDACION ESTADO SERVICIO
    function ValidarEstado(Estados) {
        var count = Estados.length;
        var i = 0;
        if (count != 0) {
            while (i != count) {
                if (Estados[i] == "ON SERVICE TRIP") {
                    i = i + 1;
                } else {
                    return 1;
                }
            }
            return 0;
        } else {
            return 0;
        }
    }
    //VALIDACION ESTADO SERVICIO

    //VALIDAR MODEM
    $("#ValidarModem").click(function () {
        if ($("#EditarModem").val() != "") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("ValidarModem", "Controlador")',
                data: { Modem: $("#EditarModem").val() },
                success: function (response) {
                    if (response == 0) {
                        swal('Ups!', '<span>Modem no existe en los registros</span>', 'warning');
                        $("#EditarControlador").val("");
                        return false;
                    } else if(response==2) {
                        swal('Ups!', '<span>Modem se encuentra asociado a otro servicio</span>', 'warning');
                        $("#EditarControlador").val("");
                    }else
                    {
                        swal('Validado!', '<span>Número de módem válido.</span>', 'success');
                        $(".EditarCelda").show();
                    }
                }
            });
        }else {
            swal('Ups!', '<span>Debe ingresar un dato</span>', 'warning');
            return false;
        }
    });
    //VALIDAR MODEM

</script>


