
@{
    ViewBag.Title = "GestionarLogisticaSensores";
    Layout = "~/Views/MasterPage.cshtml";
}
<style>
    /* Float four columns side by side */
.column_s {
  float: left;
  width: 25%;
  padding: 0 10px;
}

.column_l {
  float: left;
  width: 75%;
  padding: 0 10px;
}

/* Remove extra left and right margins, due to padding */
.row {margin: 0 -5px;}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}


/* Style the counter cards */
.card {
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
  padding: 16px;
  text-align: center;
  background-color: #f1f1f1;
}
</style>
<div class="col-sm-12">
    <div class="x_panel">
        <form class="form-horizontal">
            <div class="column_s">
                <div class="card">
                    <h1 id="cantidadSensores"></h1>
                </div>
            </div>

            <div class="column_l">
                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                    <label for="TipoNodo" class="control-label tr" key="tiponodo">Tipo Nodo</label>
                    <div>
                        <select class="selectpicker form-control" id="TipoNodo" name="TipoNodo" data-live-search="true"></select>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                    <label for="Pais" class="control-label tr" key="pais">País</label>
                    <div>
                        <select class="selectpicker form-control" id="Pais" name="Pais" data-live-search="true" disabled></select>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                    <label for="Ciudad" class="control-label tr" key="ciudad">Ciudad</label>
                    <div>
                        <select class="selectpicker form-control" id="Ciudad" name="Ciudad" data-live-search="true" disabled></select>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                    <label for="Nodo" class="control-label tr" key="ciudad">Nodo</label>
                    <div>
                        <select class="selectpicker form-control" id="Nodo" name="Nodo" data-live-search="true" disabled></select>
                    </div>
                </div>

                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                    <label for="Marca" class="control-label tr" key="marca">Marca Sensor</label>
                    <div>
                        <select class="selectpicker form-control" id="Marca" name="Marca" data-live-search="true"></select>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-sm-12" style="text-align:center">
                    <label for="Modelo" class="control-label tr" key="modelo">Modelo Sensor</label>
                    <div>
                        <select class="selectpicker form-control" id="Modelo" name="Modelo" data-live-search="true"></select>
                    </div>
                </div>
            </div>

        </form>
        <div class="divider"></div>
        <div class="form-group">
            <div class="col-sm-offset-5 col-sm-6">
                <button type="button" class="btn btn-primary tr" key="filtrar" id="Filtrar" style="margin-bottom: 0px;">Filtrar</button>
                <button type="button" class="btn btn-primary tr" key="limpiar" id="Limpiar" style="margin-bottom: 0px;">Limpiar</button>
            </div>
        </div>
    </div>
    <div class="x_panel">
        <div class="x_panel">
            <div class="col-sm-12 col-md-12 col-lg-12">
                <table id="Tb_Controlador" class="table table-striped table-bordered display nowrap">
                    <thead>
                        <tr>
                            <th class="tr" key="alertatabla">ALERTA</th>
                            <th class="tr" key="idsensortabla">ID SENSOR</th>
                            <th class="tr" key="marcatabla">MARCA</th>
                            <th class="tr" key="modelotabla">MODELO</th>
                            <th class="tr" key="estadologistico">E. LOGISTICO</th>
                            <th class="tr" key="tipolugarorigen">TIPO NODO ORIGEN</th>
                            <th class="tr" key="paisorigen">PAIS NODO ORIGEN</th>
                            <th class="tr" key="ciudadorigen">CIUDAD NODO ORIGEN</th>
                            <th class="tr" key="nodoorigen">NODO ORIGEN</th>
                            <th class="tr" key="tipolugardestino">TIPO NODO DESTINO</th>
                            <th class="tr" key="paisnodo">PAIS NODO DESTINO</th>
                            <th class="tr" key="ciudadnodo">CIUDAD NODO DESTINO</th>
                            <th class="tr" key="nododestino">NODO DESTINO</th>
                            <th class="tr" key="fechavencimiento">FECHA VENC. BATERIA</th>
                        </tr>
                        <tr>
                            <th class="tr" key="alertatabla">ALERTA</th>
                            <th class="tr" key="idsensortabla">ID SENSOR</th>
                            <th class="tr" key="marcatabla">MARCA</th>
                            <th class="tr" key="modelotabla">MODELO</th>
                            <th class="tr" key="estadologistico">E. LOGISTICO</th>
                            <th class="tr" key="tipolugarorigen">TIPO NODO ORIGEN</th>
                            <th class="tr" key="paisorigen">PAIS NODO ORIGEN</th>
                            <th class="tr" key="ciudadorigen">CIUDAD NODO ORIGEN</th>
                            <th class="tr" key="nodoorigen">NODO ORIGEN</th>
                            <th class="tr" key="tipolugardestino">TIPO NODO DESTINO</th>
                            <th class="tr" key="paisnodo">PAIS NODO DESTINO</th>
                            <th class="tr" key="ciudadnodo">CIUDAD NODO DESTINO</th>
                            <th class="tr" key="nododestino">NODO DESTINO</th>
                            <th class="tr" key="fechavencimiento">FECHA VENC. BATERIA</th>
                        </tr>
                    </thead>
                    <tfoot>
                        <tr>
                            <th class="tr" key="alertatabla">1. ALERTA</th>
                            <th class="tr" key="idsensortabla">2. ID SENSOR</th>
                            <th class="tr" key="marcatabla">3. MARCA</th>
                            <th class="tr" key="modelotabla">4. MODELO</th>
                            <th class="tr" key="estadologistico">5. E. LOGISTICO</th>
                            <th class="tr" key="tipolugarorigen">6. TIPO NODO ORIGEN</th>
                            <th class="tr" key="paisorigen">7. PAIS NODO ORIGEN</th>
                            <th class="tr" key="ciudadorigen">8. CIUDAD NODO ORIGEN</th>
                            <th class="tr" key="nodoorigen">9. NODO ORIGEN</th>
                            <th class="tr" key="tipolugardestino">10. TIPO NODO DESTINO</th>
                            <th class="tr" key="paisnodo">11. PAIS NODO DESTINO</th>
                            <th class="tr" key="ciudadnodo">12. CIUDAD NODO DESTINO</th>
                            <th class="tr" key="nododestino">13. NODO DESTINO</th>
                            <th class="tr" key="fechavencimiento">14. FECHA VENC. BATERIA</th>
                        </tr>
                    </tfoot>
                </table>
            </div>
            <div>
            </div>
            <div class="row">
                <div class="col-lg-5">
                    <form class="form-inline">
                        <div class="form-group">
                            @*<label for="IdControlador" class="control-label tr" key="numerocontroladoresseleccionados">N° Controladores seleccionados</label>*@
                            @*<input type="text" class="input form-control" id="IdControlador" disabled="disabled" style="text-align:center; text-align-last:center;" />*@
                        </div>

                    </form>
                </div>
            </div>
            <div class="divider"></div>
            <div class="row">
                <div class="col-lg-8 col-lg-offset-4" id="Botones">
                    <button type="button" class="btn btn-primary tr" id="AgregarSensor" key="BotonLogistica" style="margin-bottom: 0px;">Agregar Sensor</button>
                    <button type="button" class="btn btn-primary tr" id="AgregarMovLogistico" key="BotonRecuperacion" style="margin-bottom: 0px;">Agregar Mov. Logistico</button>
                </div>
            </div>
        </div>
    </div>

    <!--Modal para Agregar Mov. Logistico Sensor-->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="margin-left:80px; margin-right:10px;">
        <div class="modal-dialog" role="document" style="width:100%">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title tr" id="myModalLabel" key="titulologisticacontrolador"> Agregar Movimiento Logistico a Sensor</h4>
                </div>
                <div class="modal-body">
                    <div id="Log_ingreso">
                        <div class="x_panel">
                            <table id="Tb_Ingreso" class="table table-striped table-bordered display nowrap">
                                <thead>
                                    <tr>
                                        <th class="tr" key="">ID SENSOR</th>
                                        <th class="tr" key="">MARCA</th>
                                        <th class="tr" key="">MODELO</th>
                                        <th class="tr" key="">TIPO NODO ORIGEN</th>
                                        <th class="tr" key="">NODO ORIGEN</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                        <div class="x_panel">
                            <form class="form-horizontal">
                                <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                    <div class="col-lg-1 col-md-1 col-sm-1 ">
                                        <label id="lb_id" class="control-label tr" key="tiponodoingreso">Tipo Nodo Destino (*)</label>
                                    </div>
                                    <div class="col-md-3 col-sm-3 col-xs-3">
                                        <select class="selectpicker form-control" id="TipoNodoAgregar" name="TipoNodoAgregar" data-live-search="true"></select>
                                    </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <label id="lb_id" class="control-label tr" key="paisingreso">Pais Destino</label>
                                    </div>
                                    <div class="col-md-3 col-sm-3 col-xs-3">
                                        <select class="selectpicker form-control" id="PaisAgregar" name="PaisAgregar" data-live-search="true" disabled></select>
                                    </div>
                                </div>

                                <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <label id="lb_id" class="control-label tr" key="ciudadingreso">Ciudad Destino </label>
                                    </div>
                                    <div class="col-md-3 col-sm-3 col-xs-3">
                                        <select class="selectpicker form-control" id="CiudadAgregar" name="CiudadAgregar" data-live-search="true" disabled></select>
                                    </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <label id="lb_id" class="control-label tr" key="nodoingreso">Nodo (*)</label>
                                    </div>
                                    <div class="col-md-3 col-sm-3 col-xs-3">
                                        <select class="selectpicker form-control" id="NodoAgregar" name="NodoAgregar" data-live-search="true" disabled></select>
                                    </div>
                                </div>

                            </form>
                        </div>
                    </div>
            </div>
                <div class="modal-footer" id="div_botones_ingreso">
                    <button type="button" class="btn btn-success tr" id="Guardar_ingreso" key="botonguardarlogistica">Guardar</button>
                    <button type="button" class="btn btn-danger tr" data-dismiss="modal" key="botoncancelarlogistica">Cancelar</button>
                </div>
        </div>
    </div>
</div>
    <!--Modal para Agregar Mov. Logistico Sensor-->

    <!--Modal para Agregar Sensor-->
    <div class="modal fade" id="myModal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="margin-left:80px; margin-right:10px;">
        <div class="modal-dialog" role="document" style="width:100%">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title tr" id="myModalLabel" key="titulologisticacontrolador"> Agregar Sensor Externo</h4>
                </div>
                <div class="modal-body">
                    <div id="Log_ingreso">
                        <div class="x_panel">
                            <form class="form-horizontal">
                                <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <label id="lb_id" class="control-label tr" key="tiponodoingreso">Marca (*)</label>
                                    </div>
                                    <div class="col-md-3 col-sm-3 col-xs-3">
                                        <select class="selectpicker form-control" id="MarcaAgregar" name="MarcaAgregar" data-live-search="true"></select>
                                    </div>
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <label id="lb_id" class="control-label tr" key="paisingreso">Modelo (*)</label>
                                    </div>
                                    <div class="col-md-3 col-sm-3 col-xs-3">
                                        <select class="selectpicker form-control" id="ModeloAgregar" name="ModeloAgregar" data-live-search="true"></select>
                                    </div>
                                </div>

                                <div class="col-lg-12 col-md-12 col-sm-12 form-group">
                                    <div class="col-lg-1 col-md-1 col-sm-1">
                                        <label id="lb_id" class="control-label tr" key="ciudadingreso">Numero de Serie (*)</label>
                                    </div>
                                    <div class="col-md-3 col-sm-3 col-xs-3">
                                        <input type="text" class="input form-control" id="NumeroSensorAgregar" />
                                    </div>
                                </div>

                            </form>
                        </div>
                    </div>



                </div>
                <div class="modal-footer" id="div_botones_ingreso">
                    <button type="button" class="btn btn-success tr" id="Guardar_sensor" key="botonguardarlogistica">Guardar</button>
                    <button type="button" class="btn btn-danger tr" data-dismiss="modal" key="botoncancelarlogistica">Cancelar</button>
                </div>
            </div>
        </div>

    </div>
    <!--Modal para Agregar Sensor-->

<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal2" id="AgregarSensorTrigger" style="display:none;"></button>
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal" id="AgregarMovLogisticoTrigger" style="display:none;"></button>

<!--Modal para Logistica Controlador-->

<script src="~/build/js/Perfiles.js"></script>
<script src="~/build/js/PerfilGestionControlador.js"></script>
<script type="text/javascript">

    var lenguaje = document.cookie;

    $(document).ready(function () {

        $('#Tb_Controlador thead tr:eq(1) th').each(function (i) {
            var title = $('#example thead tr:eq(0) th').eq($(this).index()).text();

                $(this).html('<input type="text" class="form-control" placeholder="FILTER" data-index="' + i + '"/>');
        });

        var table = $("#Tb_Controlador").DataTable({
            initComplete: function () {
                this.api().columns().every(function () {
                    var column = this;
                    if (column.index() == 0) {
                        //alert(column.index());

                        var select = $('<select><option value=""></option></select>')
                            .appendTo($(column.footer()).empty())
                            .on('change', function () {
                                var val = $.fn.dataTable.util.escapeRegex(
                                    $(this).val()
                                );

                                column
                                    .search(val ? '^' + val + '$' : '', true, false)
                                    .draw();
                            });

                        column.data().unique().sort().each(function (d, j) {
                            select.append('<option value="' + d + '">' + d + '</option>')
                        });
                    }
                });
            },
            orderCellsTop: true,
            fixedColumns: true,
            scrollX: true,
            order: false,
            pageLength: 15,
            ajax: {
                "url": "@Url.Action("GetSensores", "Sensor")",
                "dataSrc": ''
            },
            dom: 'Bfrtip',
            buttons: [
                'excel'
            ],
            "rowCallback": function (row, data, index) {
                if (data.Alerta != "") {
                    $('td', row).css("background-color", "rgba(255, 0, 0, 0.4);"); //ROJO
                }
            },
            columns: [
                { "data": "Alerta" },
                { "data": "NumeroSerie" },
                { "data": "Marca" },
                { "data": "Modelo" },
                { "data": "EstadoLogistico" },
                { "data": "TipoNodoOrigen" },
                 { "data": "PaisOrigen" },
                { "data": "CiudadOrigen" },
                { "data": "NodoOrigen" },
                { "data": "TipoNodoDestino" },
                { "data": "PaisDestino" },
                { "data": "CiudadDestino" },
                { "data": "NodoDestino" },
                {
                    "data": "FechaVencimiento",
                    "render":
                    function (data, type, row, meta) {
                        if (data != null) {
                            var fecha = FormatDate(data);
                            return fecha;
                        } else {
                            return "";
                        }
                    }
                },
            ],
            
        });

        $(table.table().container()).on('keyup', 'thead input', function () {
            table
                .column($(this).data('index'))
                .search(this.value)
                .draw();
        });

        $('#Tb_Controlador tbody').on('click', 'tr', function () {
            $(this).toggleClass('selected');
            $('#IdControlador').text(table.rows('.selected').data().length);
            //$('#IdControlador').text(table.rows().data().length);
            
        });

        table.on('draw', function (data) {
            $('#cantidadSensores').text(table.page.info().recordsDisplay);
        });


        //OBTENER TIPO LUGARES
        $.ajax({
            type: "POST",
            url: '@Url.Action("GetTipoLugares", "TipoLugar")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                var optionsAsString = "";
                optionsAsString += "<option value='0'>Seleccione un Tipo de Nodo</option>";
                $("select[name=TipoNodo]").empty();
                for (var i = 0; i < cuenta; i++) {
                    optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                }
                $("select[name=TipoNodo]").append(optionsAsString);
                $("select[name=TipoNodo]").removeAttr('disabled');
                $("select[name=TipoNodo]").selectpicker("refresh");
            },
        });
        //OBTENER TIPO LUGARES

        $("select[name=TipoNodo]").change(function () {

            $.ajax({
                type: "POST",
                url: '@Url.Action("GetPaisesActivos", "Paises")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione un Pais</option>";
                    $("select[name=Pais]").empty();
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                    }
                    $("select[name=Pais]").append(optionsAsString);
                    $("select[name=Pais]").removeAttr('disabled');
                    $("select[name=Pais]").selectpicker("refresh");
                },
            });

            $.ajax({
                type: "POST",
                url: '@Url.Action("GetCiudadesActivas", "Ciudad")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione una Ciudad</option>";
                    $("select[name=Ciudad]").empty();
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                    }
                    $("select[name=Ciudad]").append(optionsAsString);
                    $("select[name=Ciudad]").removeAttr('disabled');
                    $("select[name=Ciudad]").selectpicker("refresh");
                },
            });

            $("select[name=NodoSalida]").removeAttr('disabled');
            $("select[name=NodoSalida]").selectpicker('refresh');

            if ($("select[name=TipoNodo]").val() == "0") {

                $("select[name=Ciudad]").attr('disabled', 'disabled');
                $("select[name=Ciudad]").val("0");
                $("select[name=Ciudad]").selectpicker('refresh');
                $("select[name=Nodo]").attr('disabled', 'disabled');
                $("select[name=Nodo]").val("0");
                $("select[name=Nodo]").selectpicker('refresh');

            } else if ($("select[name=TipoNodo]").val() == "1") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetDepositosActivos", "Deposito")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Deposito</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").removeAttr('disabled');
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=TipoNodo]").val() == "2") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPackingActivos", "Packing")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Packing</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").removeAttr('disabled');
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=TipoNodo]").val() == "3") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetAntePuertosActivos", "Antepuerto")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Antepuerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").removeAttr('disabled');
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=TipoNodo]").val() == "4") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertos", "Puertos")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").removeAttr('disabled');
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=TipoNodo]").val() == "5") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertos", "Puertos")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").removeAttr('disabled');
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=TipoNodo]").val() == "6") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetBodegas", "Bodega")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Bodega</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").removeAttr('disabled');
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            }
        });


        $("select[name=Pais]").change(function () {

            if ($("select[name=Pais]").val() == "0") {

                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetCiudadesActivas", "Ciudad")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        var optionsAsString = "";
                        $("select[name=Ciudad]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Ciudad</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=Ciudad]").append(optionsAsString);
                        $("select[name=Ciudad]").selectpicker('refresh');
                    },
                });

                if ($("select[name=TipoNodo]").val() == "1") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetDepositosActivos", "Deposito")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $("select[name=Nodo]").empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Deposito</option>";
                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $("select[name=Nodo]").append(optionsAsString);
                            $("select[name=Nodo]").selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "2") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPackingActivos", "Packing")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $("select[name=Nodo]").empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Packing</option>";
                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $("select[name=Nodo]").append(optionsAsString);
                            $("select[name=Nodo]").selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "3") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetAntePuertosActivos", "Antepuerto")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $("select[name=Nodo]").empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Antepuerto</option>";
                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $("select[name=Nodo]").append(optionsAsString);
                            $("select[name=Nodo]").selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "4") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPuertos", "Puertos")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $("select[name=Nodo]").empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $("select[name=Nodo]").append(optionsAsString);
                            $("select[name=Nodo]").selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "5") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPuertos", "Puertos")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $("select[name=Nodo]").empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $("select[name=Nodo]").append(optionsAsString);
                            $("select[name=Nodo]").selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "6") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetBodegas", "Bodega")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $("select[name=Nodo]").empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Bodega</option>";
                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $("select[name=Nodo]").append(optionsAsString);
                            $("select[name=Nodo]").selectpicker('refresh');
                        },
                    });
                }
            } else {

                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetCiudadesPais", "Ciudad")',
                    data: { IdPais: $("select[name=Pais]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        var optionsAsString = "";
                        $('select[name=Ciudad]').empty();
                        optionsAsString += "<option value='0'>Seleccione una Ciudad</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }
                        $('select[name=Ciudad]').append(optionsAsString);
                        $('select[name=Ciudad]').selectpicker('refresh');
                    },
                });

                if ($("select[name=TipoNodo]").val() == "1") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetDepositoPais", "Deposito")',
                        data: { IdPais: $("select[name=Pais]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione un Deposito</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "2") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPackingsPais", "Packing")',
                        data: { IdPais: $("select[name=Pais]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione un Packing</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "3") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetAntePuertoPais", "Antepuerto")',
                        data: { IdPais: $("select[name=Pais]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione un Antepuerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "4") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPuertosOrigenPais", "Puertos")',
                        data: { IdPais: $("select[name=Pais]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "5") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPuertosDestinoPais", "Puertos")',
                        data: { IdPais: $("select[name=Pais]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "6") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetBodegasPais", "Bodega")',
                        data: { IdPais: $("select[name=Pais]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione una Bodega</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                }
            }
        });

        $("select[name=Ciudad]").change(function () {
            if ($("select[name=Ciudad]").val() == "0") {
                if ($("select[name=TipoNodo]").val() == "1") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetDepositosActivos", "Deposito")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Deposito</option>";
                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }
                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "2") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPackingActivos", "Packing")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Packing</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "3") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetAntePuertosActivos", "Antepuerto")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Antepuerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }
                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "4") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPuertos", "Puertos")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }
                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "5") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPuertos", "Puertos")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }
                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "6") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetBodegas", "Bodega")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Bodega</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }
                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                }
            } else {
                if ($("select[name=TipoNodo]").val() == "1") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetDepositoCiudad", "Deposito")',
                        data: { IdCiudad: $("select[name=Ciudad]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione un Deposito</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "2") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPackingsCiudad", "Packing")',
                        data: { IdCiudad: $("select[name=Ciudad]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione un Packing</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "3") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetAntePuertoCiudad", "Antepuerto")',
                        data: { IdCiudad: $("select[name=Ciudad]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione un Antepuerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "4") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPuertosOrigenCiudad", "Puertos")',
                        data: { IdCiudad: $("select[name=Ciudad]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "5") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPuertosDestinoCiudad", "Puertos")',
                        data: { IdCiudad: $("select[name=Ciudad]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodo]").val() == "6") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetBodegasCiudad", "Bodega")',
                        data: { IdCiudad: $("select[name=Ciudad]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Bodega</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=Nodo]').append(optionsAsString);
                            $('select[name=Nodo]').selectpicker('refresh');
                        },
                    });
                }
            }
        });

        $("select[name=Nodo]").change(function () {
            if ($("select[name=TipoNodo]").val() == "1") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetInfoDeposito", "Deposito")',
                    data: { IdDeposito: $("select[name=Nodo]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        if (cuenta != 0) {
                            $("select[name=Pais]").val(json[0].IdPais);
                            $("select[name=Pais]").selectpicker('refresh');
                            $("select[name=Ciudad]").val(json[0].IdCiudad);
                            $("select[name=Ciudad]").selectpicker('refresh');
                        }
                    },
                });
            } else if ($("select[name=TipoNodo]").val() == "2") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetInfoPacking", "Packing")',
                    data: { IdPacking: $("select[name=Nodo]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        if (cuenta != 0) {
                            $("select[name=Pais]").val(json[0].IdPais);
                            $("select[name=Pais]").selectpicker('refresh');
                            $("select[name=Ciudad]").val(json[0].IdCiudad);
                            $("select[name=Ciudad]").selectpicker('refresh');
                        }
                    },
                });
            } else if ($("select[name=TipoNodo]").val() == "3") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetInfoAntepuerto", "Antepuerto")',
                    data: { IdAntepuerto: $("select[name=Nodo]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        if (cuenta != 0) {
                            $("select[name=Pais]").val(json[0].IdPais);
                            $("select[name=Pais]").selectpicker('refresh');
                            $("select[name=Ciudad]").val(json[0].IdCiudad);
                            $("select[name=Ciudad]").selectpicker('refresh');
                        }
                    },
                });
            } else if ($("select[name=TipoNodo]").val() == "4") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetInfoPuertoOrigen", "Puertos")',
                    data: { IdPuertoOrigen: $("select[name=Nodo]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        if (cuenta != 0) {
                            $("select[name=Pais]").val(json[0].IdPais);
                            $("select[name=Pais]").selectpicker('refresh');
                            $("select[name=Ciudad]").val(json[0].IdCiudad);
                            $("select[name=Ciudad]").selectpicker('refresh');
                        }
                    },
                });
            } else if ($("select[name=TipoNodo]").val() == "6") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetInfoBodega", "Bodega")',
                    data: { IdBodega: $("select[name=Nodo]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        if (cuenta != 0) {
                            $("select[name=Pais]").val(json[0].IdPais);
                            $("select[name=Pais]").selectpicker('refresh');
                            $("select[name=Ciudad]").val(json[0].IdCiudad);
                            $("select[name=Ciudad]").selectpicker('refresh');
                        }
                    },
                });
            }
        });

         $.ajax({
            type: "POST",
            url: '@Url.Action("GetMarcaSensor", "Sensor")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                $('select[name=Marca]').empty();
                var optionsAsString = "";
                optionsAsString += "<option value='0'>Seleccione Marca</option>";
                for (var i = 0; i < cuenta; i++) {
                    optionsAsString += "<option value='" + json[i].IdMarca + "'>" + json[i].Nombre + "</option>";
                }

                $('select[name=Marca]').append(optionsAsString);
                $('select[name=Marca]').selectpicker('refresh');
             },
          });

        $.ajax({
            type: "POST",
            url: '@Url.Action("GetModeloSensor", "Sensor")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                $('select[name=Modelo]').empty();
                var optionsAsString = "";
                optionsAsString += "<option value='0'>Seleccione Modelo</option>";
                for (var i = 0; i < cuenta; i++) {
                    optionsAsString += "<option value='" + json[i].IdModelo + "'>" + json[i].Nombre + "</option>";
                }

                $('select[name=Modelo]').append(optionsAsString);
                $('select[name=Modelo]').selectpicker('refresh');
            },
        });

    });

    $("#Guardar_ingreso").click(function () {
        var tableIngreso = $('#Tb_Ingreso').DataTable();
        var InfoIngreso = tableIngreso.rows().data();
        if (InfoIngreso.length != 0) {

            if ($("#TipoNodoAgregar").val() == "0") {
                $("button[data-id=TipoNodoAgregar]").css("background", "rgba(255, 0, 0, 0.4)");
                return false;
            } else {
                $("button[data-id=TipoNodoAgregar]").css("background", "rgba(255, 0, 0, 0)");
            }

            if ($("#NodoAgregar").val() == "0") {
                $("button[data-id=NodoAgregar]").css("background", "rgba(255, 0, 0, 0.4)");
                return false;
            } else {
                $("button[data-id=NodoAgregar]").css("background", "rgba(255, 0, 0, 0)");
            }

            var contControllers = 0;
            var contModems = 0;
            var msge = "";
            var Controladores = [];

                swal({
                    title: 'Estas seguro?',
                    text: '',
                    type: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Si'
                }).then((result) => {
                    for (var i = 0; i < InfoIngreso.length ; i++) {
                        $.ajax({
                            type: "POST",
                            url: '@Url.Action("AgregarMovSensor", "Sensor")',
                            data: {
                                NumeroSerie: InfoIngreso[i][0],
                                TipoNodoDestino: $("#TipoNodoAgregar").val(),
                                NodoDestino: $("#NodoAgregar").val()
                            },
                            success: function (response) {
                                var json = JSON.parse(response);
                                if (json.validador == 0) {
                                    var aux = 'success';
                                } else {
                                    var aux = 'warning';
                                }
                                swal({
                                    title: '',
                                    text: json.Mensaje,
                                    type: aux,
                                    showCancelButton: false,
                                    confirmButtonColor: '#3085d6',
                                    cancelButtonColor: '#d33',
                                    confirmButtonText: 'Aceptar'
                                }).then((result) => {

                                    location.reload();
                                })
                            }
                        });
                    }
                });

        } else {
            swal('Ups!', '<span class="alerta" key="errorsensorlogistica">Debe seleccionar al menos un sensor.</span>', 'error');
        }
    });

    function FormatDate(data) {
        var dateString = data.substr(6);
        var currentTime = new Date(parseInt(dateString));
        var month = currentTime.getMonth() + 1;
        var day = currentTime.getDate();
        var year = currentTime.getFullYear();

        if (month < 10) {
            month = "0" + month;
        } else {
            month;
        }

        if (day < 10) {
            day = "0" + day;
        } else {
            day;
        }

        var date = day + "-" + month + "-" + year;
        return date;
    }

    function FormatDateDias(data) {
        if (data == null) {
            return 2;
        }

        var dateString = data.substr(6);
        var currentTime = new Date(parseInt(dateString));

        var month = currentTime.getMonth() + 1;
        var day = currentTime.getDate();
        var year = currentTime.getFullYear();

        if (month < 10) {
            month = "0" + month;
        } else {
            month;
        }

        if (day < 10) {
            day = "0" + day;
        } else {
            day;
        }

        var date = year + "-" + month + "-" + day;

        var today = new Date();
        var dd = today.getDate();
        var mm = today.getMonth() + 1; //January is 0!

        var yyyy = today.getFullYear();
        if (dd < 10) {
            dd = '0' + dd;
        }
        if (mm < 10) {
            mm = '0' + mm;
        }
        var today = yyyy + '-' + mm + '-' + dd;

        var date1 = new Date(date);
        var date2 = new Date(today);
        var timeDiff = Math.abs(date2.getTime() - date1.getTime());
        var diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));

        if (diffDays > 15) {
            return 0;
        } else {
            return 1;
        }
    }



    $("select[name=Tipo_nodo]").change(function () {
        $.ajax({
            type: "POST",
            url: '@Url.Action("GetContinentes", "Continente")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                var optionsAsString = "";
                optionsAsString += "<option value='0'>Seleccione un Continente</option>";
                $("select[name=Continente]").empty();
                for (var i = 0; i < cuenta; i++) {
                    optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                }
                $("select[name=Continente]").append(optionsAsString);
                $("select[name=Continente]").removeAttr('disabled');
                $("select[name=Continente]").selectpicker("refresh");
            },
        });

        $.ajax({
            type: "POST",
            url: '@Url.Action("GetPaisesActivos", "Paises")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                var optionsAsString = "";
                optionsAsString += "<option value='0'>Seleccione un Pais</option>";
                $("select[name=Pais]").empty();
                for (var i = 0; i < cuenta; i++) {
                    optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                }
                $("select[name=Pais]").append(optionsAsString);
                $("select[name=Pais]").removeAttr('disabled');
                $("select[name=Pais]").selectpicker("refresh");
            },
        });

        $.ajax({
            type: "POST",
            url: '@Url.Action("GetCiudadesActivas", "Ciudad")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                var optionsAsString = "";
                optionsAsString += "<option value='0'>Seleccione una Ciudad</option>";
                $("select[name=Ciudad]").empty();
                for (var i = 0; i < cuenta; i++) {
                    optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                }
                $("select[name=Ciudad]").append(optionsAsString);
                $("select[name=Ciudad]").removeAttr('disabled');
                $("select[name=Ciudad]").selectpicker("refresh");
            },
        });

        $("select[name=Nodo]").removeAttr('disabled');
        $("select[name=Nodo]").selectpicker('refresh');

        if ($("select[name=Tipo_nodo]").val() == "0") {

            $("select[name=Continente]").attr('disabled', 'disabled');
            $("select[name=Continente]").val("0");
            $("select[name=Continente]").selectpicker('refresh');
            $("select[name=Pais]").attr('disabled', 'disabled');
            $("select[name=Pais]").val("0");
            $("select[name=Pais]").selectpicker('refresh');
            $("select[name=Ciudad]").attr('disabled', 'disabled');
            $("select[name=Ciudad]").val("0");
            $("select[name=Ciudad]").selectpicker('refresh');
            $("select[name=Nodo]").attr('disabled', 'disabled');
            $("select[name=Nodo]").val("0");
            $("select[name=Nodo]").selectpicker('refresh');

        } else if ($("select[name=Tipo_nodo]").val() == "1") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetDepositosActivos", "Deposito")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=Nodo]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Deposito</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                    }

                    $("select[name=Nodo]").append(optionsAsString);
                    $("select[name=Nodo]").selectpicker('refresh');
                },
            });
        } else if ($("select[name=Tipo_nodo]").val() == "2") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetPackingActivos", "Packing")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=Nodo]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Packing</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre +"</option>";
                    }

                    $("select[name=Nodo]").append(optionsAsString);
                    $("select[name=Nodo]").selectpicker('refresh');
                },
            });
        } else if ($("select[name=Tipo_nodo]").val() == "3") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetAntePuertosActivos", "Antepuerto")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=Nodo]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Antepuerto</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                    }

                    $("select[name=Nodo]").append(optionsAsString);
                    $("select[name=Nodo]").selectpicker('refresh');
                },
            });
        } else if ($("select[name=Tipo_nodo]").val() == "4") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetPuertos", "Puertos")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=Nodo]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre +"</option>";
                    }

                    $("select[name=Nodo]").append(optionsAsString);
                    $("select[name=Nodo]").selectpicker('refresh');
                },
            });
        } else if ($("select[name=Tipo_nodo]").val() == "5") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetPuertos", "Puertos")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=Nodo]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre +"</option>";
                    }

                    $("select[name=Nodo]").append(optionsAsString);
                    $("select[name=Nodo]").selectpicker('refresh');
                },
            });
        } else if ($("select[name=Tipo_nodo]").val() == "6") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetBodegas", "Bodega")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    $("select[name=Nodo]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Bodega</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                    }

                    $("select[name=Nodo]").append(optionsAsString);
                    $("select[name=Nodo]").selectpicker('refresh');
                },
            });
        }
    });

    $("select[name=Continente]").change(function () {
        if ($("select[name=Continente]").val() == "0") {
            $('#Pais').attr('disabled', 'disabled');
            $('#Pais').val("0");
            $('#Pais').selectpicker('refresh');
            $('#Ciudad').attr('disabled', 'disabled');
            $('#Ciudad').val("0");
            $('#Ciudad').selectpicker('refresh');
            $('#Nodo').attr('disabled', 'disabled');
            $('#Nodo').val("0");
            $('#Nodo').selectpicker('refresh');
        } else {
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetPaisesContinente", "Paises")',
                data: { IdContinente: $("select[name=Continente]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    $("select[name=Pais]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Pais</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                    }

                    $("select[name=Pais]").append(optionsAsString);
                    $("select[name=Pais]").selectpicker('refresh');
                },
            });

            $.ajax({
                type: "POST",
                url: '@Url.Action("GetCiudadesContinente", "Ciudad")',
                data: { IdContinente: $("select[name=Continente]").val() },
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    $("select[name=Ciudad]").empty();
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione Ciudad</option>";
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre +"</option>";
                    }

                    $("select[name=Ciudad]").append(optionsAsString);
                    $("select[name=Ciudad]").selectpicker('refresh');
                },
            });

             if ($("#Tipo_nodo").val() == "1") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetDepositoContinente", "Deposito")',
                    data: { IdContinente: $("select[name=Continente]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Deposito</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre +"</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("#Tipo_nodo").val() == "2") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPackingsContinente", "Packing")',
                    data: { IdContinente: $("select[name=Continente]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Packing</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("#Tipo_nodo").val() == "3") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetAntePuertoContinente", "Antepuerto")',
                    data: { IdContinente: $("select[name=Continente]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Antepuerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("#Tipo_nodo").val() == "4") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertosOrigenContinente", "Puertos")',
                    data: { IdContinente: $("select[name=Continente]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre +"</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("#Tipo_nodo").val() == "5") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertosDestinoContinente", "Puertos")',
                    data: { IdContinente: $("select[name=Continente]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione ¨Puerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            } else if ($("#Tipo_nodo").val() == "6") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetBodegasaContinente", "Bodega")',
                    data: { IdContinente: $("select[name=Continente]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=Nodo]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Bodega</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=Nodo]").append(optionsAsString);
                        $("select[name=Nodo]").selectpicker('refresh');
                    },
                });
            }
        }
    });


   $("#Guardar_sensor").click(function () {

            // Validar datos obligatorios
            if ($("select[name=MarcaAgregar]").val() == "0") {
                $("button[data-id=MarcaAgregar]").css("background", "rgba(255, 0, 0, 0.4)");
                return false;
            } else {
                $("button[data-id=MarcaAgregar]").css("background", "rgba(255, 0, 0, 0)");
            }

            if ($("select[name=NumeroSensorAgregar]").val() == "") {
                $("#NumeroSensorAgregar").css("background", "rgba(255, 0, 0, 0.4)");
                return false;
            } else {
                $("#NumeroSensorAgregar").css("background", "rgba(255, 0, 0, 0)");
            }
            if ($("select[name=ModeloAgregar]").val() == "0") {
                $("button[data-id=ModeloAgregar]").css("background", "rgba(255, 0, 0, 0.4)");
                return false;
            } else {
                $("button[data-id=ModeloAgregar]").css("background", "rgba(255, 0, 0, 0)");
            }
                        $.ajax({
                            type: "POST",
                            url: '@Url.Action("AgregarSensor", "Sensor")',
                            data: {
                                NumeroSerie: $("#NumeroSensorAgregar").val(),
                                Marca: $("#MarcaAgregar").val(),
                                Modelo: $("#ModeloAgregar").val(),
                            },
                            success: function (response) {
                                var json = JSON.parse(response);
                                if (json.validador == 0) {
                                    var aux = 'success';
                                } else {
                                    var aux = 'warning';
                                }
                                swal({
                                    title: '',
                                    text: json.Mensaje,
                                    type: aux,
                                    showCancelButton: false,
                                    confirmButtonColor: '#3085d6',
                                    cancelButtonColor: '#d33',
                                    confirmButtonText: 'Aceptar'
                                }).then((result) => {

                                    location.reload();

                                })
                            }
                        });
    });


    $("#AgregarSensor").click(function () {

        $.ajax({
            type: "POST",
            url: '@Url.Action("GetMarcaSensor", "Sensor")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                $('select[name=MarcaAgregar]').empty();
                var optionsAsString = "";
                optionsAsString += "<option value='0'>Seleccione Marca</option>";
                for (var i = 0; i < cuenta; i++) {
                    optionsAsString += "<option value='" + json[i].IdMarca + "'>" + json[i].Nombre + "</option>";
                }

                $('select[name=MarcaAgregar]').append(optionsAsString);
                $('select[name=MarcaAgregar]').selectpicker('refresh');
            },
        });

        $.ajax({
            type: "POST",
            url: '@Url.Action("GetModeloSensor", "Sensor")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                $('select[name=ModeloAgregar]').empty();
                var optionsAsString = "";
                optionsAsString += "<option value='0'>Seleccione Modelo</option>";
                for (var i = 0; i < cuenta; i++) {
                    optionsAsString += "<option value='" + json[i].IdModelo + "'>" + json[i].Nombre + "</option>";
                }

                $('select[name=ModeloAgregar]').append(optionsAsString);
                $('select[name=ModeloAgregar]').selectpicker('refresh');
            },
        });

        $("#EtaSalida, #Fecha_real_envioSalida,#Fecha_real_envioIngreso, #Fecha_real_arriboSalida, #Fecha_recupera, #Fecha_real_arriboIngreso, #Fecharealrecuperacion, #FecharealrecuperacionIngreso").datepicker({
            dateFormat: "dd-mm-yy",
            firstDay: 1,
            dayNamesMin: ["Do", "Lu", "Ma", "Mi", "Ju", "Vi", "Sa"],
            dayNamesShort: ["Dom", "Lun", "Mar", "Mie", "Jue", "Vie", "Sab"],
            monthNames:
                ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio",
                "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
            monthNamesShort:
                ["Ene", "Feb", "Mar", "Abr", "May", "Jun",
                "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"],
            showWeek: true
        });

        $('#AgregarSensorTrigger').trigger('click');
    });

    $("#AgregarMovLogistico").click(function () {

        var tableControlador = $('#Tb_Controlador').DataTable();

        var Info = tableControlador.rows('.selected').data();
        var dataIngreso = [];

        for (var i = 0; i < Info.length ; i++) {
            dataIngreso.push([Info[i]["NumeroSerie"], Info[i]["Marca"], Info[i]["Modelo"], Info[i]["EstadoLogistico"],
                                 Info[i]["TipoNodoOrigen"], Info[i]["NodoOrigen"]]);
        }

        var tableIngreso = $('#Tb_Ingreso').DataTable();
        tableIngreso.destroy();

        var tableIngreso = $('#Tb_Ingreso').DataTable({
            data: dataIngreso,
        });

        $("#EtaSalida, #Fecha_real_envioSalida,#Fecha_real_envioIngreso, #Fecha_real_arriboSalida, #Fecha_recupera, #Fecha_real_arriboIngreso, #Fecharealrecuperacion, #FecharealrecuperacionIngreso").datepicker({
            dateFormat: "dd-mm-yy",
            firstDay: 1,
            dayNamesMin: ["Do", "Lu", "Ma", "Mi", "Ju", "Vi", "Sa"],
            dayNamesShort: ["Dom", "Lun", "Mar", "Mie", "Jue", "Vie", "Sab"],
            monthNames:
                ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio",
                "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
            monthNamesShort:
                ["Ene", "Feb", "Mar", "Abr", "May", "Jun",
                "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"],
            showWeek: true
        });

        //OBTENER TIPO LUGARES
        $.ajax({
            type: "POST",
            url: '@Url.Action("GetTipoLugares", "TipoLugar")',
            success: function (response) {
                var data = [];
                var json = JSON.parse(response);
                var cuenta = json.length;
                var optionsAsString = "";
                optionsAsString += "<option value='0'>Seleccione un Tipo de Nodo</option>";
                $("select[name=TipoNodoAgregar]").empty();
                for (var i = 0; i < cuenta; i++) {
                    optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                }
                $("select[name=TipoNodoAgregar]").append(optionsAsString);
                $("select[name=TipoNodoAgregar]").removeAttr('disabled');
                $("select[name=TipoNodoAgregar]").selectpicker("refresh");
            },
        });
        //OBTENER TIPO LUGARES


        $("select[name=TipoNodoAgregar]").change(function () {

            $.ajax({
                type: "POST",
                url: '@Url.Action("GetPaisesActivos", "Paises")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione un Pais</option>";
                    $("select[name=PaisAgregar]").empty();
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                    }
                    $("select[name=PaisAgregar]").append(optionsAsString);
                    $("select[name=PaisAgregar]").removeAttr('disabled');
                    $("select[name=PaisAgregar]").selectpicker("refresh");
                },
            });

            $.ajax({
                type: "POST",
                url: '@Url.Action("GetCiudadesActivas", "Ciudad")',
                success: function (response) {
                    var data = [];
                    var json = JSON.parse(response);
                    var cuenta = json.length;
                    var optionsAsString = "";
                    optionsAsString += "<option value='0'>Seleccione una Ciudad</option>";
                    $("select[name=CiudadAgregar]").empty();
                    for (var i = 0; i < cuenta; i++) {
                        optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                    }
                    $("select[name=CiudadAgregar]").append(optionsAsString);
                    $("select[name=CiudadAgregar]").removeAttr('disabled');
                    $("select[name=CiudadAgregar]").selectpicker("refresh");
                },
            });

            $("select[name=NodoAgregar]").removeAttr('disabled');
            $("select[name=NodoAgregar]").selectpicker('refresh');

            if ($("select[name=TipoNodoAgregar]").val() == "0") {

                $("select[name=CiudadAgregar]").attr('disabled', 'disabled');
                $("select[name=CiudadAgregar]").val("0");
                $("select[name=CiudadAgregar]").selectpicker('refresh');
                $("select[name=NodoAgregar]").attr('disabled', 'disabled');
                $("select[name=NodoAgregar]").val("0");
                $("select[name=NodoAgregar]").selectpicker('refresh');

            } else if ($("select[name=TipoNodoAgregar]").val() == "1") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetDepositosActivos", "Deposito")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoAgregar]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Deposito</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=NodoAgregar]").append(optionsAsString);
                        $("select[name=NodoAgregar]").removeAttr('disabled');
                        $("select[name=NodoAgregar]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=TipoNodoAgregar]").val() == "2") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPackingActivos", "Packing")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoAgregar]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Packing</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=NodoAgregar]").append(optionsAsString);
                        $("select[name=NodoAgregar]").removeAttr('disabled');
                        $("select[name=NodoAgregar]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=TipoNodoAgregar]").val() == "3") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetAntePuertosActivos", "Antepuerto")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoAgregar]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Antepuerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=NodoAgregar]").append(optionsAsString);
                        $("select[name=NodoAgregar]").removeAttr('disabled');
                        $("select[name=NodoAgregar]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=TipoNodoAgregar]").val() == "4") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertos", "Puertos")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoAgregar]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=NodoAgregar]").append(optionsAsString);
                        $("select[name=NodoAgregar]").removeAttr('disabled');
                        $("select[name=NodoAgregar]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=TipoNodoAgregar]").val() == "5") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetPuertos", "Puertos")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoAgregar]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=NodoAgregar]").append(optionsAsString);
                        $("select[name=NodoAgregar]").removeAttr('disabled');
                        $("select[name=NodoAgregar]").selectpicker('refresh');
                    },
                });
            } else if ($("select[name=TipoNodoAgregar]").val() == "6") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetBodegas", "Bodega")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        $("select[name=NodoAgregar]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Bodega</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=NodoAgregar]").append(optionsAsString);
                        $("select[name=NodoAgregar]").removeAttr('disabled');
                        $("select[name=NodoAgregar]").selectpicker('refresh');
                    },
                });
            }
        });


        $("select[name=PaisAgregar]").change(function () {

            if ($("select[name=PaisAgregar]").val() == "0") {

                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetCiudadesActivas", "Ciudad")',
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        var optionsAsString = "";
                        $("select[name=CiudadAgregar]").empty();
                        var optionsAsString = "";
                        optionsAsString += "<option value='0'>Seleccione Ciudad</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }

                        $("select[name=CiudadAgregar]").append(optionsAsString);
                        $("select[name=CiudadAgregar]").selectpicker('refresh');
                    },
                });

                if ($("select[name=TipoNodoAgregar]").val() == "1") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetDepositosActivos", "Deposito")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $("select[name=NodoAgregar]").empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Deposito</option>";
                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $("select[name=NodoAgregar]").append(optionsAsString);
                            $("select[name=NodoAgregar]").selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "2") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPackingActivos", "Packing")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $("select[name=NodoAgregar]").empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Packing</option>";
                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $("select[name=NodoAgregar]").append(optionsAsString);
                            $("select[name=NodoAgregar]").selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "3") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetAntePuertosActivos", "Antepuerto")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $("select[name=NodoAgregar]").empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Antepuerto</option>";
                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $("select[name=NodoAgregar]").append(optionsAsString);
                            $("select[name=NodoAgregar]").selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "4") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPuertos", "Puertos")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $("select[name=NodoAgregar]").empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $("select[name=NodoAgregar]").append(optionsAsString);
                            $("select[name=NodoAgregar]").selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "5") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPuertos", "Puertos")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $("select[name=NodoAgregar]").empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Puerto</option>";
                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $("select[name=NodoAgregar]").append(optionsAsString);
                            $("select[name=NodoAgregar]").selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "6") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetBodegas", "Bodega")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $("select[name=NodoAgregar]").empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Bodega</option>";
                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $("select[name=NodoAgregar]").append(optionsAsString);
                            $("select[name=NodoAgregar]").selectpicker('refresh');
                        },
                    });
                }
            } else {

                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetCiudadesPais", "Ciudad")',
                    data: { IdPais: $("select[name=PaisAgregar]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        var optionsAsString = "";
                        $('select[name=CiudadAgregar]').empty();
                        optionsAsString += "<option value='0'>Seleccione una Ciudad</option>";
                        for (var i = 0; i < cuenta; i++) {
                            optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                        }
                        $('select[name=CiudadAgregar]').append(optionsAsString);
                        $('select[name=CiudadAgregar]').selectpicker('refresh');
                    },
                });

                if ($("select[name=TipoNodoAgregar]").val() == "1") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetDepositoPais", "Deposito")',
                        data: { IdPais: $("select[name=PaisAgregar]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=Nodo]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione un Deposito</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "2") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPackingsPais", "Packing")',
                        data: { IdPais: $("select[name=PaisAgregar]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione un Packing</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "3") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetAntePuertoPais", "Antepuerto")',
                        data: { IdPais: $("select[name=PaisAgregar]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione un Antepuerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "4") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPuertosOrigenPais", "Puertos")',
                        data: { IdPais: $("select[name=PaisAgregar]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "5") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPuertosDestinoPais", "Puertos")',
                        data: { IdPais: $("select[name=PaisAgregar]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "6") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetBodegasPais", "Bodega")',
                        data: { IdPais: $("select[name=PaisAgregar]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione una Bodega</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                }
            }
        });

        $("select[name=CiudadAgregar]").change(function () {
            if ($("select[name=CiudadAgregar]").val() == "0") {
                if ($("select[name=TipoNodoAgregar]").val() == "1") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetDepositosActivos", "Deposito")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Deposito</option>";
                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }
                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "2") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPackingActivos", "Packing")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Packing</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "3") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetAntePuertosActivos", "Antepuerto")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Antepuerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }
                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "4") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPuertos", "Puertos")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }
                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "5") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPuertos", "Puertos")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }
                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "6") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetBodegas", "Bodega")',
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Bodega</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }
                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                }
            } else {
                if ($("select[name=TipoNodoAgregar]").val() == "1") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetDepositoCiudad", "Deposito")',
                        data: { IdCiudad: $("select[name=CiudadAgregar]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione un Deposito</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "2") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPackingsCiudad", "Packing")',
                        data: { IdCiudad: $("select[name=CiudadAgregar]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione un Packing</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "3") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetAntePuertoCiudad", "Antepuerto")',
                        data: { IdCiudad: $("select[name=CiudadAgregar]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione un Antepuerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "4") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPuertosOrigenCiudad", "Puertos")',
                        data: { IdCiudad: $("select[name=CiudadAgregar]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "5") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPuertosDestinoCiudad", "Puertos")',
                        data: { IdCiudad: $("select[name=CiudadAgregar]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Puerto</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                } else if ($("select[name=TipoNodoAgregar]").val() == "6") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetBodegasCiudad", "Bodega")',
                        data: { IdCiudad: $("select[name=CiudadAgregar]").val() },
                        success: function (response) {
                            var data = [];
                            var json = JSON.parse(response);
                            var cuenta = json.length;
                            $('select[name=NodoAgregar]').empty();
                            var optionsAsString = "";
                            optionsAsString += "<option value='0'>Seleccione Bodega</option>";

                            for (var i = 0; i < cuenta; i++) {
                                optionsAsString += "<option value='" + json[i].Id + "'>" + json[i].Nombre + "</option>";
                            }

                            $('select[name=NodoAgregar]').append(optionsAsString);
                            $('select[name=NodoAgregar]').selectpicker('refresh');
                        },
                    });
                }
            }
        });

        $("select[name=NodoAgregar]").change(function () {
            if ($("select[name=TipoNodoAgregar]").val() == "1") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetInfoDeposito", "Deposito")',
                    data: { IdDeposito: $("select[name=NodoAgregar]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        if (cuenta != 0) {
                            $("select[name=PaisAgregar]").val(json[0].IdPais);
                            $("select[name=PaisAgregar]").selectpicker('refresh');
                            $("select[name=CiudadAgregar]").val(json[0].IdCiudad);
                            $("select[name=CiudadAgregar]").selectpicker('refresh');
                        }
                    },
                });
            } else if ($("select[name=TipoNodoAgregar]").val() == "2") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetInfoPacking", "Packing")',
                    data: { IdPacking: $("select[name=NodoAgregar]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        if (cuenta != 0) {
                            $("select[name=PaisAgregar]").val(json[0].IdPais);
                            $("select[name=PaisAgregar]").selectpicker('refresh');
                            $("select[name=CiudadAgregar]").val(json[0].IdCiudad);
                            $("select[name=CiudadAgregar]").selectpicker('refresh');
                        }
                    },
                });
            } else if ($("select[name=TipoNodoAgregar]").val() == "3") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetInfoAntepuerto", "Antepuerto")',
                    data: { IdAntepuerto: $("select[name=NodoAgregar]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        if (cuenta != 0) {
                            $("select[name=PaisAgregar]").val(json[0].IdPais);
                            $("select[name=PaisAgregar]").selectpicker('refresh');
                            $("select[name=CiudadAgregar]").val(json[0].IdCiudad);
                            $("select[name=CiudadAgregar]").selectpicker('refresh');
                        }
                    },
                });
            } else if ($("select[name=TipoNodoAgregar]").val() == "4") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetInfoPuertoOrigen", "Puertos")',
                    data: { IdPuertoOrigen: $("select[name=NodoAgregar]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        if (cuenta != 0) {
                            $("select[name=PaisAgregar]").val(json[0].IdPais);
                            $("select[name=PaisAgregar]").selectpicker('refresh');
                            $("select[name=CiudadAgregar]").val(json[0].IdCiudad);
                            $("select[name=CiudadAgregar]").selectpicker('refresh');
                        }
                    },
                });
            } else if ($("select[name=TipoNodoAgregar]").val() == "6") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetInfoBodega", "Bodega")',
                    data: { IdBodega: $("select[name=NodoAgregar]").val() },
                    success: function (response) {
                        var data = [];
                        var json = JSON.parse(response);
                        var cuenta = json.length;
                        if (cuenta != 0) {
                            $("select[name=PaisAgregar]").val(json[0].IdPais);
                            $("select[name=PaisAgregar]").selectpicker('refresh');
                            $("select[name=CiudadAgregar]").val(json[0].IdCiudad);
                            $("select[name=CiudadAgregar]").selectpicker('refresh');
                        }
                    },
                });
            }
        });

        $('#AgregarMovLogisticoTrigger').trigger('click');
    });

    function formatDate(date) {
        if (date != null) {
            var fecha = date.substring(0, 10);
            var ano = date.substring(0, 4);
            var mes = date.substring(5, 7);
            var dia = date.substring(8, 10);
            return dia + "/" + mes + "/" + ano;
        } else {
            return "";
        }

    }


    $("#Limpiar").click(function () {
        location.reload();
    });

    $("#Filtrar").click(function () {
        var tableIngreso = $('#Tb_Controlador').DataTable();
        tableIngreso.destroy();
        $('#cantidadSensores').text("0");
        $.ajax({
            type: "POST",
            url: '@Url.Action("FiltrarSensores", "Sensor")',
            data: {
                Pais: $("#Pais").val(),
                Ciudad: $("#Ciudad").val(),
                TipoNodo: $("#TipoNodo").val(),
                Nodo: $("#Nodo").val(),
                Marca: $("#Marca").val(),
                Modelo: $("#Modelo").val(),
            },
            success: function (response) {
                var data = [];
                var json = response;
                var cuenta = json.length;

                for (var i = 0 ; i < cuenta ; i++) {
                    data.push([json[i].Alerta,
                                json[i].NumeroSerie,
                                json[i].Marca,
                                json[i].Modelo,
                                json[i].EstadoLogistico,
                                json[i].TipoNodoOrigen,
                                json[i].PaisOrigen,
                                json[i].CiudadOrigen,
                                json[i].NodoOrigen,
                                json[i].TipoNodoDestino,
                                json[i].PaisDestino,
                                json[i].CiudadDestino,
                                json[i].NodoDestino,
                                FormatDate(json[i].FechaVencimiento),
                    ])
                }

                $('#Tb_Controlador thead tr:eq(1) th').each(function (i) {
                    var title = $('#example thead tr:eq(0) th').eq($(this).index()).text();

                    $(this).html('<input type="text" class="form-control" placeholder="FILTER" data-index="' + i + '"/>');
                });

                var table = $('#Tb_Controlador').DataTable({
                    data: data,
                    initComplete: function () {
                        this.api().columns().every(function () {
                            var column = this;
                            if (column.index() == 0) {
                                //alert(column.index());

                                var select = $('<select><option value=""></option></select>')
                                    .appendTo($(column.footer()).empty())
                                    .on('change', function () {
                                        var val = $.fn.dataTable.util.escapeRegex(
                                            $(this).val()
                                        );

                                        column
                                            .search(val ? '^' + val + '$' : '', true, false)
                                            .draw();
                                    });

                                column.data().unique().sort().each(function (d, j) {
                                    select.append('<option value="' + d + '">' + d + '</option>')
                                });
                            }
                        });
                    },
                    orderCellsTop: true,
                    scrollX: true,
                    order: false,
                    pageLength: 15,
                });

                table.columns().every(function () {
                    var that = this;
                    $('input', this.footer()).on('keyup change', function () {
                        if (that.search() !== this.value) {
                            that
                                .search(this.value)
                                .draw();
                        }
                    });
                });

                table.on('draw', function (data) {
                    $('#cantidadSensores').text(table.page.info().recordsDisplay);
                });
            },
        });
    });

</script>


